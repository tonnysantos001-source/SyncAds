â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  SYNCADS - INSTRUÃ‡Ã•ES DE DEBUG (Nome e Imagem dos Produtos)   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… Data: $(date +%Y-%m-%d)
ğŸ¯ Objetivo: Identificar onde os dados dos produtos se perdem

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… O QUE FOI FEITO

1. âœ… Criado script v4.1 com logs detalhados de debug
   ğŸ“„ Arquivo: public/shopify-checkout-redirect-v4.1-debug.js

2. âœ… Edge Function atualizada com logs completos
   ğŸš€ Deploy: shopify-create-order (v8 - com debug)

3. âœ… Logs estratÃ©gicos em cada etapa do fluxo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ”§ PRÃ“XIMOS PASSOS (FAZER AGORA)

### PASSO 1: Substituir o script na Shopify

1. Ir em: Shopify Admin â†’ Online Store â†’ Themes â†’ Actions â†’ Edit Code

2. Abrir: theme.liquid (ou o layout principal)

3. Localizar a tag que carrega o script atual:
   <script src="shopify-checkout-redirect.js"></script>

4. Substituir por:
   <script src="shopify-checkout-redirect-v4.1-debug.js"></script>

5. SALVAR

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### PASSO 2: Upload do novo script para Shopify

OPÃ‡ÃƒO A: Via Assets (recomendado)
1. Shopify Admin â†’ Content â†’ Files
2. Upload: public/shopify-checkout-redirect-v4.1-debug.js
3. Copiar URL gerada
4. Usar no theme.liquid:
   <script src="[URL_COPIADA]"></script>

OPÃ‡ÃƒO B: Via Theme Assets
1. Shopify Admin â†’ Online Store â†’ Themes â†’ Edit Code
2. Assets â†’ Add a new asset
3. Upload: shopify-checkout-redirect-v4.1-debug.js
4. Referenciar:
   <script src="{{ 'shopify-checkout-redirect-v4.1-debug.js' | asset_url }}"></script>

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### PASSO 3: Testar e coletar logs

1. Abrir a loja: syncads-ai.myshopify.com

2. Abrir DevTools (F12) â†’ Aba Console

3. Adicionar produto ao carrinho

4. OBSERVAR OS LOGS:
   
   ğŸ” [DEBUG] Tentando obter dados do produto...
   âœ… [DEBUG] Produto encontrado via [mÃ©todo]
   âœ… [DEBUG] Product Data montado para carrinho:
      - nome: "Camisa Sonic" (ou "undefined")
      - imagem: "https://..." (ou "" vazio)
      - preco: 18.00
   
5. Clicar em "Finalizar Compra"

6. OBSERVAR MAIS LOGS:
   
   ğŸ” [DEBUG] Payload que serÃ¡ enviado para API:
      - items[0].name: "..." 
      - items[0].image: "..."

7. ApÃ³s redirecionar, verificar se produto aparece correto

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### PASSO 4: Verificar logs da Edge Function

Comando no terminal:
```bash
supabase functions logs shopify-create-order --project-ref ovskepqggmxlfckxqgbr
```

PROCURAR POR:
- ğŸ” [DEBUG] Produtos recebidos na Edge Function
- âš ï¸ [DEBUG] Produto com dados faltando
- âœ… [DEBUG] Items preparados para o banco
- âœ… [DEBUG] Pedido criado com sucesso

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š CENÃRIOS POSSÃVEIS E SOLUÃ‡Ã•ES

### CENÃRIO 1: Logs mostram nome/imagem CORRETOS no browser, mas VAZIOS na API
ğŸ” Problema: Dados se perdem no POST para Edge Function
âœ… SoluÃ§Ã£o: Verificar serializaÃ§Ã£o JSON e CORS

### CENÃRIO 2: Logs mostram nome/imagem VAZIOS desde o inÃ­cio
ğŸ” Problema: getProductData() nÃ£o estÃ¡ capturando do DOM
âœ… SoluÃ§Ã£o: Adicionar mÃ©todos alternativos de captura:
   - Tentar window.meta.product
   - Buscar via Fetch API da Shopify
   - Usar Storefront API

### CENÃRIO 3: Logs mostram nome/imagem CORRETOS na API, mas VAZIOS no checkout
ğŸ” Problema: Frontend nÃ£o estÃ¡ lendo corretamente do banco
âœ… SoluÃ§Ã£o: Verificar mapeamento em MobileCheckoutPage.tsx

### CENÃRIO 4: Produto tem variant, nome fica "undefined - undefined"
ğŸ” Problema: variant.title estÃ¡ undefined
âœ… SoluÃ§Ã£o: Fallback para product.title sem variant

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ› ï¸ SOLUÃ‡ÃƒO ALTERNATIVA (Se nada funcionar)

ENRIQUECER DADOS NA EDGE FUNCTION COM STOREFRONT API:

```typescript
// Adicionar na Edge Function apÃ³s receber products
for (const item of items) {
  if (!item.name || !item.image) {
    try {
      // Buscar produto via Storefront API
      const query = `{
        product(id: "gid://shopify/Product/${item.productId}") {
          title
          featuredImage {
            url
          }
        }
      }`;
      
      const response = await fetch(
        `https://${shopDomain}/api/2024-01/graphql.json`,
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-Shopify-Storefront-Access-Token": "TOKEN_PUBLICO",
          },
          body: JSON.stringify({ query }),
        }
      );
      
      const { data } = await response.json();
      item.name = item.name || data.product.title;
      item.image = item.image || data.product.featuredImage.url;
    } catch (e) {
      console.error("Erro ao enriquecer produto:", e);
    }
  }
}
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“‹ CHECKLIST

[ ] Script v4.1 uploaded para Shopify
[ ] Script v4.1 referenciado no theme.liquid
[ ] Cache da Shopify limpo
[ ] Teste realizado com produto
[ ] Logs coletados do browser (console)
[ ] Logs coletados da Edge Function
[ ] Problema identificado
[ ] SoluÃ§Ã£o aplicada
[ ] Teste final confirmado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ†˜ SE PRECISAR DE AJUDA

1. Tire prints dos logs do console
2. Copie os logs da Edge Function
3. Veja o pedido no banco: 
   SELECT id, items, metadata FROM "Order" ORDER BY "createdAt" DESC LIMIT 1;
4. Compartilhe todas essas informaÃ§Ãµes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

import{f as E,r as l,s as g,j as e,N,g as d,l as m,h as O,i as _,n as b,O as D,k as L,I as C,B as T}from"./index-DMxb--CC.js";import{L as p}from"./label-CPOcKXR1.js";import{S}from"./SuperAdminLayout-D_usrPmC.js";import{C as F}from"./circle-alert-COG_dWuh.js";import{C as $}from"./circle-x-BIdgL2Vd.js";import{E as U}from"./external-link-Dk4nGgW7.js";import{E as B}from"./eye-off-OAs-Uco6.js";import{E as q}from"./eye-BRd5LSBe.js";import{S as G}from"./save-DaYV2gV6.js";import"./Logo-WTeqVd-T.js";import"./message-square-DgDumF-r.js";import"./dollar-sign-DdWd9CIv.js";function Z(){const{toast:i}=E(),[w,h]=l.useState(!1),[u,c]=l.useState(null),[x,A]=l.useState({}),[f,v]=l.useState([{platform:"META",platformName:"Meta / Facebook Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üìò",scopes:["ads_management","ads_read","pages_read_engagement","pages_manage_ads"],docsUrl:"https://developers.facebook.com/docs/facebook-login/guides/advanced/manual-flow"},{platform:"GOOGLE",platformName:"Google Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üîç",scopes:["https://www.googleapis.com/auth/adwords","https://www.googleapis.com/auth/userinfo.email"],docsUrl:"https://developers.google.com/identity/protocols/oauth2"},{platform:"LINKEDIN",platformName:"LinkedIn Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üíº",scopes:["r_ads","r_ads_reporting","rw_ads"],docsUrl:"https://learn.microsoft.com/en-us/linkedin/shared/authentication/authentication"},{platform:"TIKTOK",platformName:"TikTok For Business",clientId:"",clientSecret:"",isActive:!1,icon:"üéµ",scopes:["user.info.basic","video.list","video.upload"],docsUrl:"https://developers.tiktok.com/doc/login-kit-web"}]);l.useEffect(()=>{j()},[]);const j=async()=>{try{h(!0);const{data:s,error:a}=await g.from("OAuthConfig").select("*").order("platform");if(a)throw a;s&&s.length>0&&v(o=>o.map(r=>{const t=s.find(k=>k.platform===r.platform);return t?{...r,clientId:t.clientId||"",clientSecret:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",isActive:t.isActive||!1}:r}))}catch(s){console.error("Erro ao carregar configs:",s),i({title:"Erro ao carregar configura√ß√µes",description:s.message,variant:"destructive"})}finally{h(!1)}},y=async s=>{try{c(s);const a=f.find(t=>t.platform===s);if(!a)return;if(!a.clientId||!a.clientSecret){i({title:"Campos obrigat√≥rios",description:"Client ID e Client Secret s√£o obrigat√≥rios.",variant:"destructive"}),c(null);return}const o={platform:a.platform,clientId:a.clientId,isActive:a.isActive,scopes:a.scopes,updatedAt:new Date().toISOString()};a.clientSecret!=="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"&&(o.clientSecret=a.clientSecret);const{error:r}=await g.from("OAuthConfig").upsert(o,{onConflict:"platform"});if(r)throw r;i({title:"‚úÖ Configura√ß√£o salva",description:`${a.platformName} configurado com sucesso!`}),await j()}catch(a){console.error("Erro ao salvar config:",a),i({title:"Erro ao salvar",description:a.message,variant:"destructive"})}finally{c(null)}},n=(s,a,o)=>{v(r=>r.map(t=>t.platform===s?{...t,[a]:o}:t))},I=s=>{A(a=>({...a,[s]:!a[s]}))};return w?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(N,{className:"h-8 w-8 animate-spin text-blue-600"})})}):e.jsx(S,{children:e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"üîê Configura√ß√µes OAuth 2.0"}),e.jsx("p",{className:"text-gray-600",children:"Configure as credenciais das plataformas. Quando cadastradas e ativadas, seus usu√°rios poder√£o conectar via chat com IA."})]}),e.jsx(d,{className:"mb-6 border-blue-200 bg-blue-50",children:e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"Como funciona?"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Cadastre as credenciais OAuth aqui"}),e.jsx("li",{children:'‚Ä¢ Marque como "Ativa" quando estiver aprovado pela plataforma'}),e.jsx("li",{children:'‚Ä¢ Usu√°rios podem pedir no chat: "Conecte com Facebook"'}),e.jsx("li",{children:"‚Ä¢ A IA mostra card interativo para autoriza√ß√£o"}),e.jsx("li",{children:"‚Ä¢ Tokens s√£o salvos criptografados"})]})]})]})})}),e.jsx("div",{className:"grid gap-6",children:f.map(s=>e.jsxs(d,{className:"border-2 hover:border-blue-300 transition-colors",children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:s.icon}),e.jsxs("div",{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[s.platformName,s.isActive?e.jsxs(b,{className:"bg-green-500",children:[e.jsx(D,{className:"h-3 w-3 mr-1"}),"Ativo"]}):e.jsxs(b,{variant:"secondary",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),"Inativo"]})]}),e.jsxs(L,{className:"mt-1",children:["Scopes: ",s.scopes.slice(0,2).join(", "),s.scopes.length>2&&` +${s.scopes.length-2} mais`]})]})]}),e.jsxs("a",{href:s.docsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Documenta√ß√£o",e.jsx(U,{className:"h-3 w-3"})]})]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:`${s.platform}-client-id`,children:"Client ID *"}),e.jsx(C,{id:`${s.platform}-client-id`,placeholder:"Digite o Client ID da plataforma",value:s.clientId,onChange:a=>n(s.platform,"clientId",a.target.value),className:"mt-1 font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:`${s.platform}-client-secret`,children:"Client Secret *"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(C,{id:`${s.platform}-client-secret`,type:x[s.platform]?"text":"password",placeholder:"Digite o Client Secret",value:s.clientSecret,onChange:a=>n(s.platform,"clientSecret",a.target.value),className:"pr-10 font-mono text-sm"}),e.jsx("button",{type:"button",onClick:()=>I(s.platform),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x[s.platform]?e.jsx(B,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`${s.platform}-active`,checked:s.isActive,onChange:a=>n(s.platform,"isActive",a.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx(p,{htmlFor:`${s.platform}-active`,className:"cursor-pointer",children:"Ativar integra√ß√£o (usu√°rios poder√£o conectar)"})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(T,{onClick:()=>y(s.platform),disabled:u===s.platform,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:u===s.platform?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Salvar Configura√ß√£o"]})})})]})]},s.platform))}),e.jsx(d,{className:"mt-8 border-gray-200 bg-gray-50",children:e.jsxs(m,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"üìå Importante"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ As credenciais s√£o criptografadas antes de salvar no banco"}),e.jsx("li",{children:"‚Ä¢ Nunca s√£o expostas no frontend dos usu√°rios"}),e.jsx("li",{children:'‚Ä¢ Quando "Ativa", a integra√ß√£o fica dispon√≠vel para todos usu√°rios'}),e.jsx("li",{children:"‚Ä¢ Desative temporariamente se houver problemas de aprova√ß√£o"})]})]})})]})})}export{Z as default};

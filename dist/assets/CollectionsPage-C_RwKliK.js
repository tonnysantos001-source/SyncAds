import{c as $,r as t,f as G,u as J,j as e,B as o,I as v,g as C,h as N,i as b,l as w,E as K,S as M,n as Q}from"./index-DVJSl2Ld.js";import{T as W,a as X,b as A,c as h,d as Y,e as u}from"./table-DtGZAjx0.js";import{D as Z,f as _,a as ee,b as se,c as ae,e as te}from"./dialog-DwnGSz2w.js";import{L as j}from"./label-D4Gc-So-.js";import{T as re}from"./textarea-CvTc4lqL.js";import{p as g}from"./productsApi-_nyZclUo.js";import{S as D}from"./skeleton-x8xayj9d.js";import{P as k}from"./plus-1Vai_N8k.js";import{S as ie}from"./square-pen-D1akKtaC.js";import{T as le}from"./trash-2-BkZIib7q.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=$("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),fe=()=>{const[c,E]=t.useState([]),[y,f]=t.useState([]),[L,I]=t.useState(!0),[d,F]=t.useState(""),[H,m]=t.useState(!1),[x,S]=t.useState(null),{toast:i}=G(),r=J(s=>s.user),[a,l]=t.useState({name:"",slug:"",description:"",isActive:!0});t.useEffect(()=>{p()},[]),t.useEffect(()=>{P()},[d,c]);const p=async()=>{try{if(!(r!=null&&r.organizationId))return;const s=await g.collections.list(r.organizationId);E(s),f(s)}catch(s){i({title:"Erro ao carregar coleções",description:s.message,variant:"destructive"})}finally{I(!1)}},P=()=>{if(!d){f(c);return}const s=c.filter(n=>n.name.toLowerCase().includes(d.toLowerCase())||n.slug.toLowerCase().includes(d.toLowerCase()));f(s)},O=s=>s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),B=s=>{l({...a,name:s,slug:x?a.slug:O(s)})},q=async s=>{s.preventDefault();try{if(!(r!=null&&r.organizationId))return;x?(await g.collections.update(x.id,a),i({title:"Coleção atualizada!"})):(await g.collections.create({...a,organizationId:r.organizationId}),i({title:"Coleção criada!",description:"A coleção está pronta para receber produtos."})),m(!1),T(),p()}catch(n){i({title:"Erro",description:n.message,variant:"destructive"})}},R=async s=>{if(confirm("Tem certeza que deseja deletar esta coleção?"))try{await g.collections.delete(s),i({title:"Coleção deletada"}),p()}catch(n){i({title:"Erro ao deletar",description:n.message,variant:"destructive"})}},U=s=>{S(s),l({name:s.name,slug:s.slug,description:s.description||"",isActive:s.isActive}),m(!0)},T=()=>{S(null),l({name:"",slug:"",description:"",isActive:!0})},V=c.filter(s=>s.isActive).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Coleções de Produtos"}),e.jsx("p",{className:"text-muted-foreground",children:"Organize seus produtos em coleções"})]}),e.jsxs(Z,{open:H,onOpenChange:m,children:[e.jsx(_,{asChild:!0,children:e.jsxs(o,{onClick:T,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Criar Coleção"]})}),e.jsxs(ee,{children:[e.jsx(se,{children:e.jsx(ae,{children:x?"Editar Coleção":"Nova Coleção"})}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{children:"Nome da Coleção"}),e.jsx(v,{value:a.name,onChange:s=>B(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{children:"Slug (URL)"}),e.jsx(v,{value:a.slug,onChange:s=>l({...a,slug:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{children:"Descrição"}),e.jsx(re,{value:a.description,onChange:s=>l({...a,description:s.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.isActive,onChange:s=>l({...a,isActive:s.target.checked})}),e.jsx(j,{children:"Ativa"})]})]}),e.jsxs(te,{className:"mt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(o,{type:"submit",children:x?"Atualizar":"Criar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(C,{children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium",children:"Total de Coleções"}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(w,{children:e.jsx("div",{className:"text-2xl font-bold",children:c.length})})]}),e.jsxs(C,{children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium",children:"Coleções Ativas"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(w,{children:e.jsx("div",{className:"text-2xl font-bold",children:V})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(v,{placeholder:"Buscar coleções...",value:d,onChange:s=>F(s.target.value),className:"pl-9"})]}),e.jsxs(C,{children:[e.jsx(N,{children:e.jsx(b,{children:"Lista de Coleções"})}),e.jsx(w,{children:L?e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{className:"h-12 w-full"}),e.jsx(D,{className:"h-12 w-full"})]}):y.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhuma coleção encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Comece criando a primeira coleção"}),e.jsxs(o,{onClick:()=>m(!0),children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Criar Primeira Coleção"]})]}):e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(A,{children:[e.jsx(h,{children:"Nome"}),e.jsx(h,{children:"Slug"}),e.jsx(h,{children:"Status"}),e.jsx(h,{className:"text-right",children:"Ações"})]})}),e.jsx(Y,{children:y.map(s=>e.jsxs(A,{children:[e.jsx(u,{className:"font-medium",children:s.name}),e.jsx(u,{className:"text-sm text-muted-foreground",children:s.slug}),e.jsx(u,{children:e.jsx(Q,{variant:s.isActive?"default":"secondary",children:s.isActive?"Ativa":"Inativa"})}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>U(s),children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>R(s.id),children:e.jsx(le,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})};export{fe as default};

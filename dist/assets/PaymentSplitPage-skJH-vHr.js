import{j as e}from"./vendor-ui-D3JNL6pE.js";import{r as a}from"./vendor-react-X41Bjl18.js";import{g as s,s as t,B as r,a5 as i,I as n,D as c,S as l,ab as o,v as d,C as m,a as g,b as u,d as y,c as p,af as x,Q as h,e as b,ag as j,ah as v,N as f,ai as N,aj as w,ak as S}from"./index-DW7xxQPV.js";import{L as C}from"./label-CBPW78Mi.js";import{S as k}from"./switch-h1ysWEOs.js";import{D as K,e as T,a as A,b as P,c as q,d as E,f as $}from"./dialog-69Ivjo1Q.js";import{S as R,a as _,b as I,c as G,d as V}from"./select-CyQc8-g6.js";import{T as F,a as z,b as X,c as M,d as D,e as B}from"./table-D_Hub9wS.js";import{A as L,b as O,a as Y}from"./alert-CvY0LE17.js";import{S as Q}from"./SuperAdminLayout-CD1KrWaF.js";import{m as U}from"./vendor-animation-DtB50Lbk.js";import"./vendor-supabase-HUq0BeMy.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-query-DqG_mm-v.js";import"./vendor-icons-BvRy6l6m.js";const H=[{slug:"paguex",name:"Pague-X",type:"payment_processor",endpoints:{test:"https://api.inpagamentos.com/v1/transactions"},authType:"basic",requiredFields:["publicKey","secretKey"],async detect(e){const{publicKey:a,secretKey:s}=e;if(!a||!s)return{success:!1,message:"Pague-X: publicKey e secretKey são obrigatórios"};try{const e=btoa(`${a}:${s}`),t=await fetch(`${this.endpoints.test}?limit=1`,{method:"GET",headers:{Authorization:`Basic ${e}`,"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)});return t.ok?{success:!0,gateway:{slug:this.slug,name:this.name,type:this.type},message:"Pague-X detectado e credenciais válidas",capabilities:{pix:!0,credit_card:!0,debit_card:!0,boleto:!0}}:{success:!1,message:`Pague-X: Erro ${t.status}`}}catch(t){return{success:!1,message:`Pague-X: ${t.message}`}}}},{slug:"mercadopago",name:"Mercado Pago",type:"payment_processor",endpoints:{test:"https://api.mercadopago.com/v1/account/settings"},authType:"bearer",requiredFields:["accessToken"],async detect(e){const{accessToken:a}=e;if(!a)return{success:!1,message:"Mercado Pago: accessToken é obrigatório"};try{const e=await fetch(this.endpoints.test,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)});return e.ok?{success:!0,gateway:{slug:this.slug,name:this.name,type:this.type},message:"Mercado Pago detectado e credenciais válidas",capabilities:{pix:!0,credit_card:!0,debit_card:!1,boleto:!0}}:{success:!1,message:`Mercado Pago: Erro ${e.status}`}}catch(s){return{success:!1,message:`Mercado Pago: ${s.message}`}}}},{slug:"pagseguro",name:"PagSeguro",type:"payment_processor",endpoints:{test:"https://api.pagseguro.com/charges"},authType:"bearer",requiredFields:["apiKey"],async detect(e){const{apiKey:a}=e;if(!a)return{success:!1,message:"PagSeguro: apiKey é obrigatório"};try{const e=await fetch(this.endpoints.test,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)});return e.ok||400===e.status?{success:!0,gateway:{slug:this.slug,name:this.name,type:this.type},message:"PagSeguro detectado e credenciais válidas",capabilities:{pix:!0,credit_card:!0,debit_card:!0,boleto:!0}}:{success:!1,message:`PagSeguro: Erro ${e.status}`}}catch(s){return{success:!1,message:`PagSeguro: ${s.message}`}}}},{slug:"stripe",name:"Stripe",type:"payment_processor",endpoints:{test:"https://api.stripe.com/v1/balance"},authType:"bearer",requiredFields:["secretKey"],async detect(e){const{secretKey:a}=e;if(!a)return{success:!1,message:"Stripe: secretKey é obrigatório"};try{const e=await fetch(this.endpoints.test,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)});return e.ok?{success:!0,gateway:{slug:this.slug,name:this.name,type:this.type},message:"Stripe detectado e credenciais válidas",capabilities:{pix:!1,credit_card:!0,debit_card:!0,boleto:!1}}:{success:!1,message:`Stripe: Erro ${e.status}`}}catch(s){return{success:!1,message:`Stripe: ${s.message}`}}}},{slug:"asaas",name:"Asaas",type:"payment_processor",endpoints:{test:"https://api.asaas.com/v3/customers"},authType:"apikey",requiredFields:["apiKey"],async detect(e){const{apiKey:a}=e;if(!a)return{success:!1,message:"Asaas: apiKey é obrigatório"};try{const e=await fetch(`${this.endpoints.test}?limit=1`,{method:"GET",headers:{access_token:a,"Content-Type":"application/json"},signal:AbortSignal.timeout(5e3)});return e.ok?{success:!0,gateway:{slug:this.slug,name:this.name,type:this.type},message:"Asaas detectado e credenciais válidas",capabilities:{pix:!0,credit_card:!0,debit_card:!1,boleto:!0}}:{success:!1,message:`Asaas: Erro ${e.status}`}}catch(s){return{success:!1,message:`Asaas: ${s.message}`}}}}];const J=({title:a,value:s,description:t,icon:r,gradient:i,delay:n=0})=>e.jsx(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n},whileHover:{scale:1.02},children:e.jsxs(m,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl hover:border-gray-600 transition-all group cursor-pointer relative overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${i} opacity-10 group-hover:opacity-20 transition-opacity`}),e.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[e.jsx(u,{className:"text-sm font-medium text-gray-300",children:a}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${i} shadow-lg`,children:e.jsx(r,{className:"h-4 w-4 text-white"})})]}),e.jsxs(p,{className:"relative z-10",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s}),e.jsx("p",{className:"text-xs text-gray-400",children:t})]})]})});function W(){const{toast:W}=s(),[Z,ee]=a.useState(!0),[ae,se]=a.useState([]),[te,re]=a.useState({totalTransactions:0,adminTransactions:0,clientTransactions:0,adminRevenue:0,splitPercentage:0}),[ie,ne]=a.useState([]),[ce,le]=a.useState(!1),[oe,de]=a.useState(null),[me,ge]=a.useState({name:"",description:"",type:"frequency",frequencyEvery:10,frequencyTake:2,percentage:20,minValue:0,maxValue:0,adminGatewayId:"",isActive:!0,priority:0}),[ue,ye]=a.useState({publicKey:"",secretKey:""}),[pe,xe]=a.useState(!1),[he,be]=a.useState(!1),[je,ve]=a.useState({configured:!1});a.useEffect(()=>{fe(),Ce()},[]);const fe=async()=>{ee(!0);try{await Promise.all([Ne(),we(),Se()])}catch(e){}finally{ee(!1)}},Ne=async()=>{const{data:e,error:a}=await t.from("PaymentSplitRule").select("*").order("priority",{ascending:!1});!a&&e&&se(e)},we=async()=>{const{data:e}=await t.from("PaymentSplitLog").select("decision, adminRevenue");if(e){const a=e.length,s=e.filter(e=>"admin"===e.decision).length,t=e.filter(e=>"client"===e.decision).length,r=e.reduce((e,a)=>e+(a.adminRevenue||0),0);re({totalTransactions:a,adminTransactions:s,clientTransactions:t,adminRevenue:r,splitPercentage:a>0?s/a*100:0})}},Se=async()=>{const{data:e}=await t.from("Gateway").select("*").eq("isActive",!0).order("name");e&&ne(e)},Ce=async()=>{const{data:e}=await t.from("GatewayConfig").select("credentials").eq("gatewayId","ebac558d-e799-4246-b7fe-2c7c68393460").eq("userId","admin").single();if(e?.credentials){const a=e.credentials;ve({configured:!0,publicKey:a.publicKey?.substring(0,20)+"***"}),ye({publicKey:a.publicKey||"",secretKey:a.secretKey||""})}},ke=()=>{ge({name:"",description:"",type:"frequency",frequencyEvery:10,frequencyTake:2,percentage:20,minValue:0,maxValue:0,adminGatewayId:"",isActive:!0,priority:0}),de(null)},Ke=e=>{switch(e.type){case"frequency":return`A cada ${e.frequencyEvery} transações, ${e.frequencyTake} vão para o admin`;case"percentage":return`${e.percentage}% das transações para o admin`;case"value":return`Transações entre R$ ${e.minValue||0} e R$ ${e.maxValue||"∞"}`;default:return e.description||""}};return Z?e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(U.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-cyan-500/30 border-t-cyan-500 rounded-full"})})}):e.jsx(Q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent",children:"Split de Pagamento"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Controle a distribuição de transações entre seu gateway e o dos clientes"})]}),e.jsxs(K,{open:ce,onOpenChange:le,children:[e.jsx(T,{asChild:!0,children:e.jsxs(r,{onClick:ke,className:"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(i,{className:"h-5 w-5 mr-2"}),"Nova Regra"]})}),e.jsxs(A,{className:"max-w-2xl bg-gray-900 border-gray-700",children:[e.jsxs(P,{children:[e.jsx(q,{className:"text-white",children:oe?"Editar Regra":"Criar Nova Regra"}),e.jsx(E,{className:"text-gray-400",children:"Configure como as transações serão distribuídas"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Nome da Regra"}),e.jsx(n,{value:me.name,onChange:e=>{ge({...me,name:e.target.value})},placeholder:"Ex: Split 20% Admin",className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Descrição"}),e.jsx(n,{value:me.description,onChange:e=>{ge({...me,description:e.target.value})},className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Tipo de Regra"}),e.jsxs(R,{value:me.type,onValueChange:e=>ge({...me,type:e}),children:[e.jsx(_,{className:"bg-gray-800 border-gray-700 text-white",children:e.jsx(I,{})}),e.jsxs(G,{className:"bg-gray-800 border-gray-700",children:[e.jsx(V,{value:"frequency",children:"Frequência (A cada X transações)"}),e.jsx(V,{value:"percentage",children:"Percentual (X% das transações)"}),e.jsx(V,{value:"value",children:"Valor (Transações acima de X reais)"})]})]})]}),"frequency"===me.type&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"A cada quantas transações?"}),e.jsx(n,{type:"number",value:me.frequencyEvery,onChange:e=>ge({...me,frequencyEvery:parseInt(e.target.value)}),min:1,className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Quantas vão para o admin?"}),e.jsx(n,{type:"number",value:me.frequencyTake,onChange:e=>ge({...me,frequencyTake:parseInt(e.target.value)}),min:1,className:"bg-gray-800 border-gray-700 text-white"})]})]}),("percentage"===me.type||"value"===me.type)&&e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Percentual para o admin (%)"}),e.jsx(n,{type:"number",value:me.percentage,onChange:e=>ge({...me,percentage:parseFloat(e.target.value)}),min:0,max:100,step:.1,className:"bg-gray-800 border-gray-700 text-white"})]}),("value"===me.type||"percentage"===me.type)&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Valor Mínimo (R$)"}),e.jsx(n,{type:"number",value:me.minValue,onChange:e=>ge({...me,minValue:parseFloat(e.target.value)}),min:0,step:.01,className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Valor Máximo (R$)"}),e.jsx(n,{type:"number",value:me.maxValue,onChange:e=>ge({...me,maxValue:parseFloat(e.target.value)}),min:0,step:.01,className:"bg-gray-800 border-gray-700 text-white"})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Gateway do Admin"}),e.jsxs(R,{value:me.adminGatewayId,onValueChange:e=>ge({...me,adminGatewayId:e}),children:[e.jsx(_,{className:"bg-gray-800 border-gray-700 text-white",children:e.jsx(I,{placeholder:"Selecione um gateway"})}),e.jsx(G,{className:"bg-gray-800 border-gray-700",children:ie.map(a=>e.jsx(V,{value:a.id,children:a.name},a.id))})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-gray-300",children:"Prioridade (maior = maior prioridade)"}),e.jsx(n,{type:"number",value:me.priority,onChange:e=>ge({...me,priority:parseInt(e.target.value)}),min:0,className:"bg-gray-800 border-gray-700 text-white"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsx(C,{className:"text-gray-300",children:"Regra Ativa"}),e.jsx(k,{checked:me.isActive,onCheckedChange:e=>ge({...me,isActive:e})})]})]}),e.jsxs($,{children:[e.jsx(r,{variant:"outline",onClick:()=>le(!1),className:"border-gray-700 text-gray-300 hover:bg-gray-800",children:"Cancelar"}),e.jsx(r,{onClick:async()=>{try{const e={name:me.name,description:me.description,type:me.type,frequencyEvery:"frequency"===me.type?me.frequencyEvery:null,frequencyTake:"frequency"===me.type?me.frequencyTake:null,percentage:"percentage"===me.type?me.percentage:null,minValue:"value"===me.type?me.minValue:null,maxValue:"value"===me.type?me.maxValue:null,adminGatewayId:me.adminGatewayId||null,isActive:me.isActive,priority:me.priority};oe?(await t.from("PaymentSplitRule").update(e).eq("id",oe.id),W({title:"Sucesso!",description:"Regra atualizada com sucesso"})):(await t.from("PaymentSplitRule").insert(e),W({title:"Sucesso!",description:"Regra criada com sucesso"})),le(!1),ke(),fe()}catch(e){W({title:"Erro",description:e.message,variant:"destructive"})}},className:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white border-0",children:oe?"Atualizar":"Criar"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(J,{title:"Total",value:te.totalTransactions,description:"Transações processadas",icon:c,gradient:"from-cyan-500 to-blue-500",delay:.1}),e.jsx(J,{title:"Admin",value:te.adminTransactions,description:`${te.splitPercentage.toFixed(1)}% do total`,icon:l,gradient:"from-green-500 to-emerald-500",delay:.2}),e.jsx(J,{title:"Cliente",value:te.clientTransactions,description:`${(100-te.splitPercentage).toFixed(1)}% do total`,icon:o,gradient:"from-blue-500 to-indigo-500",delay:.3}),e.jsx(J,{title:"Receita Admin",value:`R$ ${te.adminRevenue.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,description:"Via split",icon:d,gradient:"from-purple-500 to-pink-500",delay:.4})]}),e.jsx(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsxs(m,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl",children:[e.jsxs(g,{children:[e.jsx(u,{className:"text-white",children:"Gateway do Admin (Seu Gateway)"}),e.jsx(y,{className:"text-gray-400",children:"Configure o gateway que receberá as transações quando o split direcionar para o admin. Use suas credenciais da Pague-X ou outro gateway compatível."})]}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{className:"border-gray-700/50 bg-gray-800/50",children:[e.jsx(x,{className:"h-4 w-4 text-cyan-400"}),e.jsx(O,{className:"text-white",children:"Sistema Multi-Gateway com Auto-Detecção"}),e.jsx(Y,{className:"text-gray-400",children:'O sistema detecta automaticamente qual gateway você está usando. Suporta: Pague-X, Mercado Pago, PagSeguro, Stripe, Asaas e outros. Insira suas credenciais e clique em "Testar Conexão".'})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(C,{children:"Gateway"}),je.configured&&je.gatewayName?e.jsxs("div",{className:"flex items-center gap-2 p-3 border-0 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 ring-1 ring-green-200 dark:ring-green-800/50",children:[e.jsx(l,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-semibold text-white",children:je.gatewayName})]}):e.jsx("div",{className:"p-3 border-0 rounded-lg bg-gray-100 dark:bg-gray-800 text-sm text-gray-400 ring-1 ring-gray-200 dark:ring-gray-700",children:"Auto-detectado após testar conexão"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Suportamos: Pague-X, Mercado Pago, PagSeguro, Stripe, Asaas"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Public Key"}),e.jsx(n,{type:"text",placeholder:"Sua Public Key da Pague-X",className:"font-mono text-sm bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",value:ue.publicKey,onChange:e=>ye({...ue,publicKey:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Secret Key"}),e.jsx(n,{type:"password",placeholder:"Sua Secret Key da Pague-X",className:"font-mono text-sm bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",value:ue.secretKey,onChange:e=>ye({...ue,secretKey:e.target.value})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{onClick:async()=>{if(ue.publicKey&&ue.secretKey){xe(!0);try{const{error:e}=await t.from("GatewayConfig").upsert({gatewayId:"ebac558d-e799-4246-b7fe-2c7c68393460",userId:"admin",credentials:{publicKey:ue.publicKey,secretKey:ue.secretKey},isActive:!0});if(e)throw e;W({title:"Sucesso!",description:"Credenciais salvas com sucesso"}),Ce()}catch(e){W({title:"Erro",description:e.message,variant:"destructive"})}finally{xe(!1)}}else W({title:"Erro",description:"Preencha Public Key e Secret Key",variant:"destructive"})},disabled:pe,children:pe?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"Salvar Credenciais"]})}),e.jsx(r,{variant:"outline",onClick:async()=>{if(ue.publicKey||ue.secretKey){be(!0);try{const e=await async function(e){const a={publicKey:e.publicKey||e.PUBLIC_KEY||e.public_key,secretKey:e.secretKey||e.SECRET_KEY||e.secret_key,apiKey:e.apiKey||e.API_KEY||e.api_key,apiSecret:e.apiSecret||e.API_SECRET||e.api_secret,accessToken:e.accessToken||e.ACCESS_TOKEN||e.access_token,clientId:e.clientId||e.CLIENT_ID||e.client_id,clientSecret:e.clientSecret||e.CLIENT_SECRET||e.client_secret};for(const t of H)try{const e=await t.detect(a);if(e.success)return e}catch(s){}return{success:!1,message:"Nenhum gateway compatível detectado. Verifique suas credenciais."}}({publicKey:ue.publicKey,secretKey:ue.secretKey});e.success&&e.gateway?(W({title:`${e.gateway.name} Detectado!`,description:e.message}),ve({configured:!0,publicKey:ue.publicKey?.substring(0,20)+"***",gatewayName:e.gateway.name,gatewaySlug:e.gateway.slug})):W({title:"Gateway Não Detectado",description:e.message,variant:"destructive"})}catch(e){W({title:"Erro de Conexão",description:e.message,variant:"destructive"})}finally{be(!1)}}else W({title:"Erro",description:"Preencha pelo menos uma credencial antes de testar",variant:"destructive"})},disabled:he,children:he?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"h-4 w-4 mr-2 animate-spin"}),"Testando..."]}):"Testar Conexão"})]}),je.configured&&e.jsx("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 backdrop-blur-sm rounded-xl border-0 ring-1 ring-blue-200/50 dark:ring-blue-700/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl shadow-lg",children:e.jsx(d,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-white mb-1",children:"Gateway Configurado"}),e.jsxs("p",{className:"text-sm text-gray-300",children:[je.gatewayName||"Gateway"," • Configurado e ativo"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1 font-mono",children:["Public Key: ",je.publicKey]})]}),e.jsx(b,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white border-0 shadow-md",children:"Ativo"})]})})]})})]})}),e.jsx(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsxs(L,{className:"border-gray-700/50 bg-gray-800/50",children:[e.jsx(x,{className:"h-5 w-5 text-cyan-400"}),e.jsx(O,{className:"text-white",children:"Como funciona?"}),e.jsx(Y,{className:"text-gray-400",children:"O sistema distribui automaticamente as transações entre seu gateway (configurado acima) e o gateway do cliente. Configure regras baseadas em frequência, percentual ou valor."})]})}),e.jsx(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:e.jsxs(m,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl",children:[e.jsxs(g,{children:[e.jsxs(u,{className:"text-white flex items-center gap-2",children:[e.jsx(c,{className:"h-6 w-6 text-cyan-600"}),"Regras Configuradas"]}),e.jsx(y,{className:"text-gray-400",children:"Gerenciar regras de split de pagamento"})]}),e.jsx(p,{children:0===ae.length?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"p-4 rounded-xl bg-gray-800 w-fit mx-auto mb-4",children:e.jsx(c,{className:"h-12 w-12 text-gray-400"})}),e.jsx("p",{className:"text-gray-400 mb-6 text-lg font-medium",children:"Nenhuma regra configurada"}),e.jsxs(r,{onClick:()=>le(!0),className:"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(i,{className:"h-5 w-5 mr-2"}),"Criar Primeira Regra"]})]}):e.jsx("div",{className:"rounded-lg overflow-hidden border-gray-700/50",children:e.jsxs(F,{children:[e.jsx(z,{children:e.jsxs(X,{className:"bg-gray-800/30",children:[e.jsx(M,{className:"font-semibold text-gray-300",children:"Nome"}),e.jsx(M,{className:"font-semibold text-gray-300",children:"Tipo"}),e.jsx(M,{className:"font-semibold text-gray-300",children:"Configuração"}),e.jsx(M,{className:"font-semibold text-gray-300",children:"Contador"}),e.jsx(M,{className:"font-semibold text-gray-300",children:"Stats"}),e.jsx(M,{className:"font-semibold text-gray-300",children:"Status"}),e.jsx(M,{className:"text-right font-semibold text-gray-300",children:"Ações"})]})}),e.jsx(D,{children:ae.map((a,s)=>{const i=(e=>{switch(e){case"frequency":return S;case"percentage":return w;case"value":return d;case"time":return N;default:return c}})(a.type);return e.jsxs(U.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*s},className:"border-b border-gray-700/50 hover:bg-gray-800/30 transition-colors",children:[e.jsxs(B,{children:[e.jsx("div",{className:"font-semibold text-white",children:a.name}),e.jsx("div",{className:"text-sm text-gray-400",children:a.description})]}),e.jsx(B,{children:e.jsxs(b,{className:"flex items-center gap-1 w-fit bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border-0",children:[e.jsx(i,{className:"h-3 w-3"}),a.type]})}),e.jsx(B,{className:"text-sm text-gray-300",children:Ke(a)}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-white",children:a.transactionCounter}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>(async e=>{await t.from("PaymentSplitRule").update({transactionCounter:0}).eq("id",e),W({title:"Sucesso!",description:"Contador resetado"}),fe()})(a.id),className:"hover:bg-blue-500/10",children:e.jsx(h,{className:"h-4 w-4"})})]})}),e.jsx(B,{children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"font-medium text-white",children:["Total: ",a.totalTransactions]}),e.jsxs("div",{className:"text-green-400 font-medium",children:["Admin: ",a.adminTransactions]}),e.jsxs("div",{className:"text-blue-400 font-medium",children:["Cliente: ",a.clientTransactions]})]})}),e.jsx(B,{children:a.isActive?e.jsx(b,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white border-0",children:"Ativa"}):e.jsx(b,{className:"bg-gray-700 text-gray-300 border-0",children:"Inativa"})}),e.jsx(B,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>(async(e,a)=>{await t.from("PaymentSplitRule").update({isActive:!a}).eq("id",e),W({title:"Sucesso!",description:"Regra "+(a?"desativada":"ativada")}),fe()})(a.id,a.isActive),className:"hover:bg-gray-800/50 text-gray-400",children:e.jsx(j,{className:"h-4 w-4 "+(a.isActive?"text-red-500":"text-green-500")})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>(e=>{de(e),ge({name:e.name,description:e.description||"",type:e.type,frequencyEvery:e.frequencyEvery||10,frequencyTake:e.frequencyTake||2,percentage:e.percentage||20,minValue:e.minValue||0,maxValue:e.maxValue||0,adminGatewayId:e.adminGatewayId||"",isActive:e.isActive,priority:e.priority}),le(!0)})(a),className:"hover:bg-blue-500/10 text-blue-400",children:e.jsx(v,{className:"h-4 w-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>(async e=>{confirm("Tem certeza que deseja excluir esta regra?")&&(await t.from("PaymentSplitRule").delete().eq("id",e),W({title:"Sucesso!",description:"Regra excluída"}),fe())})(a.id),className:"hover:bg-red-50 dark:hover:bg-red-950/20 text-red-600 dark:text-red-400",children:e.jsx(f,{className:"h-4 w-4"})})]})})]},a.id)})})]})})})]})})]})})}export{W as default};

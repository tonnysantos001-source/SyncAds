import{j as e}from"./vendor-ui-D3JNL6pE.js";import{r as a}from"./vendor-react-X41Bjl18.js";import{g as s,s as i,B as r,a5 as t,I as n,C as o,a as l,a8 as d,b as c,e as m,d as p,a7 as x,a9 as h,N as g,c as u,L as v}from"./index-DuPz7-3l.js";import{D as j,e as y,a as b,b as f,c as N,d as A,f as C}from"./dialog-Bic-JPfC.js";import{L as I}from"./label-D6zMyAuV.js";import{T as E}from"./textarea-C6Z5Zqna.js";import{S as w,a as O,b as R,c as G,d as T}from"./select-C2dohAwA.js";import{S as P}from"./SuperAdminLayout-ZWe05-60.js";import"./vendor-supabase-HUq0BeMy.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-animation-DtB50Lbk.js";import"./vendor-query-DqG_mm-v.js";import"./vendor-icons-BvRy6l6m.js";function k(){const[k,U]=a.useState([]),[S,L]=a.useState(!0),[K,M]=a.useState(!1),[z,F]=a.useState(!1),[q,H]=a.useState(null),{toast:$}=s(),[D,W]=a.useState({name:"",provider:"OPENAI",apiKey:"",baseUrl:"",model:"",maxTokens:4096,temperature:.7});a.useEffect(()=>{B()},[]);const B=async()=>{try{const{data:e,error:a}=await i.from("GlobalAiConnection").select("*").order("createdAt",{ascending:!1});if(a)throw a;U(e||[])}catch(e){$({title:"Erro ao carregar dados",description:e.message,variant:"destructive"})}finally{L(!1)}},Q={OPENAI:{model:"gpt-4o-mini",baseUrl:"https://api.openai.com/v1",description:"GPT-4, GPT-3.5, DALL-E, Whisper"},ANTHROPIC:{model:"claude-3-5-sonnet-20241022",baseUrl:"https://api.anthropic.com/v1",description:"Claude 3.5 Sonnet, Claude 3 Opus"},GOOGLE:{model:"gemini-2.0-flash-exp",baseUrl:"https://generativelanguage.googleapis.com/v1",description:"Gemini Pro, Gemini Flash"},OPENROUTER:{model:"openai/gpt-4-turbo",baseUrl:"https://openrouter.ai/api/v1",description:"Acesso a 200+ modelos (OpenAI, Anthropic, Google, Meta, etc)"},GROQ:{model:"llama-3.3-70b-versatile",baseUrl:"https://api.groq.com/openai/v1",description:"Llama 3.3, Mixtral - Ultra r√°pido"},COHERE:{model:"command-r-plus",baseUrl:"https://api.cohere.ai/v1",description:"Command R+, Command R"},MISTRAL:{model:"mistral-large-latest",baseUrl:"https://api.mistral.ai/v1",description:"Mistral Large, Mistral Medium"},PERPLEXITY:{model:"llama-3.1-sonar-large-128k-online",baseUrl:"https://api.perplexity.ai",description:"Sonar Online - IA com busca web"},TOGETHER:{model:"meta-llama/Meta-Llama-3.1-405B-Instruct-Turbo",baseUrl:"https://api.together.xyz/v1",description:"Llama, Qwen, DeepSeek"},FIREWORKS:{model:"accounts/fireworks/models/llama-v3p1-405b-instruct",baseUrl:"https://api.fireworks.ai/inference/v1",description:"Modelos open source otimizados"}};return S?e.jsx(P,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-76px)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})}):e.jsx(P,{children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Conex√µes de IA Globais"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Adicionar e gerenciar IAs que ser√£o atribu√≠das √†s organiza√ß√µes"})]}),e.jsxs(j,{open:K,onOpenChange:M,children:[e.jsx(y,{asChild:!0,children:e.jsxs(r,{children:[e.jsx(t,{className:"h-4 w-4 mr-2"}),"Nova IA"]})}),e.jsxs(b,{className:"sm:max-w-[500px] bg-gray-900 border-gray-700",children:[e.jsxs(f,{children:[e.jsx(N,{className:"text-white",children:"Nova Conex√£o de IA"}),e.jsx(A,{children:"Adicionar uma nova IA global ao sistema"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"name",className:"text-gray-300",children:"Nome"}),e.jsx(n,{id:"name",placeholder:"OpenAI GPT-4",value:D.name,onChange:e=>W({...D,name:e.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"provider",className:"text-gray-300",children:"Provider"}),e.jsxs(w,{value:D.provider,onValueChange:e=>{const a=Q[e];W({...D,provider:e,model:a?.model||"",baseUrl:a?.baseUrl||""})},children:[e.jsx(O,{children:e.jsx(R,{})}),e.jsxs(G,{children:[e.jsx(T,{value:"OPENAI",children:"ü§ñ OpenAI"}),e.jsx(T,{value:"ANTHROPIC",children:"üß† Anthropic (Claude)"}),e.jsx(T,{value:"GOOGLE",children:"üîµ Google (Gemini)"}),e.jsx(T,{value:"OPENROUTER",children:"üåê OpenRouter (200+ modelos)"}),e.jsx(T,{value:"GROQ",children:"‚ö° Groq (Ultra r√°pido)"}),e.jsx(T,{value:"MISTRAL",children:"üá´üá∑ Mistral AI"}),e.jsx(T,{value:"COHERE",children:"üíú Cohere"}),e.jsx(T,{value:"PERPLEXITY",children:"üîç Perplexity (Web)"}),e.jsx(T,{value:"TOGETHER",children:"ü§ù Together AI"}),e.jsx(T,{value:"FIREWORKS",children:"üéÜ Fireworks AI"})]})]}),Q[D.provider]&&e.jsx("p",{className:"text-xs text-gray-500",children:Q[D.provider].description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"apiKey",className:"text-gray-300",children:"API Key"}),e.jsx(n,{id:"apiKey",type:"password",placeholder:"sk-...",value:D.apiKey,onChange:e=>W({...D,apiKey:e.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"model",className:"text-gray-300",children:"Modelo"}),e.jsx(n,{id:"model",placeholder:Q[D.provider]?.model||"gpt-4-turbo",value:D.model,onChange:e=>W({...D,model:e.target.value})}),e.jsx("p",{className:"text-xs text-gray-500",children:"OPENROUTER"===D.provider?"Formato: provider/model (ex: openai/gpt-4-turbo, anthropic/claude-3-5-sonnet)":"Nome do modelo a ser usado"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"baseUrl",className:"text-gray-300",children:"Base URL"}),e.jsx(n,{id:"baseUrl",placeholder:Q[D.provider]?.baseUrl||"https://api.openai.com/v1",value:D.baseUrl,onChange:e=>W({...D,baseUrl:e.target.value})}),e.jsx("p",{className:"text-xs text-gray-500",children:"URL da API do provider"})]})]}),e.jsxs(C,{children:[e.jsx(r,{variant:"outline",onClick:()=>M(!1),children:"Cancelar"}),e.jsx(r,{onClick:async()=>{try{const{data:{user:e},error:a}=await i.auth.getUser();if(a||!e)throw new Error("Voc√™ precisa estar autenticado. Fa√ßa login novamente.");const{error:s}=await i.from("GlobalAiConnection").insert({name:D.name,provider:D.provider,apiKey:D.apiKey,baseUrl:D.baseUrl||null,model:D.model||null,maxTokens:D.maxTokens,temperature:D.temperature,isActive:!0});if(s)throw s;$({title:"‚úÖ IA adicionada!",description:`${D.name} foi criada com sucesso.`}),M(!1),B(),W({name:"",provider:"OPENAI",apiKey:"",baseUrl:"",model:"",maxTokens:4096,temperature:.7})}catch(e){$({title:"Erro ao criar IA",description:e.message,variant:"destructive"})}},children:"Criar IA"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mt-6",children:[k.map(a=>{return e.jsxs(o,{className:"border-gray-700/50 bg-gray-800/30 hover:bg-gray-800/50 transition-all",children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-pink-500 p-3 rounded-lg",children:e.jsx(d,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{children:a.name}),a.isActive&&e.jsx(m,{className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-300 border-green-500/30 border",children:"‚úì Testada"})]}),e.jsxs(p,{className:"mt-1 flex items-center gap-2",children:[(s=a.provider,e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${{OPENAI:"bg-green-100 text-green-800",ANTHROPIC:"bg-orange-100 text-orange-800",GOOGLE:"bg-blue-100 text-blue-800",OPENROUTER:"bg-indigo-100 text-indigo-800",GROQ:"bg-red-100 text-red-800",COHERE:"bg-purple-100 text-purple-800",MISTRAL:"bg-amber-100 text-amber-800",PERPLEXITY:"bg-cyan-100 text-cyan-800",TOGETHER:"bg-pink-100 text-pink-800",FIREWORKS:"bg-yellow-100 text-yellow-800"}[s]||"bg-gray-100 text-gray-800"}`,children:s})),a.model&&e.jsxs("span",{className:"text-sm",children:["‚Ä¢ ",a.model]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>(e=>{H(e),F(!0)})(a),title:"Configurar prompt e mensagens",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Configurar"]}),e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>(async e=>{try{if(!e.apiKey||e.apiKey.length<10)throw new Error("API Key inv√°lida ou muito curta");$({title:"üß™ Validando configura√ß√£o...",description:`Verificando ${e.provider}`});const{error:a}=await i.from("GlobalAiConnection").update({isActive:!0}).eq("id",e.id);if(a)throw a;U(a=>a.map(a=>a.id===e.id?{...a,isActive:!0}:a)),$({title:"‚úÖ Configura√ß√£o v√°lida!",description:`${e.provider} configurada e ativada. Teste no chat para confirmar funcionamento.`})}catch(a){$({title:"‚ùå Erro na valida√ß√£o",description:a.message,variant:"destructive"})}})(a),title:"Testar conex√£o com a IA",children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Testar"]}),e.jsx(r,{size:"sm",variant:a.isActive?"outline":"default",onClick:()=>(async(e,a)=>{try{const{error:s}=await i.from("GlobalAiConnection").update({isActive:!a}).eq("id",e);if(s)throw s;$({title:"Status atualizado",description:`IA ${a?"desativada":"ativada"}.`}),B()}catch(s){$({title:"Erro ao atualizar status",description:s.message,variant:"destructive"})}})(a.id,a.isActive),children:a.isActive?"Desativar":"Ativar"}),e.jsx(r,{size:"sm",variant:"destructive",onClick:()=>(async(e,a)=>{if(confirm(`Tem certeza que deseja remover "${a}"?\n\nEsta a√ß√£o n√£o pode ser desfeita.`))try{const{error:s}=await i.from("GlobalAiConnection").delete().eq("id",e);if(s)throw s;$({title:"üóëÔ∏è IA removida!",description:`${a} foi removida com sucesso.`}),B()}catch(s){$({title:"Erro ao remover IA",description:s.message,variant:"destructive"})}})(a.id,a.name),title:"Remover IA",children:e.jsx(g,{className:"h-4 w-4"})})]})]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"API Key"}),e.jsxs("div",{className:"font-mono text-xs mt-1",children:[a.apiKey.substring(0,10),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Max Tokens"}),e.jsx("div",{className:"font-medium mt-1",children:a.maxTokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Temperature"}),e.jsx("div",{className:"font-medium mt-1",children:a.temperature})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Criada em"}),e.jsx("div",{className:"font-medium mt-1",children:new Date(a.createdAt).toLocaleDateString("pt-BR")})]})]})})]},a.id);var s}),0===k.length&&e.jsx(o,{children:e.jsxs(u,{className:"py-12 text-center",children:[e.jsx(d,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhuma IA configurada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Adicione sua primeira conex√£o de IA para come√ßar"}),e.jsxs(r,{onClick:()=>M(!0),children:[e.jsx(t,{className:"h-4 w-4 mr-2"}),"Adicionar IA"]})]})})]}),e.jsx(j,{open:z,onOpenChange:F,children:e.jsxs(b,{className:"sm:max-w-[700px] max-h-[80vh] overflow-y-auto bg-gray-900 border-gray-700",children:[e.jsxs(f,{children:[e.jsxs(N,{children:["Configurar IA: ",q?.name]}),e.jsx(A,{children:"Configure o prompt de sistema e mensagens iniciais da IA"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"systemPrompt",children:"Prompt de Sistema"}),e.jsx(E,{id:"systemPrompt",value:q?.systemPrompt||"",onChange:e=>H(a=>a?{...a,systemPrompt:e.target.value}:null),rows:12,className:"font-mono text-sm",placeholder:"Digite o prompt de sistema que define o comportamento da IA..."}),e.jsx("p",{className:"text-xs text-gray-500",children:"Este prompt define a personalidade, capacidades e comportamento da IA. Seja espec√≠fico sobre o que a IA pode fazer."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{children:"Mensagens Iniciais"}),e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>{const e=[...q?.initialGreetings||[],"Nova mensagem inicial"];H(a=>a?{...a,initialGreetings:e}:null)},children:[e.jsx(t,{className:"h-4 w-4 mr-1"}),"Adicionar"]})]}),e.jsx("div",{className:"space-y-2",children:(q?.initialGreetings||[]).map((a,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{value:a,onChange:e=>{const a=[...q?.initialGreetings||[]];a[s]=e.target.value,H(e=>e?{...e,initialGreetings:a}:null)},placeholder:`Mensagem inicial ${s+1}`}),e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>{const e=(q?.initialGreetings||[]).filter((e,a)=>a!==s);H(a=>a?{...a,initialGreetings:e}:null)},children:e.jsx(v,{className:"h-4 w-4"})})]},s))}),e.jsx("p",{className:"text-xs text-gray-500",children:"A IA escolher√° aleatoriamente uma dessas mensagens para saudar novos usu√°rios."})]})]}),e.jsxs(C,{children:[e.jsx(r,{variant:"outline",onClick:()=>F(!1),children:"Cancelar"}),e.jsx(r,{onClick:async()=>{if(q)try{const{error:e}=await i.from("GlobalAiConnection").update({systemPrompt:q.systemPrompt,initialGreetings:q.initialGreetings}).eq("id",q.id);if(e)throw e;$({title:"‚úÖ Configura√ß√£o salva!",description:"Prompt e mensagens iniciais atualizados."}),F(!1),B()}catch(e){$({title:"Erro ao salvar configura√ß√£o",description:e.message,variant:"destructive"})}},children:"Salvar Configura√ß√£o"})]})]})})]})})}export{k as default};

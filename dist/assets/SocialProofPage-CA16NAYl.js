import{c as $,r as c,f as z,s as x,u as G,j as e,B as p,I as M,g as P,h as R,i as w,l as D,M as K,o as Y,U as Z}from"./index-CZgJ-4C2.js";import{T as ee,a as se,b as V,c as E,d as ae,e as N}from"./table-DkpI7PFR.js";import{D as te,a as re,b as ie,c as oe,d as le,f as ne}from"./dialog-BEosiNqZ.js";import{L as b}from"./label-u0VuXyVD.js";import{T as ce}from"./textarea-DJvKNgaZ.js";import{S as _}from"./skeleton-Dy9Ec6yb.js";import{A as de,a as me}from"./alert-BYmxbjhT.js";import{P as k}from"./plus-CKqE6IGT.js";import{M as I}from"./message-square-DriVfHQj.js";import{T as H}from"./trending-up-CTm0SaVN.js";import{S as ue}from"./sparkles-VvEentxv.js";import{S as pe}from"./square-pen-CZK7J2ka.js";import{T as xe}from"./trash-2-BFmyuikp.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=$("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),f=[{type:"RECENT_PURCHASE",message:"ðŸŽ‰ Maria de SÃ£o Paulo acabou de comprar hÃ¡ 3 minutos!",displayDuration:5,isActive:!0},{type:"RECENT_PURCHASE",message:"âœ¨ JoÃ£o do Rio de Janeiro finalizou uma compra agora!",displayDuration:5,isActive:!0},{type:"RECENT_PURCHASE",message:"ðŸ”¥ Ana de Belo Horizonte acabou de comprar este produto!",displayDuration:6,isActive:!0},{type:"VISITOR_COUNT",message:"ðŸ‘€ 38 pessoas estÃ£o visualizando este produto agora",displayDuration:7,isActive:!0},{type:"VISITOR_COUNT",message:"ðŸ”¥ +120 pessoas compraram nas Ãºltimas 24 horas",displayDuration:6,isActive:!0},{type:"VISITOR_COUNT",message:"âš¡ Mais de 50 pessoas adicionaram ao carrinho hoje",displayDuration:6,isActive:!0},{type:"REVIEW",message:'â­â­â­â­â­ "Produto excelente! Recomendo muito" - Carlos',displayDuration:8,isActive:!0},{type:"REVIEW",message:'â­â­â­â­â­ "Superou minhas expectativas!" - Juliana',displayDuration:7,isActive:!0},{type:"REVIEW",message:'â­â­â­â­â­ "Melhor compra que jÃ¡ fiz!" - Pedro',displayDuration:7,isActive:!0},{type:"RECENT_PURCHASE",message:"ðŸ’š AlguÃ©m de Curitiba acabou de fazer um pedido",displayDuration:5,isActive:!0},{type:"VISITOR_COUNT",message:"ðŸš¨ Apenas 3 unidades restantes em estoque!",displayDuration:8,isActive:!0},{type:"RECENT_PURCHASE",message:"ðŸŽŠ Patricia de Porto Alegre comprou hÃ¡ 7 minutos",displayDuration:5,isActive:!0}];function fe(){const[u,h]=c.useState(!1),{toast:d}=z(),g=()=>f,j=t=>f.filter(l=>l.type===t),T=()=>{const t=Math.floor(Math.random()*f.length);return f[t]},m=t=>[...f].sort(()=>Math.random()-.5).slice(0,Math.min(t,f.length));return{loading:u,getExamples:g,getExamplesByType:j,getRandomExample:T,getRandomExamples:m,createExamplesForUser:async(t,l=5)=>{if(!t)return d({title:"Erro",description:"ID do usuÃ¡rio nÃ£o fornecido",variant:"destructive"}),!1;h(!0);try{const{data:r,error:a}=await x.from("SocialProof").select("id").eq("userId",t).limit(1);if(a)throw a;if(r&&r.length>0)return d({title:"JÃ¡ existem provas sociais",description:"VocÃª jÃ¡ possui provas sociais configuradas."}),!1;const C=m(l).map(n=>({userId:t,type:n.type,message:n.message,displayDuration:n.displayDuration,isActive:n.isActive})),{error:o}=await x.from("SocialProof").insert(C);if(o)throw o;return d({title:"Exemplos criados!",description:`${l} provas sociais de exemplo foram adicionadas. VocÃª pode editÃ¡-las ou criar novas.`}),!0}catch(r){return console.error("Erro ao criar exemplos:",r),d({title:"Erro ao criar exemplos",description:r.message||"Tente novamente mais tarde",variant:"destructive"}),!1}finally{h(!1)}},createSingleExample:async(t,l)=>{if(!t)return!1;h(!0);try{const r=j(l);if(r.length===0)return!1;const a=r[Math.floor(Math.random()*r.length)],{error:y}=await x.from("SocialProof").insert({userId:t,type:a.type,message:a.message,displayDuration:a.displayDuration,isActive:a.isActive});if(y)throw y;return d({title:"Exemplo criado!",description:"Prova social adicionada com sucesso."}),!0}catch(r){return console.error("Erro ao criar exemplo:",r),d({title:"Erro ao criar exemplo",description:r.message,variant:"destructive"}),!1}finally{h(!1)}},getMessageSuggestions:t=>({RECENT_PURCHASE:["ðŸŽ‰ [Nome] de [Cidade] acabou de comprar hÃ¡ [tempo] minutos!","âœ¨ [Nome] finalizou uma compra agora!","ðŸ”¥ AlguÃ©m de [Cidade] acabou de comprar este produto!","ðŸ’š [Nome] acabou de fazer um pedido","ðŸŽŠ [Nome] de [Cidade] comprou hÃ¡ [tempo] minutos"],VISITOR_COUNT:["ðŸ‘€ [nÃºmero] pessoas estÃ£o visualizando este produto agora","ðŸ”¥ +[nÃºmero] pessoas compraram nas Ãºltimas 24 horas","âš¡ Mais de [nÃºmero] pessoas adicionaram ao carrinho hoje","ðŸš¨ Apenas [nÃºmero] unidades restantes em estoque!","ðŸ“ˆ Este produto estÃ¡ sendo muito procurado!"],REVIEW:['â­â­â­â­â­ "Produto excelente! Recomendo muito" - [Nome]','â­â­â­â­â­ "Superou minhas expectativas!" - [Nome]','â­â­â­â­â­ "Melhor compra que jÃ¡ fiz!" - [Nome]','â­â­â­â­â­ "Qualidade excepcional!" - [Nome]','â­â­â­â­â­ "Vale cada centavo!" - [Nome]']})[t]||[]}}const we=()=>{const[u,h]=c.useState([]),[d,g]=c.useState([]),[j,T]=c.useState(!0),[m,U]=c.useState(""),[O,v]=c.useState(!1),[t,l]=c.useState(null),{toast:r}=z(),a=G(s=>s.user),{createExamplesForUser:y,loading:C}=fe(),[o,n]=c.useState({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0});c.useEffect(()=>{S()},[]);const q=async()=>{if(!(a!=null&&a.id))return;await y(a.id,8)&&S()};c.useEffect(()=>{L()},[m,u]);const S=async()=>{try{if(!(a!=null&&a.id))return;const{data:s,error:i}=await x.from("SocialProof").select("*").eq("userId",a.id).order("createdAt",{ascending:!1});if(i)throw i;h(s||[]),g(s||[])}catch(s){r({title:"Erro ao carregar",description:s.message,variant:"destructive"})}finally{T(!1)}},L=()=>{if(!m){g(u);return}const s=u.filter(i=>i.message.toLowerCase().includes(m.toLowerCase()));g(s)},F=async s=>{s.preventDefault();try{if(!(a!=null&&a.id))return;if(t){const{error:i}=await x.from("SocialProof").update({...o,updatedAt:new Date().toISOString()}).eq("id",t.id);if(i)throw i;r({title:"Prova social atualizada!"})}else{const{error:i}=await x.from("SocialProof").insert({...o,userId:a.id});if(i)throw i;r({title:"Prova social criada!",description:"A notificaÃ§Ã£o estÃ¡ pronta para exibiÃ§Ã£o."})}v(!1),A(),S()}catch(i){r({title:"Erro",description:i.message,variant:"destructive"})}},W=async s=>{if(confirm("Tem certeza que deseja deletar esta prova social?"))try{const{error:i}=await x.from("SocialProof").delete().eq("id",s);if(i)throw i;r({title:"Prova social deletada"}),S()}catch(i){r({title:"Erro ao deletar",description:i.message,variant:"destructive"})}},B=s=>{l(s),n({type:s.type,message:s.message,displayDuration:s.displayDuration,isActive:s.isActive}),v(!0)},A=()=>{l(null),n({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0})},J=u.filter(s=>s.isActive).length,Q=s=>({RECENT_PURCHASE:"Compra Recente",VISITOR_COUNT:"Contador de Visitantes",REVIEW:"AvaliaÃ§Ã£o"})[s]||s,X=s=>{switch(s){case"RECENT_PURCHASE":return e.jsx(H,{className:"h-4 w-4"});case"VISITOR_COUNT":return e.jsx(Z,{className:"h-4 w-4"});case"REVIEW":return e.jsx(I,{className:"h-4 w-4"});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Prova Social"}),e.jsx("p",{className:"text-muted-foreground",children:"NotificaÃ§Ãµes em tempo real para aumentar confianÃ§a"})]}),e.jsxs(te,{open:O,onOpenChange:v,children:[e.jsx(re,{asChild:!0,children:e.jsxs(p,{onClick:A,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Criar Prova Social"]})}),e.jsxs(ie,{className:"max-w-lg",children:[e.jsx(oe,{children:e.jsx(le,{children:t?"Editar Prova Social":"Nova Prova Social"})}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Tipo *"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",value:o.type,onChange:s=>n({...o,type:s.target.value}),required:!0,children:[e.jsx("option",{value:"RECENT_PURCHASE",children:"Compra Recente"}),e.jsx("option",{value:"VISITOR_COUNT",children:"Contador de Visitantes"}),e.jsx("option",{value:"REVIEW",children:"AvaliaÃ§Ã£o"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o.type==="RECENT_PURCHASE"&&'Ex: "JoÃ£o acabou de comprar hÃ¡ 5 minutos"',o.type==="VISITOR_COUNT"&&'Ex: "23 pessoas estÃ£o visualizando este produto"',o.type==="REVIEW"&&'Ex: "â˜…â˜…â˜…â˜…â˜… Produto excelente! - Maria S."']})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Mensagem *"}),e.jsx(ce,{value:o.message,onChange:s=>n({...o,message:s.target.value}),placeholder:"Digite a mensagem que serÃ¡ exibida...",rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(b,{children:"DuraÃ§Ã£o de ExibiÃ§Ã£o (segundos)"}),e.jsx(M,{type:"number",min:"1",max:"30",value:o.displayDuration,onChange:s=>n({...o,displayDuration:parseInt(s.target.value)}),required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.isActive,onChange:s=>n({...o,isActive:s.target.checked}),className:"rounded"}),e.jsx(b,{children:"Ativo"})]}),e.jsxs(ne,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),e.jsx(p,{type:"submit",children:t?"Atualizar":"Criar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(P,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total"}),e.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:u.length})})]}),e.jsxs(P,{children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Ativas"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:J})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(M,{placeholder:"Buscar provas sociais...",value:m,onChange:s=>U(s.target.value),className:"pl-9"})]}),!j&&u.length===0&&e.jsxs(de,{className:"border-blue-200 bg-blue-50",children:[e.jsx(he,{className:"h-4 w-4 text-blue-600"}),e.jsxs(me,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Comece com exemplos prontos!"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Crie 8 provas sociais de exemplo para testar no seu checkout. VocÃª pode editÃ¡-las ou excluÃ­-las depois."})]}),e.jsxs(p,{onClick:q,disabled:C,className:"ml-4 bg-blue-600 hover:bg-blue-700",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),C?"Criando...":"Criar Exemplos"]})]})]}),e.jsxs(P,{children:[e.jsx(R,{children:e.jsx(w,{children:"Lista de Provas Sociais"})}),e.jsx(D,{children:j?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"h-12 w-full"}),e.jsx(_,{className:"h-12 w-full"})]}):d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhuma prova social encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:m?"Tente ajustar sua busca":"Comece criando a primeira prova social"}),!m&&e.jsxs(p,{onClick:A,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Criar Primeira Prova Social"]})]}):e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(V,{children:[e.jsx(E,{children:"Tipo"}),e.jsx(E,{children:"Mensagem"}),e.jsx(E,{children:"DuraÃ§Ã£o"}),e.jsx(E,{children:"Status"}),e.jsx(E,{className:"text-right",children:"AÃ§Ãµes"})]})}),e.jsx(ae,{children:d.map(s=>e.jsxs(V,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[X(s.type),e.jsx("span",{className:"text-sm",children:Q(s.type)})]})}),e.jsx(N,{className:"max-w-md truncate",children:s.message}),e.jsxs(N,{children:[s.displayDuration,"s"]}),e.jsx(N,{children:e.jsx(Y,{variant:s.isActive?"default":"secondary",children:s.isActive?"Ativa":"Inativa"})}),e.jsx(N,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>B(s),children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>W(s.id),children:e.jsx(xe,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})};export{we as default};

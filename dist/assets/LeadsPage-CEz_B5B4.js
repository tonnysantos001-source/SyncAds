import{j as e}from"./vendor-ui-Ba0j3nT4.js";import{r as a}from"./vendor-react-X41Bjl18.js";import{g as r,f as t,B as s,I as l,C as i,a as o,b as d,c as n,e as c}from"./index-D0_lz_P6.js";import{T as x,a as m,b as g,c as h,d as u,e as b}from"./table-BAHfzHV2.js";import{D as j,a as y,b as p,c as v,d as N,f}from"./dialog-BG-ObMIF.js";import{L as k}from"./label-DBFVh0rn.js";import{S as w,a as C,b as E,c as L,d as T}from"./select-BCkXVaAK.js";import{c as A}from"./customersApi-NXUoQkLN.js";import{S}from"./skeleton-DmBDcXpC.js";import{m as z}from"./vendor-animation-mzn7-F4O.js";import{aN as D,N as I,a$ as O,a_ as F,w as W,S as Q,as as $,Q as V,Y as q}from"./vendor-icons-BvRy6l6m.js";import"./vendor-supabase-D-IBGfoY.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-query-DXIrutT_.js";const R=({title:a,value:r,icon:t,color:s,delay:l=0,subtitle:c})=>e.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:l},children:e.jsxs(i,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${s} opacity-10 rounded-full blur-3xl`}),e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a}),e.jsx("div",{className:`p-2 rounded-lg ${s} bg-opacity-10`,children:e.jsx(t,{className:`h-5 w-5 ${s.replace("bg-","text-")}`})})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:r}),c&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:c})]})]})}),U=()=>{const[U,B]=a.useState([]),[G,P]=a.useState([]),[Y,_]=a.useState(!0),[H,J]=a.useState(""),[K,M]=a.useState("ALL"),[X,Z]=a.useState(!1),[ee,ae]=a.useState(null),{toast:re}=r(),te=t(e=>e.user),[se,le]=a.useState({name:"",email:"",phone:"",status:"NEW",source:""});a.useEffect(()=>{ie()},[]),a.useEffect(()=>{oe()},[H,K,U]);const ie=async()=>{try{if(!te?.organizationId)return;const e=await A.leads.list(te.organizationId);B(e),P(e)}catch(e){re({title:"Erro ao carregar leads",description:e.message,variant:"destructive"})}finally{_(!1)}},oe=()=>{let e=U;H&&(e=e.filter(e=>e.name?.toLowerCase().includes(H.toLowerCase())||e.email?.toLowerCase().includes(H.toLowerCase())||e.phone?.includes(H))),"ALL"!==K&&(e=e.filter(e=>e.status===K)),P(e)},de=()=>{ae(null),le({name:"",email:"",phone:"",status:"NEW",source:""})},ne=a=>{const r={NEW:{className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",label:"Novo",icon:O},CONTACTED:{className:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",label:"Contatado",icon:I},QUALIFIED:{className:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",label:"Qualificado",icon:W},CONVERTED:{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",label:"Convertido",icon:F}},t=r[a]||r.NEW,s=t.icon;return e.jsxs(c,{className:t.className,children:[e.jsx(s,{className:"h-3 w-3 mr-1"}),t.label]})},ce=U.filter(e=>"NEW"===e.status).length,xe=U.filter(e=>"CONVERTED"===e.status).length,me=U.length>0?(xe/U.length*100).toFixed(1):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-5xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent mb-2",children:"Leads"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-medium text-lg",children:"Gerencie seus leads e contatos"})]}),e.jsx(z.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:e.jsxs(j,{open:X,onOpenChange:Z,children:[e.jsx(y,{asChild:!0,children:e.jsxs(s,{onClick:de,size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(D,{className:"mr-2 h-5 w-5"}),"Adicionar Lead"]})}),e.jsxs(p,{className:"bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border-gray-200 dark:border-gray-700",children:[e.jsx(v,{children:e.jsx(N,{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:ee?"Editar Lead":"Novo Lead"})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{if(!te?.organizationId)return;ee?(await A.leads.update(ee.id,se),re({title:"Lead atualizado!"})):(await A.leads.create({...se,organizationId:te.organizationId}),re({title:"Lead criado!",description:"Novo lead adicionado com sucesso."})),Z(!1),de(),ie()}catch(a){re({title:"Erro",description:a.message,variant:"destructive"})}},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-gray-700 dark:text-gray-300",children:"Nome Completo"}),e.jsx(l,{value:se.name,onChange:e=>le({...se,name:e.target.value}),className:"mt-1.5 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",required:!0})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-gray-700 dark:text-gray-300",children:"E-mail"}),e.jsx(l,{type:"email",value:se.email,onChange:e=>le({...se,email:e.target.value}),className:"mt-1.5 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",required:!0})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-gray-700 dark:text-gray-300",children:"Telefone"}),e.jsx(l,{value:se.phone,onChange:e=>le({...se,phone:e.target.value}),placeholder:"(11) 99999-9999",className:"mt-1.5 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-gray-700 dark:text-gray-300",children:"Status"}),e.jsxs(w,{value:se.status,onValueChange:e=>le({...se,status:e}),children:[e.jsx(C,{className:"mt-1.5 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsx(E,{})}),e.jsxs(L,{children:[e.jsx(T,{value:"NEW",children:"Novo"}),e.jsx(T,{value:"CONTACTED",children:"Contatado"}),e.jsx(T,{value:"QUALIFIED",children:"Qualificado"}),e.jsx(T,{value:"CONVERTED",children:"Convertido"})]})]})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-gray-700 dark:text-gray-300",children:"Origem"}),e.jsx(l,{value:se.source,onChange:e=>le({...se,source:e.target.value}),placeholder:"Ex: Facebook, Google Ads...",className:"mt-1.5 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"})]})]}),e.jsxs(f,{className:"mt-6",children:[e.jsx(s,{type:"button",variant:"outline",onClick:()=>Z(!1),className:"border-gray-200 dark:border-gray-700",children:"Cancelar"}),e.jsx(s,{type:"submit",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:ee?"Atualizar":"Criar"})]})]})]})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(R,{title:"Total de Leads",value:U.length,icon:I,color:"bg-blue-500",delay:.1}),e.jsx(R,{title:"Novos",value:ce,icon:O,color:"bg-purple-500",delay:.2,subtitle:`${(ce/U.length*100||0).toFixed(0)}% do total`}),e.jsx(R,{title:"Convertidos",value:xe,icon:F,color:"bg-green-500",delay:.3,subtitle:`${(xe/U.length*100||0).toFixed(0)}% do total`}),e.jsx(R,{title:"Taxa de Conversão",value:`${me}%`,icon:W,color:"bg-pink-500",delay:.4})]}),e.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Q,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),e.jsx(l,{placeholder:"Buscar leads...",value:H,onChange:e=>J(e.target.value),className:"pl-12 h-12 border-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl shadow-lg text-base"})]}),e.jsxs(w,{value:K,onValueChange:M,children:[e.jsxs(C,{className:"w-full sm:w-64 h-12 border-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl shadow-lg",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),e.jsx(E,{placeholder:"Filtrar por status"})]}),e.jsxs(L,{children:[e.jsx(T,{value:"ALL",children:"Todos os Status"}),e.jsx(T,{value:"NEW",children:"Novos"}),e.jsx(T,{value:"CONTACTED",children:"Contatados"}),e.jsx(T,{value:"QUALIFIED",children:"Qualificados"}),e.jsx(T,{value:"CONVERTED",children:"Convertidos"})]})]})]}),e.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:e.jsxs(i,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(o,{children:e.jsx(d,{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Lista de Leads"})}),e.jsx(n,{children:Y?e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(a=>e.jsx(S,{className:"h-16 w-full"},a))}):0===G.length?e.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 opacity-20 blur-3xl rounded-full"}),e.jsx(I,{className:"relative h-20 w-20 text-gray-400 dark:text-gray-600"})]}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Nenhum lead encontrado"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md",children:H?"Tente ajustar os filtros de busca":"Comece adicionando o primeiro lead"}),!H&&e.jsxs(s,{onClick:()=>Z(!0),size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[e.jsx(D,{className:"mr-2 h-5 w-5"}),"Adicionar Primeiro Lead"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs(g,{className:"hover:bg-transparent border-gray-200 dark:border-gray-700",children:[e.jsx(h,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Nome"}),e.jsx(h,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"E-mail"}),e.jsx(h,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Telefone"}),e.jsx(h,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Origem"}),e.jsx(h,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Status"}),e.jsx(h,{className:"text-right font-semibold text-gray-700 dark:text-gray-300",children:"Ações"})]})}),e.jsx(u,{children:G.map((a,r)=>e.jsxs(z.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.05*r},className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors border-gray-200 dark:border-gray-700",children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-semibold",children:a.name.charAt(0).toUpperCase()}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:a.name})]})}),e.jsx(b,{className:"text-gray-600 dark:text-gray-300",children:a.email}),e.jsx(b,{className:"text-sm text-gray-500 dark:text-gray-400",children:a.phone||"-"}),e.jsx(b,{className:"text-sm text-gray-500 dark:text-gray-400",children:a.source||"-"}),e.jsx(b,{children:ne(a.status)}),e.jsx(b,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(s,{variant:"ghost",size:"icon",onClick:()=>(e=>{ae(e),le({name:e.name||"",email:e.email||"",phone:e.phone||"",status:e.status||"NEW",source:e.source||""}),Z(!0)})(a),className:"hover:bg-blue-100 dark:hover:bg-blue-900/30 hover:text-blue-600 dark:hover:text-blue-400",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(s,{variant:"ghost",size:"icon",onClick:()=>(async e=>{if(confirm("Tem certeza que deseja deletar este lead?"))try{await A.leads.delete(e),re({title:"Lead deletado"}),ie()}catch(a){re({title:"Erro ao deletar",description:a.message,variant:"destructive"})}})(a.id),className:"hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-600 dark:hover:text-red-400",children:e.jsx(q,{className:"h-4 w-4"})})]})})]},a.id))})]})})})]})})]})};export{U as default};

import{f as S,u as C,r as n,s as v,j as a,g as y,l as k,I as d,B as j}from"./index-DWWt1LWg.js";import{L as m}from"./label-BxO9yO0s.js";import{A as E,b as A}from"./alert-CG_Oh_nZ.js";import{C as D}from"./circle-alert-DTbl8JK1.js";const O=()=>{const{toast:o}=S(),s=C(e=>e.user),[p,x]=n.useState(!0),[l,u]=n.useState(!1),[t,i]=n.useState({creditCard:"",pix:"",bankSlip:""});n.useEffect(()=>{s!=null&&s.organizationId&&g()},[s==null?void 0:s.organizationId]);const g=async()=>{var e,h,f;try{x(!0);const{data:r,error:c}=await v.from("PaymentDiscount").select("*").eq("organizationId",s==null?void 0:s.organizationId).single();if(c&&c.code!=="PGRST116")throw c;r&&i({creditCard:((e=r.creditCard)==null?void 0:e.toString())||"",pix:((h=r.pix)==null?void 0:h.toString())||"",bankSlip:((f=r.bankSlip)==null?void 0:f.toString())||""})}catch(r){console.error("Erro ao carregar descontos:",r),o({title:"Erro ao carregar descontos",description:"Não foi possível carregar as configurações",variant:"destructive"})}finally{x(!1)}},b=async()=>{if(s!=null&&s.organizationId){u(!0);try{const{error:e}=await v.from("PaymentDiscount").upsert({organizationId:s.organizationId,creditCard:t.creditCard?parseFloat(t.creditCard):null,pix:t.pix?parseFloat(t.pix):null,bankSlip:t.bankSlip?parseFloat(t.bankSlip):null,updatedAt:new Date().toISOString()});if(e)throw e;o({title:"Descontos salvos!",description:"Suas configurações foram salvas com sucesso"})}catch(e){console.error("Erro ao salvar descontos:",e),o({title:"Erro ao salvar",description:"Não foi possível salvar os descontos",variant:"destructive"})}finally{u(!1)}}},N=()=>{g()};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"DESCONTO POR FORMA DE PAGAMENTO"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Ofereça descontos por forma de pagamento."})]}),a.jsx(y,{children:a.jsxs(k,{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx(m,{htmlFor:"creditCard",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cartão de crédito"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d,{id:"creditCard",type:"number",placeholder:"0",value:t.creditCard,onChange:e=>i({...t,creditCard:e.target.value}),className:"flex-1",min:"0",max:"100"}),a.jsx("span",{className:"text-gray-500 font-medium",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(m,{htmlFor:"pix",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Pix"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d,{id:"pix",type:"number",placeholder:"0",value:t.pix,onChange:e=>i({...t,pix:e.target.value}),className:"flex-1",min:"0",max:"100"}),a.jsx("span",{className:"text-gray-500 font-medium",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(m,{htmlFor:"bankSlip",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Boleto bancário"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d,{id:"bankSlip",type:"number",placeholder:"0",value:t.bankSlip,onChange:e=>i({...t,bankSlip:e.target.value}),className:"flex-1",min:"0",max:"100"}),a.jsx("span",{className:"text-gray-500 font-medium",children:"%"})]})]}),a.jsxs(E,{className:"border-pink-200 bg-pink-50",children:[a.jsx(D,{className:"h-4 w-4 text-pink-600"}),a.jsxs(A,{className:"text-pink-900",children:["Está com dúvidas?"," ",a.jsx("a",{href:"#",className:"font-medium underline hover:no-underline",children:"Aprenda como criar um desconto por forma de pagamento"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx(j,{onClick:N,variant:"outline",className:"px-6",disabled:l||p,children:"Cancelar"}),a.jsx(j,{onClick:b,className:"bg-pink-600 hover:bg-pink-700 text-white px-6",disabled:l||p,children:l?"Salvando...":"Salvar"})]})]})})]})};export{O as default};

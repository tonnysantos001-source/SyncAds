import{c as ne,s as d,e as ce,u as ie,r as w,j as e,B as x,aq as oe,ar as le,n as M,g as h,h as f,i as y,k as b,l as p,C as F,b as U}from"./index-CEXMgJKd.js";import{A as de,a as me}from"./alert-B_RA6LHa.js";import{S as D}from"./skeleton-pR7EoDLr.js";import{D as ue}from"./download-BGIf_dVP.js";import{C as A}from"./circle-check-CNODdrRL.js";import{C}from"./circle-x-08hHWu4U.js";import{A as S}from"./arrow-right-ZegssESx.js";import{D as ge}from"./dollar-sign-BU5r-GUa.js";import{T as $}from"./trending-up-BhiWmNbR.js";import{T as xe}from"./trending-down-BfxP8Ghb.js";import{C as he}from"./clock-46CHvlLm.js";import{C as fe}from"./circle-alert-CaNI2gv_.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=ne("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),j={async getCheckoutMetrics(i,a={period:"month"}){try{const{data:t,error:c}=await d.from("CheckoutMetricsView").select("*").eq("organizationId",i).single();if(!c&&t)return{totalTransactions:t.totalTransactions||0,successfulTransactions:t.successfulTransactions||0,failedTransactions:t.failedTransactions||0,pendingTransactions:t.pendingTransactions||0,refundedTransactions:t.refundedTransactions||0,totalRevenue:Number(t.totalRevenue)||0,refundedRevenue:Number(t.refundedRevenue)||0,netRevenue:Number(t.totalRevenue)-Number(t.refundedRevenue)||0,avgTicket:Number(t.avgTicket)||0,successRate:Number(t.successRate)||0,failureRate:100-Number(t.successRate)||0,conversionRate:Number(t.successRate)||0};const r=a.startDate||new Date(Date.now()-30*24*60*60*1e3),l=a.endDate||new Date,{data:n,error:u}=await d.from("Transaction").select("*").eq("userId",i).gte("createdAt",r.toISOString()).lte("createdAt",l.toISOString());if(u)throw u;const o={totalTransactions:(n==null?void 0:n.length)||0,successfulTransactions:(n==null?void 0:n.filter(m=>m.status==="PAID").length)||0,failedTransactions:(n==null?void 0:n.filter(m=>m.status==="FAILED").length)||0,pendingTransactions:(n==null?void 0:n.filter(m=>m.status==="PENDING").length)||0,refundedTransactions:(n==null?void 0:n.filter(m=>m.status==="REFUNDED").length)||0,totalRevenue:(n==null?void 0:n.filter(m=>m.status==="PAID").reduce((m,v)=>m+Number(v.amount),0))||0,refundedRevenue:(n==null?void 0:n.filter(m=>m.status==="REFUNDED").reduce((m,v)=>m+Number(v.amount),0))||0,netRevenue:0,avgTicket:0,successRate:0,failureRate:0,conversionRate:0};return o.netRevenue=o.totalRevenue-o.refundedRevenue,o.successfulTransactions>0&&(o.avgTicket=o.totalRevenue/o.successfulTransactions),o.totalTransactions>0&&(o.successRate=o.successfulTransactions/o.totalTransactions*100,o.failureRate=o.failedTransactions/o.totalTransactions*100,o.conversionRate=o.successRate),o}catch(t){throw console.error("Error fetching checkout metrics:",t),t}},async getGatewayMetrics(i){try{const{data:a,error:t}=await d.from("GatewayPerformanceView").select("*").eq("organizationId",i).order("totalRevenue",{ascending:!1});if(t)throw t;return(a||[]).map(c=>({gatewayId:c.gatewayId,gatewayName:c.gatewayName,gatewaySlug:c.gatewaySlug,totalTransactions:c.totalTransactions||0,successfulTransactions:c.successfulTransactions||0,failedTransactions:c.failedTransactions||0,totalRevenue:Number(c.totalRevenue)||0,avgTicket:Number(c.avgTicket)||0,successRate:Number(c.successRate)||0,failureRate:100-Number(c.successRate)||0,pixCount:c.pixCount||0,boletoCount:c.boletoCount||0,creditCardCount:c.creditCardCount||0}))}catch(a){throw console.error("Error fetching gateway metrics:",a),a}},async getActiveAlerts(i){try{const{data:a}=await d.from("User").select("organizationId").eq("id",i).single();if(!(a!=null&&a.organizationId))return[];const{data:t,error:c}=await d.from("PaymentAlert").select(`
          *,
          Gateway:gatewayId (
            name
          )
        `).eq("organizationId",a.organizationId).eq("status","active").order("severity",{ascending:!1}).order("createdAt",{ascending:!1});if(c)throw c;return(t||[]).map(r=>{var l;return{id:r.id,alertType:r.alertType,severity:r.severity,title:r.title,message:r.message,currentValue:r.currentValue?Number(r.currentValue):void 0,threshold:r.threshold,status:r.status,gatewayId:r.gatewayId,gatewayName:(l=r.Gateway)==null?void 0:l.name,createdAt:r.createdAt,acknowledgedAt:r.acknowledgedAt,resolvedAt:r.resolvedAt}})}catch(a){return console.error("Error fetching alerts:",a),[]}},async acknowledgeAlert(i,a){try{const{error:t}=await d.from("PaymentAlert").update({status:"acknowledged",acknowledgedBy:a,acknowledgedAt:new Date().toISOString()}).eq("id",i);if(t)throw t}catch(t){throw console.error("Error acknowledging alert:",t),t}},async resolveAlert(i){try{const{error:a}=await d.from("PaymentAlert").update({status:"resolved",resolvedAt:new Date().toISOString()}).eq("id",i);if(a)throw a}catch(a){throw console.error("Error resolving alert:",a),a}},async getPaymentEvents(i,a){try{const{data:t}=await d.from("User").select("organizationId").eq("id",i).single();if(!(t!=null&&t.organizationId))return[];let c=d.from("PaymentEvent").select("*").eq("organizationId",t.organizationId).order("createdAt",{ascending:!1}).limit((a==null?void 0:a.limit)||100);a!=null&&a.severity&&(c=c.eq("severity",a.severity)),a!=null&&a.eventType&&(c=c.eq("eventType",a.eventType)),a!=null&&a.transactionId&&(c=c.eq("transactionId",a.transactionId));const{data:r,error:l}=await c;if(l)throw l;return(r||[]).map(n=>({id:n.id,eventType:n.eventType,eventData:n.eventData,severity:n.severity,transactionId:n.transactionId,orderId:n.orderId,gatewayId:n.gatewayId,errorMessage:n.errorMessage,processingTime:n.processingTime,createdAt:n.createdAt}))}catch(t){return console.error("Error fetching payment events:",t),[]}},async getTransactionReport(i,a){try{let t=d.from("Transaction").select(`
          *,
          Gateway:gatewayId (
            name
          )
        `,{count:"exact"}).eq("userId",i).order("createdAt",{ascending:!1});a!=null&&a.status&&(t=t.eq("status",a.status)),a!=null&&a.gatewayId&&(t=t.eq("gatewayId",a.gatewayId)),a!=null&&a.paymentMethod&&(t=t.eq("paymentMethod",a.paymentMethod)),a!=null&&a.startDate&&(t=t.gte("createdAt",a.startDate.toISOString())),a!=null&&a.endDate&&(t=t.lte("createdAt",a.endDate.toISOString())),a!=null&&a.limit&&(t=t.limit(a.limit)),a!=null&&a.offset&&(t=t.range(a.offset,a.offset+(a.limit||50)-1));const{data:c,error:r,count:l}=await t;if(r)throw r;return{transactions:(c||[]).map(u=>{var o;return{id:u.id,orderId:u.orderId,gatewayName:((o=u.Gateway)==null?void 0:o.name)||"N/A",paymentMethod:u.paymentMethod,amount:Number(u.amount),status:u.status,failureReason:u.failureReason,createdAt:u.createdAt,paidAt:u.paidAt,processingTime:u.processingTime}}),total:l||0}}catch(t){throw console.error("Error fetching transaction report:",t),t}},async getGatewaySuccessRates(i){try{const{data:a}=await d.from("User").select("organizationId").eq("id",i).single();if(!(a!=null&&a.organizationId))return[];const{data:t,error:c}=await d.from("GatewayPerformanceView").select("*").eq("organizationId",a.organizationId).order("successRate",{ascending:!1});if(c)throw c;return(t||[]).map(r=>({gatewayId:r.gatewayId,gatewayName:r.gatewayName,gatewaySlug:r.gatewaySlug,successRate:Number(r.successRate)||0,totalTransactions:r.totalTransactions||0,successfulTransactions:r.successfulTransactions||0,failedTransactions:r.failedTransactions||0,lastUpdated:r.calculatedAt}))}catch(a){return console.error("Error fetching gateway success rates:",a),[]}},async getFailingGateways(i){try{const{data:a}=await d.from("User").select("organizationId").eq("id",i).single();if(!(a!=null&&a.organizationId))return[];const{data:t,error:c}=await d.from("FailingGatewaysView").select("*").eq("organizationId",a.organizationId).order("failureRate",{ascending:!1});if(c)throw c;return(t||[]).map(r=>({gatewayId:r.gatewayId,gatewayName:r.gatewayName,gatewaySlug:r.gatewaySlug,failureCount:r.failureCount||0,totalAttempts:r.totalAttempts||0,failureRate:Number(r.failureRate)||0,lastFailureAt:r.lastFailureAt}))}catch(a){return console.error("Error fetching failing gateways:",a),[]}},async exportTransactionReport(i,a){try{const{transactions:t}=await this.getTransactionReport(i,{...a,limit:1e4}),c=`ID,Order ID,Gateway,Payment Method,Amount,Status,Created At,Paid At,Failure Reason
`,r=t.map(n=>`${n.id},${n.orderId},${n.gatewayName},${n.paymentMethod},${n.amount},${n.status},${n.createdAt},${n.paidAt||""},${n.failureReason||""}`).join(`
`),l=c+r;return new Blob([l],{type:"text/csv;charset=utf-8;"})}catch(t){throw console.error("Error exporting report:",t),t}},async refreshMetrics(){try{const{error:i}=await d.rpc("refresh_payment_metrics");if(i)throw i}catch(i){throw console.error("Error refreshing metrics:",i),i}},async getRetryStats(i){try{const{data:a}=await d.from("User").select("organizationId").eq("id",i).single();if(!(a!=null&&a.organizationId))return{pending:0,processing:0,success:0,failed:0};const{data:t,error:c}=await d.from("PaymentRetryQueue").select("status").eq("organizationId",a.organizationId);if(c)throw c;const r={pending:0,processing:0,success:0,failed:0};return(t||[]).forEach(l=>{l.status==="pending"?r.pending++:l.status==="processing"?r.processing++:l.status==="success"?r.success++:l.status==="failed"&&r.failed++}),r}catch(a){return console.error("Error fetching retry stats:",a),{pending:0,processing:0,success:0,failed:0}}}},Ce=()=>{const i=ce(),a=ie(s=>s.user),[t,c]=w.useState({totalTransactions:0,successfulTransactions:0,failedTransactions:0,pendingTransactions:0,refundedTransactions:0,totalRevenue:0,refundedRevenue:0,netRevenue:0,avgTicket:0,successRate:0,failureRate:0,conversionRate:0}),[r,l]=w.useState(!0),[n,u]=w.useState([]),[o,m]=w.useState([]),[v,L]=w.useState([]),[E,O]=w.useState([]),[R,B]=w.useState({pending:0,processing:0,success:0,failed:0}),[g,z]=w.useState({billing:!1,domain:!1,gateway:!1,shipping:!1,loading:!0});w.useEffect(()=>{a!=null&&a.id&&q()},[a==null?void 0:a.id]);const q=async()=>{l(!0);try{await Promise.all([H(),G(),_(),Q(),X(),J(),K()])}catch(s){console.error("❌ Erro ao carregar dados:",s)}finally{l(!1)}},H=async()=>{if(a!=null&&a.id)try{const s=await j.getCheckoutMetrics(a.id);c(s)}catch(s){console.error("Erro ao carregar métricas:",s)}},G=async()=>{if(a!=null&&a.id)try{const s=await j.getActiveAlerts(a.id);u(s)}catch(s){console.error("Erro ao carregar alertas:",s)}},_=async()=>{if(a!=null&&a.id)try{const s=await j.getGatewayMetrics(a.id);m(s.slice(0,5))}catch(s){console.error("Erro ao carregar métricas de gateway:",s)}},Q=async()=>{if(a!=null&&a.id)try{const s=await j.getGatewaySuccessRates(a.id);L(s.slice(0,5))}catch(s){console.error("Erro ao carregar taxas de sucesso:",s)}},X=async()=>{if(a!=null&&a.id)try{const s=await j.getFailingGateways(a.id);O(s)}catch(s){console.error("Erro ao carregar gateways com falha:",s)}},J=async()=>{if(a!=null&&a.id)try{const s=await j.getRetryStats(a.id);B(s)}catch(s){console.error("Erro ao carregar stats de retry:",s)}},K=async()=>{if(a!=null&&a.id)try{const[s,N,T,re]=await Promise.all([W(),Y(),Z(),ee()]);z({billing:s,domain:N,gateway:T,shipping:re,loading:!1})}catch(s){console.error("Erro ao verificar setup:",s),z(N=>({...N,loading:!1}))}},W=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:s}=await d.from("User").select("currentPlanId").eq("id",a.id).single();return!!(s!=null&&s.currentPlanId)}catch{return!1}},Y=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:s}=await d.from("User").select("domain, domainVerified").eq("id",a.id).single();return!!(s!=null&&s.domain&&(s!=null&&s.domainVerified))}catch{return!1}},Z=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:s}=await d.from("GatewayConfig").select("id").eq("userId",a.id).eq("isActive",!0).limit(1);return((s==null?void 0:s.length)||0)>0}catch{return!1}},ee=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:s}=await d.from("ShippingMethod").select("id").eq("userId",a.id).eq("isActive",!0).limit(1);return((s==null?void 0:s.length)||0)>0}catch{return!1}},ae=async()=>{l(!0);try{await j.refreshMetrics(),await q()}catch(s){console.error("Erro ao atualizar métricas:",s)}finally{l(!1)}},se=async s=>{if(a!=null&&a.id)try{await j.acknowledgeAlert(s,a.id),await G()}catch(N){console.error("Erro ao reconhecer alerta:",N)}},te=async()=>{if(a!=null&&a.id)try{const s=await j.exportTransactionReport(a.id,{startDate:new Date(Date.now()-2592e6),endDate:new Date}),N=window.URL.createObjectURL(s),T=document.createElement("a");T.href=N,T.download=`transacoes_${new Date().toISOString().split("T")[0]}.csv`,T.click(),window.URL.revokeObjectURL(N)}catch(s){console.error("Erro ao exportar relatório:",s)}},I=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),k=s=>`${s.toFixed(1)}%`,P=g.loading?0:[g.billing,g.domain,g.gateway,g.shipping].filter(Boolean).length*25;return r&&t.totalTransactions===0?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(D,{className:"h-8 w-64"}),e.jsx(D,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(s=>e.jsx(D,{className:"h-32"},s))})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dashboard de Pagamentos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Métricas e relatórios completos do checkout"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:te,children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:ae,disabled:r,children:[e.jsx(oe,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`}),"Atualizar"]})]})]}),n.length>0&&e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs(de,{variant:s.severity==="critical"?"destructive":"default",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsxs(me,{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:s.title}),e.jsx("p",{className:"text-sm mt-1",children:s.message}),s.gatewayName&&e.jsx(M,{variant:"outline",className:"mt-2",children:s.gatewayName})]}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>se(s.id),children:"Reconhecer"})]})]},s.id))}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-blue-500"}),"Configuração do Checkout"]}),e.jsx(b,{children:"Complete a configuração para começar a receber pagamentos"})]}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Progresso"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[P,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${P}%`}})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[g.billing?e.jsx(A,{className:"w-5 h-5 text-green-500"}):e.jsx(C,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-sm",children:"Plano de Faturamento"}),!g.billing&&e.jsxs(x,{size:"sm",variant:"link",className:"ml-auto",onClick:()=>i("/billing"),children:["Configurar ",e.jsx(S,{className:"w-3 h-3 ml-1"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g.domain?e.jsx(A,{className:"w-5 h-5 text-green-500"}):e.jsx(C,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-sm",children:"Domínio Verificado"}),!g.domain&&e.jsxs(x,{size:"sm",variant:"link",className:"ml-auto",onClick:()=>i("/checkout/domain"),children:["Configurar ",e.jsx(S,{className:"w-3 h-3 ml-1"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g.gateway?e.jsx(A,{className:"w-5 h-5 text-green-500"}):e.jsx(C,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-sm",children:"Gateway de Pagamento"}),!g.gateway&&e.jsxs(x,{size:"sm",variant:"link",className:"ml-auto",onClick:()=>i("/checkout/gateways"),children:["Configurar ",e.jsx(S,{className:"w-3 h-3 ml-1"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g.shipping?e.jsx(A,{className:"w-5 h-5 text-green-500"}):e.jsx(C,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-sm",children:"Métodos de Envio"}),!g.shipping&&e.jsxs(x,{size:"sm",variant:"link",className:"ml-auto",onClick:()=>i("/checkout/shipping"),children:["Configurar ",e.jsx(S,{className:"w-3 h-3 ml-1"})]})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(h,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(y,{className:"text-sm font-medium",children:"Receita Total"}),e.jsx(ge,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:I(t.totalRevenue)}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx($,{className:"h-3 w-3 text-green-500"}),"Líquido: ",I(t.netRevenue)]})]})]}),e.jsxs(h,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(y,{className:"text-sm font-medium",children:"Transações"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.totalTransactions}),e.jsxs("div",{className:"flex gap-3 mt-1",children:[e.jsxs("p",{className:"text-xs text-green-600",children:["✓ ",t.successfulTransactions]}),e.jsxs("p",{className:"text-xs text-red-600",children:["✗ ",t.failedTransactions]}),e.jsxs("p",{className:"text-xs text-yellow-600",children:["⏳ ",t.pendingTransactions]})]})]})]}),e.jsxs(h,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(y,{className:"text-sm font-medium",children:"Taxa de Sucesso"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k(t.successRate)}),e.jsx("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:t.successRate>=80?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-3 w-3 text-green-500"}),"Excelente performance"]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-3 w-3 text-red-500"}),"Abaixo do esperado"]})})]})]}),e.jsxs(h,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(y,{className:"text-sm font-medium",children:"Ticket Médio"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"text-2xl font-bold",children:I(t.avgTicket)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Por transação aprovada"})]})]})]}),(R.pending>0||R.processing>0)&&e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-yellow-500"}),"Fila de Retry Automático"]}),e.jsx(b,{children:"Transações sendo reprocessadas automaticamente"})]}),e.jsx(p,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pendentes"}),e.jsx("p",{className:"text-2xl font-bold",children:R.pending})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Processando"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:R.processing})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Sucesso"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:R.success})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Falhou"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:R.failed})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsx(y,{children:"Top 5 Gateways por Receita"}),e.jsx(b,{children:"Gateways com maior volume de transações"})]}),e.jsx(p,{children:o.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Nenhuma transação registrada ainda"}):e.jsx("div",{className:"space-y-3",children:o.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.gatewayName}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.totalTransactions," transações"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold",children:I(s.totalRevenue)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[k(s.successRate)," sucesso"]})]})]},s.gatewayId))})})]}),e.jsxs(h,{children:[e.jsxs(f,{children:[e.jsx(y,{children:"Taxa de Sucesso por Gateway"}),e.jsx(b,{children:"Performance de cada gateway configurado"})]}),e.jsx(p,{children:v.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Configure um gateway para começar"}):e.jsx("div",{className:"space-y-3",children:v.map(s=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:s.gatewayName}),e.jsx("span",{className:"text-sm font-bold",children:k(s.successRate)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${s.successRate>=80?"bg-green-500":s.successRate>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${s.successRate}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.successfulTransactions," de"," ",s.totalTransactions," transações"]})]},s.gatewayId))})})]})]}),E.length>0&&e.jsxs(h,{className:"border-red-200 dark:border-red-900",children:[e.jsxs(f,{children:[e.jsxs(y,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(fe,{className:"w-5 h-5"}),"Gateways com Alta Taxa de Falha"]}),e.jsx(b,{children:"Estes gateways precisam de atenção urgente"})]}),e.jsx(p,{children:e.jsx("div",{className:"space-y-3",children:E.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-900 dark:text-red-100",children:s.gatewayName}),e.jsxs("p",{className:"text-sm text-red-600 dark:text-red-400",children:[s.failureCount," falhas em ",s.totalAttempts," ","tentativas"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(M,{variant:"destructive",children:k(s.failureRate)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Última falha:"," ",new Date(s.lastFailureAt).toLocaleDateString()]})]})]},s.gatewayId))})})]}),e.jsxs(h,{children:[e.jsx(f,{children:e.jsx(y,{children:"Ações Rápidas"})}),e.jsx(p,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>i("/checkout/gateways"),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Gerenciar Gateways"]}),e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>i("/orders/all"),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Ver Todas Transações"]}),e.jsxs(x,{variant:"outline",className:"justify-start",onClick:()=>i("/checkout/customize"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Personalizar Checkout"]})]})})]})]})};export{Ce as default};

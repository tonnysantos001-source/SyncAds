import{c as J,r as t,f as Q,s as o,j as e,B as n,I as g,g as b,h as W,a as N,i as X,n as y,k as Y,l as C,d as Z}from"./index-DKyyon9m.js";import{D as I,f as _,a as w,b as O,c as k,d as D,e as S}from"./dialog-3ciyg0P0.js";import{L as m}from"./label-3OPg2MSJ.js";import{S as ee,a as ae,b as se,c as re,d as p}from"./select-CmSe0ElJ.js";import{S as z}from"./SuperAdminLayout-y9gva4ZH.js";import{P as E}from"./plus-C-xQBfxh.js";import"./index-CbDtDFJK.js";import"./index-Cxz1Wjyj.js";import"./Logo-D6EfprG9.js";import"./message-square-Dxun95XH.js";import"./dollar-sign-BuSPoHah.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=J("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);function ue(){const[v,T]=t.useState([]),[P,G]=t.useState([]),[K,L]=t.useState(!0),[U,x]=t.useState(!1),[B,h]=t.useState(!1),[A,F]=t.useState(""),{toast:l}=Q(),[r,c]=t.useState({name:"",provider:"OPENAI",apiKey:"",baseUrl:"",model:"",maxTokens:4096,temperature:.7}),[d,u]=t.useState([]);t.useEffect(()=>{j()},[]);const j=async()=>{try{const{data:a,error:s}=await o.from("GlobalAiConnection").select("*").order("createdAt",{ascending:!1});if(s)throw s;T(a||[]);const{data:i,error:f}=await o.from("Organization").select("id, name").order("name");if(f)throw f;G(i||[])}catch(a){l({title:"Erro ao carregar dados",description:a.message,variant:"destructive"})}finally{L(!1)}},H=async()=>{try{const{error:a}=await o.from("GlobalAiConnection").insert({name:r.name,provider:r.provider,apiKey:r.apiKey,baseUrl:r.baseUrl||null,model:r.model||null,maxTokens:r.maxTokens,temperature:r.temperature,isActive:!0});if(a)throw a;l({title:"✅ IA adicionada!",description:`${r.name} foi criada com sucesso.`}),x(!1),j(),c({name:"",provider:"OPENAI",apiKey:"",baseUrl:"",model:"",maxTokens:4096,temperature:.7})}catch(a){l({title:"Erro ao criar IA",description:a.message,variant:"destructive"})}},R=async(a,s)=>{try{const{error:i}=await o.from("GlobalAiConnection").update({isActive:!s}).eq("id",a);if(i)throw i;l({title:"Status atualizado",description:`IA ${s?"desativada":"ativada"}.`}),j()}catch(i){l({title:"Erro ao atualizar status",description:i.message,variant:"destructive"})}},q=async a=>{F(a);const{data:s}=await o.from("OrganizationAiConnection").select("organizationId").eq("globalAiConnectionId",a);u((s==null?void 0:s.map(i=>i.organizationId))||[]),h(!0)},$=async()=>{try{await o.from("OrganizationAiConnection").delete().eq("globalAiConnectionId",A);const a=d.map(s=>({organizationId:s,globalAiConnectionId:A,isDefault:!1}));if(a.length>0){const{error:s}=await o.from("OrganizationAiConnection").insert(a);if(s)throw s}l({title:"✅ IA atribuída!",description:`IA atribuída para ${d.length} organizações.`}),h(!1),u([])}catch(a){l({title:"Erro ao atribuir IA",description:a.message,variant:"destructive"})}},M=a=>{u(s=>s.includes(a)?s.filter(i=>i!==a):[...s,a])},V=a=>{const s={OPENAI:"bg-green-100 text-green-800",ANTHROPIC:"bg-orange-100 text-orange-800",GOOGLE:"bg-blue-100 text-blue-800",COHERE:"bg-purple-100 text-purple-800"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s[a]||"bg-gray-100 text-gray-800"}`,children:a})};return K?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-76px)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})}):e.jsx(z,{children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Conexões de IA Globais"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Adicionar e gerenciar IAs que serão atribuídas às organizações"})]}),e.jsxs(I,{open:U,onOpenChange:x,children:[e.jsx(_,{asChild:!0,children:e.jsxs(n,{children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Nova IA"]})}),e.jsxs(w,{className:"sm:max-w-[500px]",children:[e.jsxs(O,{children:[e.jsx(k,{children:"Nova Conexão de IA"}),e.jsx(D,{children:"Adicionar uma nova IA global ao sistema"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"name",children:"Nome"}),e.jsx(g,{id:"name",placeholder:"OpenAI GPT-4",value:r.name,onChange:a=>c({...r,name:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"provider",children:"Provider"}),e.jsxs(ee,{value:r.provider,onValueChange:a=>c({...r,provider:a}),children:[e.jsx(ae,{children:e.jsx(se,{})}),e.jsxs(re,{children:[e.jsx(p,{value:"OPENAI",children:"OpenAI"}),e.jsx(p,{value:"ANTHROPIC",children:"Anthropic"}),e.jsx(p,{value:"GOOGLE",children:"Google"}),e.jsx(p,{value:"COHERE",children:"Cohere"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"apiKey",children:"API Key"}),e.jsx(g,{id:"apiKey",type:"password",placeholder:"sk-...",value:r.apiKey,onChange:a=>c({...r,apiKey:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"model",children:"Modelo (opcional)"}),e.jsx(g,{id:"model",placeholder:"gpt-4-turbo",value:r.model,onChange:a=>c({...r,model:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"baseUrl",children:"Base URL (opcional)"}),e.jsx(g,{id:"baseUrl",placeholder:"https://api.openai.com/v1",value:r.baseUrl,onChange:a=>c({...r,baseUrl:a.target.value})})]})]}),e.jsxs(S,{children:[e.jsx(n,{variant:"outline",onClick:()=>x(!1),children:"Cancelar"}),e.jsx(n,{onClick:H,children:"Criar IA"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mt-6",children:[v.map(a=>e.jsxs(b,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:e.jsx(N,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{children:a.name}),a.isActive?e.jsx(y,{children:"Ativa"}):e.jsx(y,{variant:"secondary",children:"Inativa"})]}),e.jsxs(Y,{className:"mt-1 flex items-center gap-2",children:[V(a.provider),a.model&&e.jsxs("span",{className:"text-sm",children:["• ",a.model]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>q(a.id),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Atribuir"]}),e.jsx(n,{size:"sm",variant:a.isActive?"outline":"default",onClick:()=>R(a.id,a.isActive),children:a.isActive?"Desativar":"Ativar"})]})]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"API Key"}),e.jsxs("div",{className:"font-mono text-xs mt-1",children:[a.apiKey.substring(0,10),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Max Tokens"}),e.jsx("div",{className:"font-medium mt-1",children:a.maxTokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Temperature"}),e.jsx("div",{className:"font-medium mt-1",children:a.temperature})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Criada em"}),e.jsx("div",{className:"font-medium mt-1",children:new Date(a.createdAt).toLocaleDateString("pt-BR")})]})]})})]},a.id)),v.length===0&&e.jsx(b,{children:e.jsxs(C,{className:"py-12 text-center",children:[e.jsx(N,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhuma IA configurada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Adicione sua primeira conexão de IA para começar"}),e.jsxs(n,{onClick:()=>x(!0),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Adicionar IA"]})]})})]}),e.jsx(I,{open:B,onOpenChange:h,children:e.jsxs(w,{className:"sm:max-w-[500px]",children:[e.jsxs(O,{children:[e.jsx(k,{children:"Atribuir IA para Organizações"}),e.jsx(D,{children:"Selecione as organizações que terão acesso a esta IA"})]}),e.jsx("div",{className:"py-4 max-h-[400px] overflow-y-auto",children:P.map(a=>e.jsxs("div",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg cursor-pointer",onClick:()=>M(a.id),children:[e.jsx("div",{className:`w-5 h-5 border-2 rounded flex items-center justify-center ${d.includes(a.id)?"bg-blue-600 border-blue-600":"border-gray-300"}`,children:d.includes(a.id)&&e.jsx(Z,{className:"h-3 w-3 text-white"})}),e.jsx("span",{className:"font-medium",children:a.name})]},a.id))}),e.jsxs(S,{children:[e.jsx(n,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),e.jsxs(n,{onClick:$,children:["Atribuir para ",d.length," organizações"]})]})]})})]})})}export{ue as default};

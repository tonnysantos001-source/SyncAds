import{r as i,b as W,u as Y,j as e,B as x,I as g,d as f,e as v,f as N,h as C,S as Z,n as k}from"./index-pv9-bCb3.js";import{T as ee,a as se,b as I,c as d,d as te,e as c}from"./table-DsBrCG4J.js";import{D as ae,a as re,b as ie,c as le,d as oe,f as ne}from"./dialog-DOgw0Z3w.js";import{L as o}from"./label-CQc93LhS.js";import{S as E,a as S,b as A,c as B,d as m}from"./select-BLGUCMxK.js";import{T as de}from"./textarea-BwmfMBPs.js";import{m as T}from"./marketingApi-C5KmGvZc.js";import{p as ce}from"./productsApi-H6f6BK62.js";import{S as V}from"./skeleton-LbgFXE17.js";import{P as z}from"./plus-BEI-SorK.js";import{T as R}from"./trending-up-DYjMczuX.js";import{S as ue}from"./shopping-cart-CegyUn1V.js";import{D as xe}from"./dollar-sign-_ENEEL14.js";import{S as he}from"./square-pen-MxoMz57M.js";import{T as me}from"./trash-2-BYBVv0xG.js";import"./x-DbzY-YeI.js";import"./index-CuXWbZPY.js";import"./chevron-up-Cb5yFYWD.js";const ke=()=>{const[h,F]=i.useState([]),[D,H]=i.useState([]),[O,w]=i.useState([]),[L,U]=i.useState(!0),[n,q]=i.useState(""),[G,j]=i.useState(!1),[p,P]=i.useState(null),{toast:u}=W(),l=Y(s=>s.user),[t,r]=i.useState({name:"",productId:"",title:"",description:"",discountType:"PERCENTAGE",discountValue:0,position:"CHECKOUT",isActive:!0});i.useEffect(()=>{b()},[]),i.useEffect(()=>{K()},[n,h]);const b=async()=>{try{if(!(l!=null&&l.organizationId))return;const[s,a]=await Promise.all([T.orderBumps.getAll(l.organizationId),ce.list()]);F(s),H(a),w(s)}catch(s){u({title:"Erro ao carregar",description:s.message,variant:"destructive"})}finally{U(!1)}},K=()=>{if(!n){w(h);return}const s=h.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.title.toLowerCase().includes(n.toLowerCase()));w(s)},$=async s=>{s.preventDefault();try{if(!(l!=null&&l.organizationId))return;p?(await T.orderBumps.update(p.id,t),u({title:"Order Bump atualizado!"})):(await T.orderBumps.create({...t,organizationId:l.organizationId}),u({title:"Order Bump criado!",description:"A oferta está pronta para uso."})),j(!1),y(),b()}catch(a){u({title:"Erro",description:a.message,variant:"destructive"})}},M=async s=>{if(confirm("Tem certeza que deseja deletar este order bump?"))try{await T.orderBumps.delete(s),u({title:"Order Bump deletado"}),b()}catch(a){u({title:"Erro ao deletar",description:a.message,variant:"destructive"})}},X=s=>{P(s),r({name:s.name,productId:s.productId,title:s.title,description:s.description||"",discountType:s.discountType||"PERCENTAGE",discountValue:s.discountValue||0,position:s.position,isActive:s.isActive}),j(!0)},y=()=>{P(null),r({name:"",productId:"",title:"",description:"",discountType:"PERCENTAGE",discountValue:0,position:"CHECKOUT",isActive:!0})},_=h.filter(s=>s.isActive).length,J=s=>{const a=D.find(Q=>Q.id===s);return(a==null?void 0:a.name)||"Produto não encontrado"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Order Bump"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Ofertas especiais exibidas durante o checkout"})]}),e.jsxs(ae,{open:G,onOpenChange:j,children:[e.jsx(re,{asChild:!0,children:e.jsxs(x,{onClick:y,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Criar Order Bump"]})}),e.jsxs(ie,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(oe,{children:p?"Editar Order Bump":"Novo Order Bump"})}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Nome Interno *"}),e.jsx(g,{value:t.name,onChange:s=>r({...t,name:s.target.value}),placeholder:"Ex: Acessório Premium",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Produto *"}),e.jsxs(E,{value:t.productId,onValueChange:s=>r({...t,productId:s}),required:!0,children:[e.jsx(S,{children:e.jsx(A,{placeholder:"Selecione o produto"})}),e.jsx(B,{children:D.map(s=>e.jsxs(m,{value:s.id,children:[s.name," - R$ ",s.price.toFixed(2)]},s.id))})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Título da Oferta *"}),e.jsx(g,{value:t.title,onChange:s=>r({...t,title:s.target.value}),placeholder:"Ex: Adicione Proteção Estendida",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Descrição"}),e.jsx(de,{value:t.description,onChange:s=>r({...t,description:s.target.value}),placeholder:"Descreva a oferta...",rows:3})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Tipo de Desconto"}),e.jsxs(E,{value:t.discountType,onValueChange:s=>r({...t,discountType:s}),children:[e.jsx(S,{children:e.jsx(A,{})}),e.jsxs(B,{children:[e.jsx(m,{value:"PERCENTAGE",children:"Porcentagem"}),e.jsx(m,{value:"FIXED_AMOUNT",children:"Valor Fixo"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Valor do Desconto"}),e.jsx(g,{type:"number",step:"0.01",value:t.discountValue,onChange:s=>r({...t,discountValue:parseFloat(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Posição *"}),e.jsxs(E,{value:t.position,onValueChange:s=>r({...t,position:s}),children:[e.jsx(S,{children:e.jsx(A,{})}),e.jsxs(B,{children:[e.jsx(m,{value:"CHECKOUT",children:"Checkout"}),e.jsx(m,{value:"CART",children:"Carrinho"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.isActive,onChange:s=>r({...t,isActive:s.target.checked}),className:"rounded"}),e.jsx(o,{children:"Ativo"})]})]}),e.jsxs(ne,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(x,{type:"submit",children:p?"Atualizar":"Criar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(f,{className:"border-0 bg-white/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Total de Order Bumps"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.length})})]}),e.jsxs(f,{className:"border-0 bg-white/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Ativos"}),e.jsx(ue,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:_})})]}),e.jsxs(f,{className:"border-0 bg-white/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Taxa Conversão"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:"-"})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(g,{placeholder:"Buscar order bumps...",value:n,onChange:s=>q(s.target.value),className:"pl-9"})]}),e.jsxs(f,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsx(v,{children:e.jsx(N,{children:"Lista de Order Bumps"})}),e.jsx(C,{children:L?e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"h-12 w-full"}),e.jsx(V,{className:"h-12 w-full"})]}):O.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(R,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhum order bump encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n?"Tente ajustar sua busca":"Comece criando seu primeiro order bump"}),!n&&e.jsxs(x,{onClick:y,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Criar Primeiro Order Bump"]})]}):e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(I,{children:[e.jsx(d,{children:"Nome"}),e.jsx(d,{children:"Produto"}),e.jsx(d,{children:"Título"}),e.jsx(d,{children:"Desconto"}),e.jsx(d,{children:"Posição"}),e.jsx(d,{children:"Status"}),e.jsx(d,{className:"text-right",children:"Ações"})]})}),e.jsx(te,{children:O.map(s=>e.jsxs(I,{children:[e.jsx(c,{className:"font-medium",children:s.name}),e.jsx(c,{children:J(s.productId)}),e.jsx(c,{children:s.title}),e.jsx(c,{children:s.discountValue?s.discountType==="PERCENTAGE"?`${s.discountValue}%`:`R$ ${s.discountValue.toFixed(2)}`:"-"}),e.jsx(c,{children:e.jsx(k,{variant:"outline",children:s.position==="CHECKOUT"?"Checkout":"Carrinho"})}),e.jsx(c,{children:e.jsx(k,{variant:s.isActive?"default":"secondary",children:s.isActive?"Ativo":"Inativo"})}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>X(s),children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>M(s.id),children:e.jsx(me,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})};export{ke as default};

import{r,f as B,j as e,g as c,h as d,i as o,U as h,l as x,Q as E,I,o as P}from"./index-DJMbRzNM.js";import{T as R,a as O,b as p,c as n,d as M,e as i}from"./table-D5Xs8O9Y.js";import{c as V}from"./customersApi-D5LRFFKt.js";import{S as N}from"./skeleton-Bi_c9jEE.js";import{S as D}from"./shopping-bag-CtEglxP1.js";import{D as F}from"./dollar-sign-CI1M5_JA.js";import{M as H}from"./mail-Df-AMyRh.js";import{P as k}from"./phone-fGgUSW0D.js";import{f as U,p as q}from"./pt-BR-COO1Bk_c.js";const _=()=>{const[t,g]=r.useState([]),[j,m]=r.useState([]),[C,w]=r.useState(!0),[l,y]=r.useState(""),{toast:b}=B();r.useEffect(()=>{v()},[]),r.useEffect(()=>{T()},[l,t]);const v=async()=>{try{const s=await V.list();g(s),m(s)}catch(s){b({title:"Erro ao carregar clientes",description:s.message,variant:"destructive"})}finally{w(!1)}},T=()=>{if(!l){m(t);return}const s=t.filter(a=>{var u;return a.name.toLowerCase().includes(l.toLowerCase())||a.email.toLowerCase().includes(l.toLowerCase())||((u=a.cpf)==null?void 0:u.toLowerCase().includes(l.toLowerCase()))});m(s)},f=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),S=t.reduce((s,a)=>s+a.totalSpent,0),A=t.reduce((s,a)=>s+a.totalOrders,0),L=t.filter(s=>s.status==="ACTIVE").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Clientes"}),e.jsx("p",{className:"text-muted-foreground",children:"Visualize e gerencie todos os clientes da sua loja"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total de Clientes"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.length})})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Clientes Ativos"}),e.jsx(h,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold",children:L})})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total de Pedidos"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold",children:A})})]}),e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Receita Total"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold",children:f(S)})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(I,{placeholder:"Buscar por nome, email ou CPF...",value:l,onChange:s=>y(s.target.value),className:"pl-9"})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(o,{children:"Lista de Clientes"})}),e.jsx(x,{children:C?e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"h-12 w-full"}),e.jsx(N,{className:"h-12 w-full"})]}):j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(h,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhum cliente encontrado"})]}):e.jsxs(R,{children:[e.jsx(O,{children:e.jsxs(p,{children:[e.jsx(n,{children:"Cliente"}),e.jsx(n,{children:"Contato"}),e.jsx(n,{children:"Pedidos"}),e.jsx(n,{children:"Total Gasto"}),e.jsx(n,{children:"Ãšltima Compra"}),e.jsx(n,{children:"Status"})]})}),e.jsx(M,{children:j.map(s=>e.jsxs(p,{children:[e.jsx(i,{children:e.jsx("div",{className:"font-medium",children:s.name})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(H,{className:"h-3 w-3"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(k,{className:"h-3 w-3"}),s.phone]})]})}),e.jsx(i,{children:s.totalOrders}),e.jsx(i,{children:f(s.totalSpent)}),e.jsx(i,{children:s.lastOrderAt?U(new Date(s.lastOrderAt),"dd/MM/yyyy",{locale:q}):"-"}),e.jsx(i,{children:e.jsx(P,{variant:s.status==="ACTIVE"?"default":"secondary",children:s.status==="ACTIVE"?"Ativo":"Bloqueado"})})]},s.id))})]})})]})]})};export{_ as default};

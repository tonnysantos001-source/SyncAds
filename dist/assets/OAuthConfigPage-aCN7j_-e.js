import{j as e}from"./vendor-ui-D3JNL6pE.js";import{r as a}from"./vendor-react-X41Bjl18.js";import{g as s,s as t,Q as r,P as i,C as l,c as o,aa as n,a as c,b as d,e as m,S as p,ab as x,d as h,ac as g,I as f,ad as u,V as j,B as b,ae as v}from"./index-D-ADUcR6.js";import{L as N}from"./label-5B6OAN88.js";import{S as y}from"./SuperAdminLayout-CXCtxRph.js";import{m as w}from"./vendor-animation-DtB50Lbk.js";import"./vendor-supabase-HUq0BeMy.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-query-DqG_mm-v.js";import"./vendor-icons-BvRy6l6m.js";function k(){const{toast:k}=s(),[A,S]=a.useState(!1),[C,I]=a.useState(null),[_,D]=a.useState({}),[F,O]=a.useState([{platform:"META",platformName:"Meta / Facebook Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üìò",scopes:["ads_management","ads_read","pages_read_engagement","pages_manage_ads"],docsUrl:"https://developers.facebook.com/docs/facebook-login/guides/advanced/manual-flow"},{platform:"GOOGLE",platformName:"Google Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üîç",scopes:["https://www.googleapis.com/auth/adwords","https://www.googleapis.com/auth/userinfo.email"],docsUrl:"https://developers.google.com/identity/protocols/oauth2"},{platform:"LINKEDIN",platformName:"LinkedIn Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üíº",scopes:["r_ads","r_ads_reporting","rw_ads"],docsUrl:"https://learn.microsoft.com/en-us/linkedin/shared/authentication/authentication"},{platform:"TIKTOK",platformName:"TikTok For Business",clientId:"",clientSecret:"",isActive:!1,icon:"üéµ",scopes:["user.info.basic","video.list","video.upload"],docsUrl:"https://developers.tiktok.com/doc/login-kit-web"}]);a.useEffect(()=>{$()},[]);const $=async()=>{try{S(!0);const{data:e,error:a}=await t.from("OAuthConfig").select("*").order("platform");if(a)throw a;e&&e.length>0&&O(a=>a.map(a=>{const s=e.find(e=>e.platform===a.platform);return s?{...a,clientId:s.clientId||"",clientSecret:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",isActive:s.isActive||!1}:a}))}catch(e){k({title:"Erro ao carregar configura√ß√µes",description:e.message,variant:"destructive"})}finally{S(!1)}},E=(e,a,s)=>{O(t=>t.map(t=>t.platform===e?{...t,[a]:s}:t))};return A?e.jsx(y,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(r,{className:"h-8 w-8 animate-spin text-blue-600"})})}):e.jsx(y,{children:e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 shadow-lg",children:e.jsx(i,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Configura√ß√µes OAuth 2.0"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure as credenciais das plataformas para integra√ß√£o via chat"})]})]})}),e.jsx(w.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:e.jsx(l,{className:"mb-6 border-0 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 backdrop-blur-sm",children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(n,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-lg",children:"Como funciona?"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Cadastre as credenciais OAuth aqui"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:'Marque como "Ativa" quando estiver aprovado pela plataforma'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:'Usu√°rios podem pedir no chat: "Conecte com Facebook"'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"A IA mostra card interativo para autoriza√ß√£o"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Tokens s√£o salvos criptografados"})]})]})]})]})})})}),e.jsx("div",{className:"grid gap-6",children:F.map((a,s)=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s+.2},children:e.jsxs(l,{className:"border-0 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-5xl p-3 rounded-xl bg-gray-800/50 shadow-md",children:a.icon}),e.jsxs("div",{children:[e.jsxs(d,{className:"flex items-center gap-2 text-xl",children:[a.platformName,a.isActive?e.jsxs(m,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white border-0",children:[e.jsx(p,{className:"h-3 w-3 mr-1"}),"Ativo"]}):e.jsxs(m,{variant:"secondary",className:"bg-gray-200 dark:bg-gray-700",children:[e.jsx(x,{className:"h-3 w-3 mr-1"}),"Inativo"]})]}),e.jsxs(h,{className:"mt-2",children:[e.jsx("span",{className:"font-medium",children:"Scopes:"})," ",a.scopes.slice(0,2).join(", "),a.scopes.length>2&&` +${a.scopes.length-2} mais`]})]})]}),e.jsxs("a",{href:a.docsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-800 flex items-center gap-2 transition-colors px-4 py-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-950/20",children:["Documenta√ß√£o",e.jsx(g,{className:"h-4 w-4"})]})]})}),e.jsxs(o,{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:`${a.platform}-client-id`,className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Client ID *"}),e.jsx(f,{id:`${a.platform}-client-id`,placeholder:"Digite o Client ID da plataforma",value:a.clientId,onChange:e=>E(a.platform,"clientId",e.target.value),className:"mt-2 font-mono text-sm bg-gray-800/50 border-gray-700"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:`${a.platform}-client-secret`,className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Client Secret *"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(f,{id:`${a.platform}-client-secret`,type:_[a.platform]?"text":"password",placeholder:"Digite o Client Secret",value:a.clientSecret,onChange:e=>E(a.platform,"clientSecret",e.target.value),className:"pr-12 font-mono text-sm bg-gray-800/50 border-gray-700"}),e.jsx("button",{type:"button",onClick:()=>{return e=a.platform,void D(a=>({...a,[e]:!a[e]}));var e},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:_[a.platform]?e.jsx(u,{className:"h-5 w-5"}):e.jsx(j,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-800/50 border border-gray-700/50",children:[e.jsx("input",{type:"checkbox",id:`${a.platform}-active`,checked:a.isActive,onChange:e=>E(a.platform,"isActive",e.target.checked),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"}),e.jsx(N,{htmlFor:`${a.platform}-active`,className:"cursor-pointer font-medium",children:"Ativar integra√ß√£o (usu√°rios poder√£o conectar)"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(b,{onClick:()=>(async e=>{try{I(e);const a=F.find(a=>a.platform===e);if(!a)return;if(!a.clientId||!a.clientSecret)return k({title:"Campos obrigat√≥rios",description:"Client ID e Client Secret s√£o obrigat√≥rios.",variant:"destructive"}),void I(null);const s={platform:a.platform,clientId:a.clientId,isActive:a.isActive,scopes:a.scopes,updatedAt:(new Date).toISOString()};"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"!==a.clientSecret&&(s.clientSecret=a.clientSecret);const{error:r}=await t.from("OAuthConfig").upsert(s,{onConflict:"platform"});if(r)throw r;k({title:"‚úÖ Configura√ß√£o salva",description:`${a.platformName} configurado com sucesso!`}),await $()}catch(a){k({title:"Erro ao salvar",description:a.message,variant:"destructive"})}finally{I(null)}})(a.platform),disabled:C===a.platform,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 h-12 text-base font-semibold",children:C===a.platform?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-5 w-5 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2 h-5 w-5"}),"Salvar Configura√ß√£o"]})})})]})]})},a.platform))}),e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsx(l,{className:"mt-8 border-0 bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 backdrop-blur-sm",children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:e.jsx(i,{className:"h-6 w-6 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-lg",children:"üìå Importante"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"As credenciais s√£o criptografadas antes de salvar no banco"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Nunca s√£o expostas no frontend dos usu√°rios"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:'Quando "Ativa", a integra√ß√£o fica dispon√≠vel para todos usu√°rios'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Desative temporariamente se houver problemas de aprova√ß√£o"})]})]})]})]})})})})]})})}export{k as default};

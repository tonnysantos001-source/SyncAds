import{j as e}from"./vendor-ui-DkUuACDy.js";import{r as a}from"./vendor-react-X41Bjl18.js";import{g as s,f as r,s as t,B as i,I as l,C as o,a as d,b as n,c,e as m}from"./index-B_qkehep.js";import{T as x,a as g,b as h,c as u,d as p,e as b}from"./table-RlT68fCX.js";import{D as j,e as y,a as v,b as f,c as N,f as w}from"./dialog-DL8wXion.js";import{L as k}from"./label-Cp9V-6fq.js";import{T as C}from"./textarea-C6fkEhzF.js";import{S as E}from"./skeleton-CfoUoo_m.js";import{m as S}from"./vendor-animation-DQ3cvw6m.js";import{aJ as A,aB as P,aO as R,h as T,E as I,Z as D,w as O,S as U,Q as V,Y as _,N as q}from"./vendor-icons-DTdRnryx.js";import"./vendor-supabase-BQxDPPjR.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-query-Bf3pI66S.js";const z=({title:a,value:s,icon:r,color:t,delay:i=0,subtitle:l})=>e.jsx(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:i},children:e.jsxs(o,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${t} opacity-10 rounded-full blur-3xl`}),e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a}),e.jsx("div",{className:`p-2 rounded-lg ${t} bg-opacity-10`,children:e.jsx(r,{className:`h-5 w-5 ${t.replace("bg-","text-")}`})})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:s}),l&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l})]})]})}),H=()=>{const[H,L]=a.useState([]),[W,B]=a.useState([]),[M,$]=a.useState(!0),[J,Q]=a.useState(""),[Y,Z]=a.useState(!1),[F,G]=a.useState(null),{toast:K}=s(),X=r(e=>e.user),[ee,ae]=a.useState({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0});a.useEffect(()=>{se()},[]),a.useEffect(()=>{re()},[J,H]);const se=async()=>{try{if(!X?.id)return;const{data:e,error:a}=await t.from("SocialProof").select("*").eq("userId",X.id).order("createdAt",{ascending:!1});if(a)throw a;L(e||[]),B(e||[])}catch(e){K({title:"Erro ao carregar",description:e.message,variant:"destructive"})}finally{$(!1)}},re=()=>{if(!J)return void B(H);const e=H.filter(e=>e.message.toLowerCase().includes(J.toLowerCase()));B(e)},te=()=>{G(null),ae({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0})},ie=H.filter(e=>e.isActive).length,le=a=>{switch(a){case"RECENT_PURCHASE":return e.jsx(O,{className:"h-4 w-4"});case"VISITOR_COUNT":return e.jsx(q,{className:"h-4 w-4"});case"REVIEW":return e.jsx(P,{className:"h-4 w-4"});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-orange-600 via-red-600 to-pink-600 bg-clip-text text-transparent",children:"Prova Social"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium mt-2",children:"Notificações em tempo real para aumentar confiança e conversões"})]}),e.jsxs(j,{open:Y,onOpenChange:Z,children:[e.jsx(y,{asChild:!0,children:e.jsxs(i,{onClick:te,size:"lg",className:"shadow-lg hover:shadow-xl transition-all",children:[e.jsx(A,{className:"mr-2 h-5 w-5"}),"Criar Prova Social"]})}),e.jsxs(v,{className:"max-w-lg bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border-none shadow-2xl",children:[e.jsx(f,{children:e.jsxs(N,{className:"flex items-center gap-2 text-xl",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 shadow-md",children:e.jsx(P,{className:"h-5 w-5 text-white"})}),F?"Editar Prova Social":"Nova Prova Social"]})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{if(!X?.id)return;if(F){const{error:e}=await t.from("SocialProof").update({...ee,updatedAt:(new Date).toISOString()}).eq("id",F.id);if(e)throw e;K({title:"Prova social atualizada!"})}else{const{error:e}=await t.from("SocialProof").insert({...ee,userId:X.id});if(e)throw e;K({title:"Prova social criada!",description:"A notificação está pronta para exibição."})}Z(!1),te(),se()}catch(a){K({title:"Erro",description:a.message,variant:"destructive"})}},className:"space-y-5 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-gradient-to-br from-purple-500 to-pink-600",children:e.jsx(R,{className:"h-3 w-3 text-white"})}),"Tipo *"]}),e.jsxs("select",{className:"w-full p-2.5 border border-gray-300 dark:border-gray-700 rounded-lg bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm focus:ring-2 focus:ring-purple-500/50 transition-all",value:ee.type,onChange:e=>ae({...ee,type:e.target.value}),required:!0,children:[e.jsx("option",{value:"RECENT_PURCHASE",children:"Compra Recente"}),e.jsx("option",{value:"VISITOR_COUNT",children:"Contador de Visitantes"}),e.jsx("option",{value:"REVIEW",children:"Avaliação"})]}),e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 border border-blue-200/50 dark:border-blue-800/50",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"RECENT_PURCHASE"===ee.type&&'Ex: "João acabou de comprar há 5 minutos"',"VISITOR_COUNT"===ee.type&&'Ex: "23 pessoas estão visualizando este produto"',"REVIEW"===ee.type&&'Ex: "★★★★★ Produto excelente! - Maria S."']})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-gradient-to-br from-blue-500 to-cyan-600",children:e.jsx(P,{className:"h-3 w-3 text-white"})}),"Mensagem *"]}),e.jsx(C,{value:ee.message,onChange:e=>ae({...ee,message:e.target.value}),placeholder:"Digite a mensagem que será exibida...",rows:3,className:"bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-blue-500/50 transition-all resize-none",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-gradient-to-br from-green-500 to-emerald-600",children:e.jsx(I,{className:"h-3 w-3 text-white"})}),"Duração de Exibição (segundos)"]}),e.jsx(l,{type:"number",min:"1",max:"30",value:ee.displayDuration,onChange:e=>ae({...ee,displayDuration:parseInt(e.target.value)}),className:"bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-green-500/50 transition-all",required:!0})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-800/50 border border-gray-200/50 dark:border-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:ee.isActive,onChange:e=>ae({...ee,isActive:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500 focus:ring-2"}),e.jsxs(k,{className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-purple-600"}),"Ativo"]})]}),e.jsxs(w,{className:"gap-2",children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>Z(!1),className:"hover:bg-gray-100 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsxs(i,{type:"submit",className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white border-none shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),F?"Atualizar":"Criar"]})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsx(z,{title:"Total de Provas",value:H.length,icon:T,color:"bg-orange-500",delay:.1,subtitle:"Notificações criadas"}),e.jsx(z,{title:"Provas Ativas",value:ie,icon:D,color:"bg-green-500",delay:.2,subtitle:"Exibindo no checkout"}),e.jsx(z,{title:"Impacto",value:"Alto",icon:R,color:"bg-red-500",delay:.3,subtitle:"Aumenta confiança"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",style:{display:"none"},children:[e.jsxs(o,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Total"}),e.jsx(P,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:H.length})})]}),e.jsxs(o,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Ativas"}),e.jsx(O,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:ie})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-600 dark:text-gray-400"}),e.jsx(l,{placeholder:"Buscar provas sociais...",value:J,onChange:e=>Q(e.target.value),className:"pl-9 border-gray-200 dark:border-gray-600 bg-white/80 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500 backdrop-blur-sm"})]}),e.jsx(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:e.jsxs(o,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(d,{children:e.jsx(n,{className:"text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Lista de Provas Sociais"})}),e.jsx(c,{children:M?e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"h-12 w-full"}),e.jsx(E,{className:"h-12 w-full"})]}):0===W.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"p-4 rounded-full bg-gradient-to-br from-orange-500 to-pink-500 mb-4",children:e.jsx(P,{className:"h-12 w-12 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhuma prova social encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-md",children:J?"Tente ajustar sua busca":"Comece criando provas sociais para aumentar a confiança dos seus clientes"}),!J&&e.jsxs(i,{onClick:()=>{te(),Z(!0)},size:"lg",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Criar Primeira Prova Social"]})]}):e.jsx("div",{className:"rounded-md border border-gray-200 dark:border-gray-800",children:e.jsxs(x,{children:[e.jsx(g,{children:e.jsxs(h,{className:"hover:bg-transparent",children:[e.jsx(u,{children:"Tipo"}),e.jsx(u,{children:"Mensagem"}),e.jsx(u,{children:"Duração"}),e.jsx(u,{children:"Status"}),e.jsx(u,{className:"text-right",children:"Ações"})]})}),e.jsx(p,{children:W.map((a,s)=>{return e.jsxs(S.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.05*s},className:"hover:bg-gray-50/50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[le(a.type),e.jsx("span",{className:"text-sm",children:(r=a.type,{RECENT_PURCHASE:"Compra Recente",VISITOR_COUNT:"Contador de Visitantes",REVIEW:"Avaliação"}[r]||r)})]})}),e.jsx(b,{className:"max-w-md truncate",children:a.message}),e.jsxs(b,{children:[a.displayDuration,"s"]}),e.jsx(b,{children:e.jsx(m,{variant:a.isActive?"default":"secondary",className:a.isActive?"bg-green-500 hover:bg-green-600":"",children:a.isActive?"Ativa":"Inativa"})}),e.jsx(b,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>(e=>{G(e),ae({type:e.type,message:e.message,displayDuration:e.displayDuration,isActive:e.isActive}),Z(!0)})(a),className:"hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-950",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>(async e=>{if(confirm("Tem certeza que deseja deletar esta prova social?"))try{const{error:a}=await t.from("SocialProof").delete().eq("id",e);if(a)throw a;K({title:"Prova social deletada"}),se()}catch(a){K({title:"Erro ao deletar",description:a.message,variant:"destructive"})}})(a.id),className:"hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-950",children:e.jsx(_,{className:"h-4 w-4"})})]})})]},a.id);var r})})]})})})]})})]})};export{H as default};

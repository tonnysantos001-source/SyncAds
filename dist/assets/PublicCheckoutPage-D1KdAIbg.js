import{m as H,e as U,f as J,r as d,j as e,N as A,g as j,l as v,B as b,Y as K,C as R,R as Q,d as W,h as y,i as N,I as m,s as Y}from"./index-DIXBgi_C.js";import{L as i}from"./label-2tzj-W9E.js";import{S as $}from"./separator-_DZKVIGQ.js";import{c as G,D as Z,a as ee,g as se,S as ae}from"./defaultCheckoutTheme-BhDeuDYz.js";import{C as te}from"./circle-alert-D1HzNg8o.js";import{L as oe}from"./lock-MoDC_Ok1.js";import{T as re}from"./truck-DwdLH4I-.js";import{F as le}from"./file-text--RIyICXk.js";const je=()=>{const{orderId:u}=H(),F=U(),{toast:g}=J(),[r,L]=d.useState(null),[C,E]=d.useState(null),[z,P]=d.useState(!0),[B,S]=d.useState(!1),[o,D]=d.useState(1),[ne,ie]=d.useState(!1),[x,f]=d.useState({name:"",email:"",phone:"",document:""}),[l,h]=d.useState({street:"",number:"",complement:"",neighborhood:"",city:"",state:"",zipCode:""}),[p,w]=d.useState("PIX"),[I,O]=d.useState(1);d.useEffect(()=>{u&&M()},[u]);const M=async()=>{try{P(!0);const s=localStorage.getItem("syncads_cart");let t;if(s&&s!=="[]")try{const n=JSON.parse(s);if(n&&n.length>0){const k=n.reduce((c,T)=>c+T.price*T.quantity,0);t={orderId:u,products:n.map(c=>({id:c.productId||c.variantId||c.id,name:c.name||c.title,price:c.price,quantity:c.quantity,image:c.image||"",sku:c.sku||""})),total:k,subtotal:k,tax:0,shipping:0,discount:0},console.log("âœ… Produtos REAIS do carrinho carregados:",t),console.log("ðŸ“¦ Total de itens:",n.length),console.log("ðŸ’° Valor total:",k)}else console.log("âš ï¸ Carrinho vazio - usando produto exemplo para testes"),t={orderId:u,products:[{id:"demo-1",name:"Produto de DemonstraÃ§Ã£o",price:99.9,quantity:1,image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400",sku:"DEMO-001"}],total:99.9,subtotal:99.9,tax:0,shipping:0,discount:0}}catch{console.log("âš ï¸ Erro ao carregar carrinho - usando produto exemplo"),t={orderId:u,products:[{id:"demo-1",name:"Produto de DemonstraÃ§Ã£o",price:99.9,quantity:1,image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400",sku:"DEMO-001"}],total:99.9,subtotal:99.9,tax:0,shipping:0,discount:0}}else console.log("âš ï¸ Nenhum carrinho encontrado - usando produto exemplo para testes"),t={orderId:u,products:[{id:"demo-1",name:"Produto de DemonstraÃ§Ã£o",price:99.9,quantity:1,image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400",sku:"DEMO-001"}],total:99.9,subtotal:99.9,tax:0,shipping:0,discount:0};L(t);try{const n=await G.loadCustomization("default-org-id");E(n)}catch{console.log("Usando tema padrÃ£o profissional"),E({theme:Z})}}catch(s){console.error("Erro ao carregar dados do checkout:",s),g({title:"Erro ao carregar checkout",description:"NÃ£o foi possÃ­vel carregar os dados do pedido",variant:"destructive"})}finally{P(!1)}},q=()=>{if(o===1&&(!x.name||!x.email||!x.phone)){g({title:"Dados incompletos",description:"Preencha todos os campos obrigatÃ³rios",variant:"destructive"});return}if(o===2&&(!l.street||!l.number||!l.neighborhood||!l.city||!l.state||!l.zipCode)){g({title:"EndereÃ§o incompleto",description:"Preencha todos os campos do endereÃ§o",variant:"destructive"});return}D(s=>s+1)},V=()=>{D(s=>s-1)},_=async()=>{if(r){S(!0);try{const s={orderId:r.orderId,gatewayId:"default-gateway",paymentMethod:p,amount:r.total,currency:"BRL",customerData:x,billingAddress:l,installments:I,metadata:{source:"public-checkout",products:r.products}},{data:t,error:n}=await Y.functions.invoke("process-payment",{body:s});if(n)throw new Error(n.message);if(t.success)g({title:"Pagamento processado!",description:"Seu pagamento foi processado com sucesso",variant:"default"}),F(`/checkout/success/${t.data.transactionId}`);else throw new Error(t.message)}catch(s){console.error("Erro no pagamento:",s),g({title:"Erro no pagamento",description:s.message||"Tente novamente",variant:"destructive"})}finally{S(!1)}}};if(z)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"h-16 w-16 animate-spin mx-auto mb-4 text-purple-600"}),e.jsx("div",{className:"absolute inset-0 blur-xl bg-purple-400 opacity-20 animate-pulse"})]}),e.jsx("p",{className:"text-gray-700 font-semibold text-lg",children:"Carregando checkout seguro..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Aguarde um momento"})]})});if(!r)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-orange-50 flex items-center justify-center p-4",children:e.jsx(j,{className:"w-full max-w-md shadow-2xl border-0",children:e.jsxs(v,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-red-100 to-red-200 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(te,{className:"h-10 w-10 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2 text-gray-900",children:"Pedido nÃ£o encontrado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"O pedido solicitado nÃ£o foi encontrado ou expirou."}),e.jsx(b,{onClick:()=>F("/"),className:"w-full h-12 text-base font-semibold",children:"Voltar ao inÃ­cio"})]})})});const a=ee(C==null?void 0:C.theme),X=se(a);return e.jsxs("div",{className:"min-h-screen transition-colors duration-300",style:{backgroundColor:a.backgroundColor,fontFamily:a.fontFamily,...X},children:[a.noticeBarEnabled&&a.noticeBarMessage&&e.jsx("div",{className:"w-full py-3 px-4 text-center text-sm font-medium",style:{backgroundColor:a.noticeBarBackgroundColor,color:a.noticeBarTextColor,animation:a.noticeBarAnimation?"pulse 2s infinite":"none"},children:a.noticeBarMessage}),e.jsx("div",{className:"bg-white/95 backdrop-blur-lg border-b border-gray-200 shadow-sm sticky top-0 z-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center shadow-lg",style:{background:`linear-gradient(135deg, ${a.primaryButtonBackgroundColor} 0%, ${a.checkoutButtonBackgroundColor} 100%)`},children:e.jsx(oe,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold tracking-tight",style:{color:a.headingColor},children:"Checkout Seguro"}),a.showTrustBadges&&e.jsx("p",{className:"text-xs hidden sm:block",style:{color:a.footerTextColor},children:"Seus dados estÃ£o protegidos ðŸ”’"})]})]}),e.jsx("div",{className:"hidden lg:flex items-center gap-3",children:[{num:1,label:"Dados",icon:K},{num:2,label:"Entrega",icon:re},{num:3,label:"Pagamento",icon:R}].map((s,t)=>e.jsxs(Q.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-sm font-bold transition-all duration-500 ${o>s.num?"shadow-lg scale-110":o===s.num?"shadow-lg scale-110 animate-bounce":""}`,style:{backgroundColor:o>s.num?a.stepCompletedColor:o===s.num?a.stepActiveColor:a.stepInactiveColor,color:o>=s.num?"#FFFFFF":"#9CA3AF"},children:[o>s.num?e.jsx(W,{className:"h-6 w-6"}):e.jsx(s.icon,{className:"h-6 w-6"}),o===s.num&&e.jsx("div",{className:"absolute inset-0 rounded-xl opacity-50 animate-ping",style:{backgroundColor:a.stepActiveColor}})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",style:{color:o>=s.num?a.stepActiveColor:a.stepInactiveColor},children:["Etapa ",s.num]}),e.jsx("p",{className:"text-sm font-bold",style:{color:o>=s.num?a.headingColor:a.stepInactiveColor},children:s.label})]})]}),t<2&&a.showProgressBar&&e.jsx("div",{className:"relative w-16 h-1 rounded-full overflow-hidden",style:{backgroundColor:a.stepInactiveColor},children:e.jsx("div",{className:"absolute top-0 left-0 h-full transition-all duration-700",style:{width:o>s.num?"100%":"0%",backgroundColor:a.progressBarColor}})})]},s.num))}),e.jsx("div",{className:"lg:hidden",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-bold",style:{color:a.primaryButtonBackgroundColor},children:["Etapa ",o," de ",a.navigationSteps]}),e.jsx("p",{className:"text-xs",style:{color:a.footerTextColor},children:o===1?"Dados":o===2?"Entrega":"Pagamento"})]})})]}),a.showProgressBar&&e.jsx("div",{className:"mt-4 lg:hidden",children:e.jsx("div",{className:"w-full h-2 rounded-full overflow-hidden",style:{backgroundColor:a.stepInactiveColor},children:e.jsx("div",{className:"h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${o/a.navigationSteps*100}%`,backgroundColor:a.progressBarColor}})})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${o>=1?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"}`,children:"1"}),e.jsx("span",{className:"text-sm",children:"Dados"})]}),e.jsx("div",{className:"w-8 h-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${o>=2?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"}`,children:"2"}),e.jsx("span",{className:"text-sm",children:"EndereÃ§o"})]}),e.jsx("div",{className:"w-8 h-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${o>=3?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"}`,children:"3"}),e.jsx("span",{className:"text-sm",children:"Pagamento"})]})]})})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[o===1&&e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(N,{children:"InformaÃ§Ãµes Pessoais"})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Nome completo *"}),e.jsx(m,{id:"name",value:x.name,onChange:s=>f(t=>({...t,name:s.target.value})),placeholder:"Seu nome completo"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"email",children:"E-mail *"}),e.jsx(m,{id:"email",type:"email",value:x.email,onChange:s=>f(t=>({...t,email:s.target.value})),placeholder:"seu@email.com"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"phone",children:"Telefone/WhatsApp *"}),e.jsx(m,{id:"phone",value:x.phone,onChange:s=>f(t=>({...t,phone:s.target.value})),placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"document",children:"CPF"}),e.jsx(m,{id:"document",value:x.document,onChange:s=>f(t=>({...t,document:s.target.value})),placeholder:"000.000.000-00"})]})]})]}),o===2&&e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(N,{children:"EndereÃ§o de Entrega"})}),e.jsx(v,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{htmlFor:"street",children:"Rua/Avenida *"}),e.jsx(m,{id:"street",value:l.street,onChange:s=>h(t=>({...t,street:s.target.value})),placeholder:"Nome da rua"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"number",children:"NÃºmero *"}),e.jsx(m,{id:"number",value:l.number,onChange:s=>h(t=>({...t,number:s.target.value})),placeholder:"123"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"complement",children:"Complemento"}),e.jsx(m,{id:"complement",value:l.complement,onChange:s=>h(t=>({...t,complement:s.target.value})),placeholder:"Apto 45"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"neighborhood",children:"Bairro *"}),e.jsx(m,{id:"neighborhood",value:l.neighborhood,onChange:s=>h(t=>({...t,neighborhood:s.target.value})),placeholder:"Centro"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"city",children:"Cidade *"}),e.jsx(m,{id:"city",value:l.city,onChange:s=>h(t=>({...t,city:s.target.value})),placeholder:"SÃ£o Paulo"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"state",children:"Estado *"}),e.jsx(m,{id:"state",value:l.state,onChange:s=>h(t=>({...t,state:s.target.value})),placeholder:"SP",maxLength:2})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"zipCode",children:"CEP *"}),e.jsx(m,{id:"zipCode",value:l.zipCode,onChange:s=>h(t=>({...t,zipCode:s.target.value})),placeholder:"00000-000"})]})]})})]}),o===3&&e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(N,{children:"Forma de Pagamento"})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${p==="PIX"?"border-blue-500 bg-blue-50":"border-gray-300"}`,onClick:()=>w("PIX"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"PIX"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pagamento instantÃ¢neo"})]})]})}),e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${p==="CREDIT_CARD"?"border-blue-500 bg-blue-50":"border-gray-300"}`,onClick:()=>w("CREDIT_CARD"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"CartÃ£o de CrÃ©dito"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Visa, Mastercard, Elo"})]})]})}),e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${p==="BOLETO"?"border-blue-500 bg-blue-50":"border-gray-300"}`,onClick:()=>w("BOLETO"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(le,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Boleto BancÃ¡rio"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pagamento em atÃ© 3 dias Ãºteis"})]})]})})]}),p==="CREDIT_CARD"&&e.jsxs("div",{children:[e.jsx(i,{htmlFor:"installments",children:"Parcelas"}),e.jsx("select",{id:"installments",value:I,onChange:s=>O(Number(s.target.value)),className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(s=>e.jsxs("option",{value:s,children:[s,"x de R$ ",(r.total/s).toFixed(2)]},s))})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[o>1&&e.jsx(b,{variant:"outline",onClick:V,children:"Voltar"}),e.jsx("div",{className:"ml-auto",children:o<3?e.jsx(b,{onClick:q,style:{backgroundColor:a.primaryButtonBackgroundColor||"#FF0080",color:a.primaryButtonTextColor||"#FFFFFF"},children:"Continuar"}):e.jsx(b,{onClick:_,disabled:B,style:{backgroundColor:a.checkoutButtonBackgroundColor||"#0FBA00",color:"#FFFFFF"},children:B?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 animate-spin mr-2"}),"Processando..."]}):"Finalizar Compra"})})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(j,{className:"sticky top-4",children:[e.jsx(y,{children:e.jsx(N,{children:"Resumo do Pedido"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[r.products.map(s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover rounded-lg"}):e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Qtd: ",s.quantity]})]}),e.jsxs("div",{className:"text-sm font-medium",children:["R$ ",(s.price*s.quantity).toFixed(2)]})]},s.id)),e.jsx($,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["R$ ",r.subtotal.toFixed(2)]})]}),r.tax>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Taxa"}),e.jsxs("span",{children:["R$ ",r.tax.toFixed(2)]})]}),r.shipping>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Frete"}),e.jsxs("span",{children:["R$ ",r.shipping.toFixed(2)]})]}),r.discount&&r.discount>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Desconto"}),e.jsxs("span",{children:["-R$ ",r.discount.toFixed(2)]})]}),e.jsx($,{}),e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["R$ ",r.total.toFixed(2)]})]})]})]})})]})})]})})]})};export{je as default};

import{s,c as m}from"./index-DuXT2tR6.js";const l={async list(e){try{let r=s.from("Customer").select("*").order("createdAt",{ascending:!1});e!=null&&e.status&&(r=r.eq("status",e.status)),e!=null&&e.search&&(r=r.or(`name.ilike.%${e.search}%,email.ilike.%${e.search}%,cpf.ilike.%${e.search}%`)),e!=null&&e.tags&&e.tags.length>0&&(r=r.contains("tags",e.tags));const{data:t,error:o}=await r;if(o)throw o;return t}catch(r){throw console.error("Error listing customers:",r),r}},async listFromShopify(e,r){try{let t=s.from("ShopifyCustomer").select("*").eq("userId",e).order("updatedAt",{ascending:!1});r!=null&&r.search&&(t=t.or(`email.ilike.%${r.search}%,firstName.ilike.%${r.search}%,lastName.ilike.%${r.search}%`));const{data:o,error:n}=await t;if(n)throw n;return(o||[]).map(a=>{var c,i,d;return{id:String(a.id),userId:a.userId,email:a.email||"",name:`${a.firstName||""} ${a.lastName||""}`.trim()||"Cliente",phone:a.phone,cpf:void 0,birthDate:void 0,gender:void 0,totalOrders:a.ordersCount||0,totalSpent:parseFloat(a.totalSpent||"0"),averageOrderValue:a.ordersCount>0?parseFloat(a.totalSpent||"0")/a.ordersCount:0,lastOrderAt:((c=a.shopifyData)==null?void 0:c.last_order_date)||void 0,tags:(i=a.shopifyData)!=null&&i.tags?a.shopifyData.tags.split(",").map(u=>u.trim()):[],notes:void 0,acceptsMarketing:((d=a.shopifyData)==null?void 0:d.accepts_marketing)||!1,status:"ACTIVE",createdAt:a.createdAt,updatedAt:a.updatedAt}})}catch(t){throw console.error("Error listing Shopify customers:",t),t}},async getById(e){try{const{data:r,error:t}=await s.from("Customer").select("*, CustomerAddress(*)").eq("id",e).single();if(t)throw t;return r}catch(r){throw console.error("Error getting customer:",r),r}},async getByEmail(e){try{const{data:r,error:t}=await s.from("Customer").select("*").eq("email",e).single();if(t)throw t;return r}catch(r){throw console.error("Error getting customer by email:",r),r}},async create(e){try{const{data:r,error:t}=await s.from("Customer").insert({...e,totalOrders:0,totalSpent:0,averageOrderValue:0}).select().single();if(t)throw t;return r}catch(r){throw console.error("Error creating customer:",r),r}},async update(e,r){try{const{data:t,error:o}=await s.from("Customer").update({...r,updatedAt:new Date().toISOString()}).eq("id",e).select().single();if(o)throw o;return t}catch(t){throw console.error("Error updating customer:",t),t}},async toggleStatus(e,r){try{const{data:t,error:o}=await s.from("Customer").update({status:r,updatedAt:new Date().toISOString()}).eq("id",e).select().single();if(o)throw o;return t}catch(t){throw console.error("Error toggling customer status:",t),t}},async delete(e){try{const{error:r}=await s.from("Customer").delete().eq("id",e);if(r)throw r}catch(r){throw console.error("Error deleting customer:",r),r}}};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=m("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);export{g as U,l as c};

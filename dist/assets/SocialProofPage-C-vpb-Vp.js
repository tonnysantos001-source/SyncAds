import{c as $,r as c,b as z,s as x,u as G,j as e,B as p,I as O,d as w,e as P,f as R,h as D,S as K,n as Y}from"./index-koz9QZbf.js";import{T as Z,a as ee,b as V,c as E,d as ae,e as b}from"./table-CUHnMMuh.js";import{D as se,a as te,b as re,c as ie,d as oe,f as le}from"./dialog-NOKRWyFS.js";import{L as S}from"./label-DInAe46k.js";import{T as ne}from"./textarea-DLqiH_w5.js";import{S as _}from"./skeleton-Cw6XLVyS.js";import{A as ce,a as de}from"./alert-DHOaXqC3.js";import{P as M}from"./plus-CSZhzeo6.js";import{M as I}from"./message-square-BNvcSdyg.js";import{T as H}from"./trending-up-pITUHt8h.js";import{S as me}from"./sparkles-CYKFebG7.js";import{S as ue}from"./square-pen-CysoCEE-.js";import{T as pe}from"./trash-2-CN0qxFsR.js";import{U as xe}from"./users-BrKkHow-.js";import"./x-P0pbq6F1.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=$("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),g=[{type:"RECENT_PURCHASE",message:"ðŸŽ‰ Maria de SÃ£o Paulo acabou de comprar hÃ¡ 3 minutos!",displayDuration:5,isActive:!0},{type:"RECENT_PURCHASE",message:"âœ¨ JoÃ£o do Rio de Janeiro finalizou uma compra agora!",displayDuration:5,isActive:!0},{type:"RECENT_PURCHASE",message:"ðŸ”¥ Ana de Belo Horizonte acabou de comprar este produto!",displayDuration:6,isActive:!0},{type:"VISITOR_COUNT",message:"ðŸ‘€ 38 pessoas estÃ£o visualizando este produto agora",displayDuration:7,isActive:!0},{type:"VISITOR_COUNT",message:"ðŸ”¥ +120 pessoas compraram nas Ãºltimas 24 horas",displayDuration:6,isActive:!0},{type:"VISITOR_COUNT",message:"âš¡ Mais de 50 pessoas adicionaram ao carrinho hoje",displayDuration:6,isActive:!0},{type:"REVIEW",message:'â­â­â­â­â­ "Produto excelente! Recomendo muito" - Carlos',displayDuration:8,isActive:!0},{type:"REVIEW",message:'â­â­â­â­â­ "Superou minhas expectativas!" - Juliana',displayDuration:7,isActive:!0},{type:"REVIEW",message:'â­â­â­â­â­ "Melhor compra que jÃ¡ fiz!" - Pedro',displayDuration:7,isActive:!0},{type:"RECENT_PURCHASE",message:"ðŸ’š AlguÃ©m de Curitiba acabou de fazer um pedido",displayDuration:5,isActive:!0},{type:"VISITOR_COUNT",message:"ðŸš¨ Apenas 3 unidades restantes em estoque!",displayDuration:8,isActive:!0},{type:"RECENT_PURCHASE",message:"ðŸŽŠ Patricia de Porto Alegre comprou hÃ¡ 7 minutos",displayDuration:5,isActive:!0}];function ge(){const[u,h]=c.useState(!1),{toast:d}=z(),f=()=>g,v=t=>g.filter(l=>l.type===t),T=()=>{const t=Math.floor(Math.random()*g.length);return g[t]},m=t=>[...g].sort(()=>Math.random()-.5).slice(0,Math.min(t,g.length));return{loading:u,getExamples:f,getExamplesByType:v,getRandomExample:T,getRandomExamples:m,createExamplesForUser:async(t,l=5)=>{if(!t)return d({title:"Erro",description:"ID do usuÃ¡rio nÃ£o fornecido",variant:"destructive"}),!1;h(!0);try{const{data:r,error:s}=await x.from("SocialProof").select("id").eq("userId",t).limit(1);if(s)throw s;if(r&&r.length>0)return d({title:"JÃ¡ existem provas sociais",description:"VocÃª jÃ¡ possui provas sociais configuradas."}),!1;const N=m(l).map(n=>({userId:t,type:n.type,message:n.message,displayDuration:n.displayDuration,isActive:n.isActive})),{error:o}=await x.from("SocialProof").insert(N);if(o)throw o;return d({title:"Exemplos criados!",description:`${l} provas sociais de exemplo foram adicionadas. VocÃª pode editÃ¡-las ou criar novas.`}),!0}catch(r){return console.error("Erro ao criar exemplos:",r),d({title:"Erro ao criar exemplos",description:r.message||"Tente novamente mais tarde",variant:"destructive"}),!1}finally{h(!1)}},createSingleExample:async(t,l)=>{if(!t)return!1;h(!0);try{const r=v(l);if(r.length===0)return!1;const s=r[Math.floor(Math.random()*r.length)],{error:y}=await x.from("SocialProof").insert({userId:t,type:s.type,message:s.message,displayDuration:s.displayDuration,isActive:s.isActive});if(y)throw y;return d({title:"Exemplo criado!",description:"Prova social adicionada com sucesso."}),!0}catch(r){return console.error("Erro ao criar exemplo:",r),d({title:"Erro ao criar exemplo",description:r.message,variant:"destructive"}),!1}finally{h(!1)}},getMessageSuggestions:t=>({RECENT_PURCHASE:["ðŸŽ‰ [Nome] de [Cidade] acabou de comprar hÃ¡ [tempo] minutos!","âœ¨ [Nome] finalizou uma compra agora!","ðŸ”¥ AlguÃ©m de [Cidade] acabou de comprar este produto!","ðŸ’š [Nome] acabou de fazer um pedido","ðŸŽŠ [Nome] de [Cidade] comprou hÃ¡ [tempo] minutos"],VISITOR_COUNT:["ðŸ‘€ [nÃºmero] pessoas estÃ£o visualizando este produto agora","ðŸ”¥ +[nÃºmero] pessoas compraram nas Ãºltimas 24 horas","âš¡ Mais de [nÃºmero] pessoas adicionaram ao carrinho hoje","ðŸš¨ Apenas [nÃºmero] unidades restantes em estoque!","ðŸ“ˆ Este produto estÃ¡ sendo muito procurado!"],REVIEW:['â­â­â­â­â­ "Produto excelente! Recomendo muito" - [Nome]','â­â­â­â­â­ "Superou minhas expectativas!" - [Nome]','â­â­â­â­â­ "Melhor compra que jÃ¡ fiz!" - [Nome]','â­â­â­â­â­ "Qualidade excepcional!" - [Nome]','â­â­â­â­â­ "Vale cada centavo!" - [Nome]']})[t]||[]}}const Ie=()=>{const[u,h]=c.useState([]),[d,f]=c.useState([]),[v,T]=c.useState(!0),[m,k]=c.useState(""),[U,j]=c.useState(!1),[t,l]=c.useState(null),{toast:r}=z(),s=G(a=>a.user),{createExamplesForUser:y,loading:N}=ge(),[o,n]=c.useState({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0});c.useEffect(()=>{C()},[]);const q=async()=>{if(!(s!=null&&s.id))return;await y(s.id,8)&&C()};c.useEffect(()=>{L()},[m,u]);const C=async()=>{try{if(!(s!=null&&s.id))return;const{data:a,error:i}=await x.from("SocialProof").select("*").eq("userId",s.id).order("createdAt",{ascending:!1});if(i)throw i;h(a||[]),f(a||[])}catch(a){r({title:"Erro ao carregar",description:a.message,variant:"destructive"})}finally{T(!1)}},L=()=>{if(!m){f(u);return}const a=u.filter(i=>i.message.toLowerCase().includes(m.toLowerCase()));f(a)},F=async a=>{a.preventDefault();try{if(!(s!=null&&s.id))return;if(t){const{error:i}=await x.from("SocialProof").update({...o,updatedAt:new Date().toISOString()}).eq("id",t.id);if(i)throw i;r({title:"Prova social atualizada!"})}else{const{error:i}=await x.from("SocialProof").insert({...o,userId:s.id});if(i)throw i;r({title:"Prova social criada!",description:"A notificaÃ§Ã£o estÃ¡ pronta para exibiÃ§Ã£o."})}j(!1),A(),C()}catch(i){r({title:"Erro",description:i.message,variant:"destructive"})}},W=async a=>{if(confirm("Tem certeza que deseja deletar esta prova social?"))try{const{error:i}=await x.from("SocialProof").delete().eq("id",a);if(i)throw i;r({title:"Prova social deletada"}),C()}catch(i){r({title:"Erro ao deletar",description:i.message,variant:"destructive"})}},B=a=>{l(a),n({type:a.type,message:a.message,displayDuration:a.displayDuration,isActive:a.isActive}),j(!0)},A=()=>{l(null),n({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0})},J=u.filter(a=>a.isActive).length,Q=a=>({RECENT_PURCHASE:"Compra Recente",VISITOR_COUNT:"Contador de Visitantes",REVIEW:"AvaliaÃ§Ã£o"})[a]||a,X=a=>{switch(a){case"RECENT_PURCHASE":return e.jsx(H,{className:"h-4 w-4"});case"VISITOR_COUNT":return e.jsx(xe,{className:"h-4 w-4"});case"REVIEW":return e.jsx(I,{className:"h-4 w-4"});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent",children:"Prova Social"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-medium",children:"NotificaÃ§Ãµes em tempo real para aumentar confianÃ§a"})]}),e.jsxs(se,{open:U,onOpenChange:j,children:[e.jsx(te,{asChild:!0,children:e.jsxs(p,{onClick:A,children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Criar Prova Social"]})}),e.jsxs(re,{className:"max-w-lg",children:[e.jsx(ie,{children:e.jsx(oe,{children:t?"Editar Prova Social":"Nova Prova Social"})}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Tipo *"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",value:o.type,onChange:a=>n({...o,type:a.target.value}),required:!0,children:[e.jsx("option",{value:"RECENT_PURCHASE",children:"Compra Recente"}),e.jsx("option",{value:"VISITOR_COUNT",children:"Contador de Visitantes"}),e.jsx("option",{value:"REVIEW",children:"AvaliaÃ§Ã£o"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o.type==="RECENT_PURCHASE"&&'Ex: "JoÃ£o acabou de comprar hÃ¡ 5 minutos"',o.type==="VISITOR_COUNT"&&'Ex: "23 pessoas estÃ£o visualizando este produto"',o.type==="REVIEW"&&'Ex: "â˜…â˜…â˜…â˜…â˜… Produto excelente! - Maria S."']})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Mensagem *"}),e.jsx(ne,{value:o.message,onChange:a=>n({...o,message:a.target.value}),placeholder:"Digite a mensagem que serÃ¡ exibida...",rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"DuraÃ§Ã£o de ExibiÃ§Ã£o (segundos)"}),e.jsx(O,{type:"number",min:"1",max:"30",value:o.displayDuration,onChange:a=>n({...o,displayDuration:parseInt(a.target.value)}),required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.isActive,onChange:a=>n({...o,isActive:a.target.checked}),className:"rounded"}),e.jsx(S,{children:"Ativo"})]}),e.jsxs(le,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(p,{type:"submit",children:t?"Atualizar":"Criar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(w,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Total"}),e.jsx(I,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:u.length})})]}),e.jsxs(w,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Ativas"}),e.jsx(H,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:J})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-600 dark:text-gray-400"}),e.jsx(O,{placeholder:"Buscar provas sociais...",value:m,onChange:a=>k(a.target.value),className:"pl-9 border-gray-200 dark:border-gray-600 bg-white/80 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500 backdrop-blur-sm"})]}),!v&&u.length===0&&e.jsxs(ce,{className:"border-blue-200 bg-blue-50",children:[e.jsx(he,{className:"h-4 w-4 text-blue-600"}),e.jsxs(de,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Comece com exemplos prontos!"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Crie 8 provas sociais de exemplo para testar no seu checkout. VocÃª pode editÃ¡-las ou excluÃ­-las depois."})]}),e.jsxs(p,{onClick:q,disabled:N,className:"ml-4 bg-blue-600 hover:bg-blue-700",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),N?"Criando...":"Criar Exemplos"]})]})]}),e.jsxs(w,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(P,{children:e.jsx(R,{children:"Lista de Provas Sociais"})}),e.jsx(D,{children:v?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"h-12 w-full"}),e.jsx(_,{className:"h-12 w-full"})]}):d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhuma prova social encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:m?"Tente ajustar sua busca":"Comece criando a primeira prova social"}),!m&&e.jsxs(p,{onClick:A,children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Criar Primeira Prova Social"]})]}):e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(V,{children:[e.jsx(E,{children:"Tipo"}),e.jsx(E,{children:"Mensagem"}),e.jsx(E,{children:"DuraÃ§Ã£o"}),e.jsx(E,{children:"Status"}),e.jsx(E,{className:"text-right",children:"AÃ§Ãµes"})]})}),e.jsx(ae,{children:d.map(a=>e.jsxs(V,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[X(a.type),e.jsx("span",{className:"text-sm",children:Q(a.type)})]})}),e.jsx(b,{className:"max-w-md truncate",children:a.message}),e.jsxs(b,{children:[a.displayDuration,"s"]}),e.jsx(b,{children:e.jsx(Y,{variant:a.isActive?"default":"secondary",children:a.isActive?"Ativa":"Inativa"})}),e.jsx(b,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>B(a),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>W(a.id),children:e.jsx(pe,{className:"h-4 w-4"})})]})})]},a.id))})]})})]})]})};export{Ie as default};

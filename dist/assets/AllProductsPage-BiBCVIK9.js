import{c as me,r as o,b as he,u as xe,j as e,M as n,B as c,a6 as Z,d as w,e as S,f as C,h as P,g as G,S as pe,I as f,o as V}from"./index-B_wPe04m.js";import{T as ue,a as ge,b as ye,c as m,d as je,e as x}from"./table-Dh1_sAY8.js";import{D as fe,b as ve,c as be,d as ke,e as Ne,f as we}from"./dialog-DhD2OFL2.js";import{L as p}from"./label-oXSNXby1.js";import{T as Se}from"./textarea-CqIt6aby.js";import{S as J,a as Q,b as W,c as X,d as u}from"./select-WwSiR7mt.js";import{p as I}from"./productsApi-gUYykiYE.js";import{a as Y}from"./shopifySync-CxyYWkRF.js";import{S as L}from"./skeleton-BaJBaox7.js";import{A as Ce,b as Pe,a as Ae}from"./alert-BwibZesg.js";import{P as _}from"./plus-BFyaAExq.js";import{S as ee}from"./shopping-bag-s6gU-JAt.js";import{P as R}from"./package-DPOFTmI8.js";import{D as Te}from"./dollar-sign-C0MQiBxt.js";import{S as Ie}from"./square-pen-hBz_rtR7.js";import{T as De}from"./trash-2-CKF-1MQQ.js";import"./x-BmNQy4f-.js";import"./index-DHsm_O1P.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=me("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]),Xe=()=>{const[h,ae]=o.useState([]),[v,B]=o.useState([]),[re,D]=o.useState(!0),[b,q]=o.useState(!1),[d,te]=o.useState(""),[g,se]=o.useState("all"),[ie,y]=o.useState(!1),[k,M]=o.useState(null),[E,oe]=o.useState({totalProducts:0,totalOrders:0,lastSync:null}),{toast:i}=he(),r=xe(a=>a.user),[t,l]=o.useState({name:"",description:"",price:0,comparePrice:0,sku:"",stock:0,categoryId:"",status:"ACTIVE"}),A={total:h.length,active:h.filter(a=>a.status==="ACTIVE").length,totalValue:h.reduce((a,s)=>a+s.price*s.stock,0)};o.useEffect(()=>{r!=null&&r.id&&(T(),H())},[r==null?void 0:r.id]),o.useEffect(()=>{le()},[d,g,h]);const T=async()=>{if(!(r!=null&&r.id)){D(!1);return}try{D(!0);const a=await I.listFromShopify(r.id);ae(a),B(a)}catch(a){console.error("Erro ao carregar produtos:",a),i({title:"Erro ao carregar produtos",description:a.message,variant:"destructive"})}finally{D(!1)}},H=async()=>{if(r!=null&&r.id)try{const a=await Y.getSyncStats(r.id);oe(a)}catch(a){console.debug("Sync stats não disponíveis:",a)}},O=async()=>{if(!(r!=null&&r.id)){i({title:"Erro",description:"Faça login para sincronizar",variant:"destructive"});return}try{q(!0),i({title:"Sincronizando...",description:"Buscando produtos da Shopify"});const a=await Y.syncProducts(r.id,r.organizationId||r.id);a.success?(i({title:"Sincronização concluída!",description:a.message}),await T(),await H()):i({title:"Shopify não configurada",description:"Configure a integração Shopify em Integrações",variant:"destructive"})}catch{i({title:"Shopify não disponível",description:"Configure a integração em Integrações > Shopify",variant:"destructive"})}finally{q(!1)}},le=()=>{let a=h;d&&(a=a.filter(s=>{var j,N;return s.name.toLowerCase().includes(d.toLowerCase())||((j=s.sku)==null?void 0:j.toLowerCase().includes(d.toLowerCase()))||((N=s.description)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))})),g!=="all"&&(a=a.filter(s=>s.status===g)),B(a)},ne=async a=>{if(a.preventDefault(),!(r!=null&&r.id)){i({title:"Erro",description:"Você precisa estar logado",variant:"destructive"});return}try{k?(await I.update(k.id,t),i({title:"Produto atualizado!",description:"As alterações foram salvas com sucesso."})):(await I.create({...t,userId:r.id,organizationId:r.organizationId||r.id,slug:t.name.toLowerCase().replace(/\s+/g,"-"),lowStockThreshold:5,trackStock:!0,isFeatured:!1,isActive:t.status==="ACTIVE"}),i({title:"Produto criado!",description:"O produto foi adicionado ao catálogo."})),y(!1),F(),T()}catch(s){console.error("Erro ao salvar:",s),i({title:"Erro ao salvar produto",description:s.message||"Tente novamente",variant:"destructive"})}},de=a=>{M(a),l({name:a.name,description:a.description||"",price:a.price,comparePrice:a.comparePrice||0,sku:a.sku||"",stock:a.stock,categoryId:a.categoryId||"",status:a.status}),y(!0)},ce=async a=>{if(confirm("Tem certeza que deseja excluir este produto?"))try{await I.delete(a),i({title:"Produto excluído",description:"O produto foi removido do catálogo."}),T()}catch(s){i({title:"Erro ao excluir produto",description:s.message,variant:"destructive"})}},F=()=>{M(null),l({name:"",description:"",price:0,comparePrice:0,sku:"",stock:0,categoryId:"",status:"ACTIVE"})},z=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-purple-600 via-pink-600 to-cyan-600 bg-clip-text text-transparent",children:"Produtos"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Gerencie o catálogo completo de produtos da sua loja"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{onClick:O,disabled:b,className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white border-0 hover:from-purple-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50",children:[e.jsx(Z,{className:`mr-2 h-4 w-4 ${b?"animate-spin":""}`}),b?"Sincronizando...":"Sincronizar Shopify"]}),e.jsxs(c,{onClick:()=>{F(),y(!0)},className:"bg-gradient-to-r from-cyan-500 to-blue-500 text-white border-0 hover:from-cyan-600 hover:to-blue-600 transition-all duration-300 shadow-lg hover:shadow-xl",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Adicionar Produto"]})]})]}),E.lastSync&&e.jsx(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.1},children:e.jsxs(Ce,{className:"border-0 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 backdrop-blur-sm",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx(Pe,{children:"Integração Shopify Ativa"}),e.jsxs(Ae,{children:["Última sincronização:"," ",new Date(E.lastSync).toLocaleString("pt-BR")," •",E.totalProducts," produtos importados"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsxs(w,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-500 opacity-10 rounded-full blur-3xl"}),e.jsxs(S,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total de Produtos"}),e.jsx("div",{className:"p-2 rounded-lg bg-purple-500 bg-opacity-10",children:e.jsx(R,{className:"h-4 w-4 text-purple-500"})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-purple-600 to-pink-500 bg-clip-text text-transparent",children:A.total}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[A.active," ativos"]})]})]})}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:e.jsxs(w,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-pink-500 opacity-10 rounded-full blur-3xl"}),e.jsxs(S,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Produtos Ativos"}),e.jsx("div",{className:"p-2 rounded-lg bg-pink-500 bg-opacity-10",children:e.jsx(Ee,{className:"h-4 w-4 text-pink-500"})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-pink-600 to-rose-500 bg-clip-text text-transparent",children:A.active}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Disponíveis para venda"})]})]})}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:e.jsxs(w,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-cyan-500 opacity-10 rounded-full blur-3xl"}),e.jsxs(S,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Valor Total"}),e.jsx("div",{className:"p-2 rounded-lg bg-cyan-500 bg-opacity-10",children:e.jsx(Te,{className:"h-4 w-4 text-cyan-500"})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-cyan-600 to-blue-500 bg-clip-text text-transparent",children:z(A.totalValue)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Estoque valorizado"})]})]})})]}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},children:e.jsxs(w,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsxs(S,{children:[e.jsx(C,{className:"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Filtros"}),e.jsx(G,{className:"dark:text-gray-400",children:"Busque e filtre produtos"})]}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(f,{placeholder:"Buscar por nome, SKU ou descrição...",value:d,onChange:a=>te(a.target.value),className:"pl-10 border-gray-200 dark:border-gray-700 bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm dark:text-white dark:placeholder:text-gray-500"})]})}),e.jsxs(J,{value:g,onValueChange:se,children:[e.jsx(Q,{className:"w-full md:w-[200px] border-gray-200 dark:border-gray-700 bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm dark:text-white",children:e.jsx(W,{placeholder:"Status"})}),e.jsxs(X,{children:[e.jsx(u,{value:"all",children:"Todos os Status"}),e.jsx(u,{value:"ACTIVE",children:"Ativo"}),e.jsx(u,{value:"DRAFT",children:"Rascunho"}),e.jsx(u,{value:"ARCHIVED",children:"Arquivado"})]})]})]})})]})}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:e.jsxs(w,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsxs(S,{children:[e.jsxs(C,{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-cyan-600 bg-clip-text text-transparent",children:["Catálogo (",v.length,")"]}),e.jsx(G,{className:"dark:text-gray-400",children:v.length===h.length?"Mostrando todos os produtos":`Mostrando ${v.length} de ${h.length} produtos`})]}),e.jsx(P,{children:re?e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{className:"h-12 w-full"}),e.jsx(L,{className:"h-12 w-full"}),e.jsx(L,{className:"h-12 w-full"})]}):v.length===0?e.jsxs(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"flex flex-col items-center justify-center h-64",children:[e.jsx(R,{className:"h-16 w-16 text-muted-foreground mb-4 opacity-50"}),e.jsx("p",{className:"text-muted-foreground text-center mb-4 dark:text-gray-300",children:d||g!=="all"?"Nenhum produto encontrado com os filtros aplicados":"Nenhum produto cadastrado"}),!d&&g==="all"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{onClick:O,variant:"outline",disabled:b,children:[e.jsx(Z,{className:`mr-2 h-4 w-4 ${b?"animate-spin":""}`}),"Sincronizar Shopify"]}),e.jsxs(c,{onClick:()=>{F(),y(!0)},children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Adicionar Primeiro Produto"]})]})]}):e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:e.jsxs(ue,{children:[e.jsx(ge,{children:e.jsxs(ye,{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-gray-800 dark:to-gray-800 hover:from-purple-100 hover:to-pink-100 dark:hover:from-gray-700 dark:hover:to-gray-700",children:[e.jsx(m,{children:"Imagem"}),e.jsx(m,{className:"font-semibold dark:text-gray-300",children:"Produto"}),e.jsx(m,{className:"font-semibold dark:text-gray-300",children:"SKU"}),e.jsx(m,{className:"font-semibold dark:text-gray-300",children:"Preço"}),e.jsx(m,{className:"font-semibold dark:text-gray-300",children:"Estoque"}),e.jsx(m,{className:"font-semibold dark:text-gray-300",children:"Status"}),e.jsx(m,{className:"text-right font-semibold dark:text-gray-300",children:"Ações"}),e.jsx(m,{children:"Ações"})]})}),e.jsx(je,{children:v.map((a,s)=>{var U,$,K;const j=((U=a.metadata)==null?void 0:U.images)||[],N=j.length>0?(($=j[0])==null?void 0:$.src)||j[0]:null;return e.jsxs(n.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:s*.05},className:"border-b border-gray-100 dark:border-gray-800 hover:bg-gradient-to-r hover:from-purple-50/50 hover:to-pink-50/50 dark:hover:from-gray-800/50 dark:hover:to-gray-800/50 transition-all duration-200",children:[e.jsx(x,{children:N?e.jsx("img",{src:N,alt:a.name,className:"w-12 h-12 object-cover rounded-md border"}):e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-100 to-pink-100 dark:from-purple-900/20 dark:to-pink-900/20 rounded-md flex items-center justify-center",children:e.jsx(R,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium dark:text-white",children:a.name}),a.description&&e.jsx("div",{className:"text-sm text-muted-foreground line-clamp-1",children:a.description}),((K=a.metadata)==null?void 0:K.shopifyId)&&e.jsxs(V,{variant:"outline",className:"mt-1 bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 text-purple-700 dark:text-purple-300 border-purple-300 dark:border-purple-700",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),"Shopify"]})]})}),e.jsx(x,{children:e.jsx("code",{className:"text-xs bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 px-2 py-1 rounded dark:text-gray-300",children:a.sku||"N/A"})}),e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:z(a.price)}),a.comparePrice&&a.comparePrice>a.price&&e.jsx("div",{className:"text-xs text-muted-foreground line-through",children:z(a.comparePrice)})]})}),e.jsx(x,{children:e.jsxs(V,{variant:a.stock>10?"default":a.stock>0?"warning":"destructive",children:[a.stock," un."]})}),e.jsx(x,{children:e.jsx(V,{variant:a.status==="ACTIVE"?"default":a.status==="DRAFT"?"secondary":"outline",children:a.status==="ACTIVE"?"Ativo":a.status==="DRAFT"?"Rascunho":"Arquivado"})}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>de(a),className:"hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 dark:hover:from-gray-800 dark:hover:to-gray-800",children:e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>ce(a.id),className:"hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-600 dark:hover:text-red-400",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},a.id)})})]})})})]})}),e.jsx(fe,{open:ie,onOpenChange:y,children:e.jsxs(ve,{className:"max-w-2xl",children:[e.jsxs(be,{children:[e.jsx(ke,{children:k?"Editar Produto":"Novo Produto"}),e.jsx(Ne,{children:k?"Atualize as informações do produto":"Adicione um novo produto ao catálogo"})]}),e.jsxs("form",{onSubmit:ne,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"name",children:"Nome do Produto *"}),e.jsx(f,{id:"name",value:t.name,onChange:a=>l({...t,name:a.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"description",children:"Descrição"}),e.jsx(Se,{id:"description",value:t.description,onChange:a=>l({...t,description:a.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"price",children:"Preço *"}),e.jsx(f,{id:"price",type:"number",step:"0.01",value:t.price,onChange:a=>l({...t,price:parseFloat(a.target.value)}),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"comparePrice",children:"Preço Comparação"}),e.jsx(f,{id:"comparePrice",type:"number",step:"0.01",value:t.comparePrice,onChange:a=>l({...t,comparePrice:parseFloat(a.target.value)})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"sku",children:"SKU"}),e.jsx(f,{id:"sku",value:t.sku,onChange:a=>l({...t,sku:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"stock",children:"Estoque *"}),e.jsx(f,{id:"stock",type:"number",value:t.stock,onChange:a=>l({...t,stock:parseInt(a.target.value)}),required:!0})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"status",children:"Status"}),e.jsxs(J,{value:t.status,onValueChange:a=>l({...t,status:a}),children:[e.jsx(Q,{children:e.jsx(W,{})}),e.jsxs(X,{children:[e.jsx(u,{value:"ACTIVE",children:"Ativo"}),e.jsx(u,{value:"DRAFT",children:"Rascunho"}),e.jsx(u,{value:"ARCHIVED",children:"Arquivado"})]})]})]})]}),e.jsxs(we,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),e.jsxs(c,{type:"submit",children:[k?"Atualizar":"Criar"," Produto"]})]})]})]})})]})};export{Xe as default};

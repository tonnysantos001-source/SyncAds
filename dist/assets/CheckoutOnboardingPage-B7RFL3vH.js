import{u as q,a as I,r,s as a,j as s,d as c,e as o,f as d,h as p,l as x,B as A}from"./index-49tCWr1j.js";import{P as B}from"./progress-C-SDWDOZ.js";function V(){var h;const e=q(t=>t.user),l=I(),[i,g]=r.useState([]),[f,j]=r.useState(!0);r.useEffect(()=>{e!=null&&e.id&&y()},[e==null?void 0:e.id]);const y=async()=>{if(e!=null&&e.id)try{const[t,n,k,P]=await Promise.all([v(),b(),N(),C()]);g([{id:"billing",title:"Faturamento",description:"Configure seu plano e método de pagamento",completed:t,route:"/billing"},{id:"domain",title:"Domínio",description:"Verifique seu domínio (mesmo da Shopify/WooCommerce)",completed:n,route:"/checkout/domain"},{id:"gateway",title:"Gateway de Pagamento",description:"Configure os meios de pagamento",completed:k,route:"/checkout/gateways"},{id:"shipping",title:"Frete",description:"Crie métodos de entrega",completed:P,route:"/checkout/shipping"}])}catch(t){console.error("Erro ao carregar status:",t)}finally{j(!1)}},v=async()=>{if(!(e!=null&&e.id))return!1;try{const{data:t}=await a.from("User").select("currentPlanId").eq("id",e.id).single();if(t!=null&&t.currentPlanId)return!0;const{data:n}=await a.from("Subscription").select("id, status").eq("userId",e.id).eq("status","active").single();return!!n}catch{return!1}},b=async()=>{if(!(e!=null&&e.id))return!1;try{const{data:t}=await a.from("User").select("domain, domainVerified").eq("id",e.id).single();return!!(t!=null&&t.domain&&(t!=null&&t.domainVerified))}catch{return!1}},N=async()=>{if(!(e!=null&&e.id))return!1;try{const{data:t}=await a.from("GatewayConfig").select("id").eq("userId",e.id).eq("isActive",!0).limit(1);return((t==null?void 0:t.length)||0)>0}catch{return!1}},C=async()=>{if(!(e!=null&&e.id))return!1;try{const{data:t}=await a.from("ShippingMethod").select("id").eq("userId",e.id).limit(1);return((t==null?void 0:t.length)||0)>0}catch{return!1}};if(f)return s.jsx("div",{className:"p-8",children:s.jsx("p",{children:"Carregando..."})});const S=(e==null?void 0:e.name)||((h=e==null?void 0:e.email)==null?void 0:h.split("@")[0])||"usuário",m=i.filter(t=>t.completed).length,u=i.length,w=m/u*100;return s.jsxs("div",{className:"p-8 max-w-4xl mx-auto space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold mb-2",children:["Olá ",S]}),s.jsx("p",{className:"text-muted-foreground",children:"Complete as etapas abaixo para ativar seu checkout"})]}),s.jsxs(c,{children:[s.jsx(o,{children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx(d,{children:"Progresso"}),s.jsxs("span",{className:"text-sm",children:[m," de ",u," concluídos"]})]})}),s.jsx(p,{children:s.jsx(B,{value:w,className:"h-2"})})]}),s.jsx("div",{className:"space-y-4",children:i.map(t=>s.jsx(c,{className:"cursor-pointer hover:border-primary transition-colors",onClick:()=>l(t.route),children:s.jsx(o,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(d,{className:"text-lg",children:t.title}),t.completed?s.jsx(x,{variant:"secondary",className:"bg-green-100 text-green-700",children:"✓ Concluído"}):s.jsx(x,{variant:"destructive",children:"Pendente"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]}),s.jsx("span",{className:"text-muted-foreground",children:"→"})]})})},t.id))}),s.jsxs(c,{children:[s.jsx(o,{children:s.jsx(d,{children:"Precisa de ajuda?"})}),s.jsx(p,{children:s.jsx(A,{onClick:()=>l("/chat"),variant:"outline",children:"Acessar Central de Ajuda"})})]})]})}export{V as default};

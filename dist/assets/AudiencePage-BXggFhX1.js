import{j as e}from"./vendor-ui-DAyDU-p2.js";import{r as a}from"./vendor-react-BDwqAlkB.js";import{f as s,s as t,B as r,C as d,a as l,b as i,d as o,e as c,c as n}from"./index-Bc1oLC4s.js";import{S as x,a as m,b as h,c as p,d as g}from"./select-DU-a5icj.js";import{S as j}from"./skeleton-DOMY7_UZ.js";import{m as y}from"./vendor-animation-x8f1c1kX.js";import{aa as u,a6 as b,s as f,am as N,D as v,aP as w,aQ as k,N as R,ay as P,E as S,W as A}from"./vendor-icons-CzCc3fGi.js";import{R as T,f as E,C as M,X as C,Y as B,T as F,B as G,g as D}from"./vendor-charts-DgCBwi6-.js";import"./vendor-supabase-rKXMzPQL.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-query-D3VdSFIC.js";const $=({title:a,value:s,icon:t,color:r,change:o,delay:c=0})=>e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:c},children:e.jsxs(d,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${r} opacity-10 rounded-full blur-3xl`}),e.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a}),e.jsx("div",{className:`p-2 rounded-lg ${r} bg-opacity-10`,children:e.jsx(t,{className:`h-4 w-4 ${r.replace("bg-","text-")}`})})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:s}),void 0!==o&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(S,{className:"h-4 w-4 "+(o>=0?"text-green-500":"text-red-500")}),e.jsxs("span",{className:"text-sm font-semibold "+(o>=0?"text-green-500":"text-red-500"),children:[Math.abs(o).toFixed(1),"%"]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"vs último período"})]})]})]})}),z=[{code:"AC",name:"Acre"},{code:"AL",name:"Alagoas"},{code:"AP",name:"Amapá"},{code:"AM",name:"Amazonas"},{code:"BA",name:"Bahia"},{code:"CE",name:"Ceará"},{code:"DF",name:"Distrito Federal"},{code:"ES",name:"Espírito Santo"},{code:"GO",name:"Goiás"},{code:"MA",name:"Maranhão"},{code:"MT",name:"Mato Grosso"},{code:"MS",name:"Mato Grosso do Sul"},{code:"MG",name:"Minas Gerais"},{code:"PA",name:"Pará"},{code:"PB",name:"Paraíba"},{code:"PR",name:"Paraná"},{code:"PE",name:"Pernambuco"},{code:"PI",name:"Piauí"},{code:"RJ",name:"Rio de Janeiro"},{code:"RN",name:"Rio Grande do Norte"},{code:"RS",name:"Rio Grande do Sul"},{code:"RO",name:"Rondônia"},{code:"RR",name:"Roraima"},{code:"SC",name:"Santa Catarina"},{code:"SP",name:"São Paulo"},{code:"SE",name:"Sergipe"},{code:"TO",name:"Tocantins"}],O=({active:a,payload:s})=>a&&s&&s.length?e.jsxs("div",{className:"bg-gray-900/95 dark:bg-gray-800/95 backdrop-blur-xl border border-gray-700 rounded-lg p-4 shadow-xl",children:[e.jsx("p",{className:"text-white font-semibold mb-2",children:s[0].payload.stateName}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(N,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-gray-300",children:"Pedidos:"}),e.jsx("span",{className:"text-white font-semibold",children:s[0].payload.orders})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(v,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-gray-300",children:"Receita:"}),e.jsxs("span",{className:"text-white font-semibold",children:["R$"," ",s[0].value.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(A,{className:"h-4 w-4 text-purple-400"}),e.jsx("span",{className:"text-gray-300",children:"Clientes:"}),e.jsx("span",{className:"text-white font-semibold",children:s[0].payload.customers})]})]})]}):null,q=()=>{const[S,A]=a.useState(!0),[q,I]=a.useState("7days"),[L,J]=a.useState([]),K=s(e=>e.user);a.useEffect(()=>{K?.id&&H()},[K?.id,q]);const H=async()=>{if(K?.id)try{A(!0);const{data:e,error:a}=await t.from("Order").select("*").eq("userId",K.id).eq("paymentStatus","PAID").not("shippingAddress","is",null);if(a)throw a;const s={};e?.forEach(e=>{const a=e.shippingAddress,t=a?.state||a?.uf||"BR",r="string"==typeof e.total?parseFloat(e.total):e.total;if(!s[t]){const e=z.find(e=>e.code===t)?.name||t;s[t]={state:t,stateName:e,orders:0,revenue:0,customers:0,avgTicket:0,conversionRate:0}}s[t].orders+=1,s[t].revenue+=r||0});const r=Object.values(s).map(e=>({...e,avgTicket:e.orders>0?e.revenue/e.orders:0}));r.sort((e,a)=>a.revenue-e.revenue),J(r)}catch(e){}finally{A(!1)}},Q=L.reduce((e,a)=>e+a.orders,0),V=L.reduce((e,a)=>e+a.revenue,0);L.reduce((e,a)=>e+a.customers,0);const W=Q>0?V/Q:0,X=L.slice(0,10),Y=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);return S?e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{className:"h-12 w-full"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((a,s)=>e.jsx(j,{className:"h-32"},s))}),e.jsx(j,{className:"h-96"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Público Alvo"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"Conheça quem está comprando seu produto"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(x,{value:q,onValueChange:I,children:[e.jsx(m,{className:"w-[180px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700",children:e.jsx(h,{placeholder:"Período"})}),e.jsxs(p,{children:[e.jsx(g,{value:"today",children:"Hoje"}),e.jsx(g,{value:"7days",children:"Últimos 7 dias"}),e.jsx(g,{value:"30days",children:"Últimos 30 dias"}),e.jsx(g,{value:"90days",children:"Últimos 90 dias"})]})]}),e.jsx(r,{variant:"outline",size:"icon",children:e.jsx(b,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx($,{title:"Total de Estados",value:L.length,icon:f,color:"bg-blue-500",delay:0}),e.jsx($,{title:"Total de Pedidos",value:Q,icon:N,color:"bg-green-500",delay:.1}),e.jsx($,{title:"Receita Total",value:Y(V),icon:v,color:"bg-purple-500",delay:.2}),e.jsx($,{title:"Ticket Médio",value:Y(W),icon:w,color:"bg-pink-500",delay:.3})]}),e.jsx(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.4},children:e.jsxs(d,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(i,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-yellow-500"}),"Top 10 Estados por Receita"]}),e.jsx(o,{children:"Estados com maior faturamento no período"})]}),e.jsxs(c,{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white border-0",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Top Performers"]})]})}),e.jsx(n,{children:X.length>0?e.jsx(T,{width:"100%",height:400,children:e.jsxs(E,{data:X,children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"#374151",opacity:.2}),e.jsx(C,{dataKey:"state",stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(B,{stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(F,{content:e.jsx(O,{})}),e.jsx(G,{dataKey:"revenue",radius:[8,8,0,0],children:X.map((a,s)=>e.jsx(D,{fill:`hsl(${36*s%360}, 70%, 50%)`},`cell-${s}`))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-500",children:[e.jsx(f,{className:"h-16 w-16 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-semibold",children:"Nenhum dado disponível"}),e.jsx("p",{className:"text-sm",children:"Aguardando pedidos com localização"})]})})]})}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},children:e.jsxs(d,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsxs(l,{children:[e.jsxs(i,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-blue-500"}),"Detalhamento por Estado"]}),e.jsx(o,{children:"Análise completa de todos os estados"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Pedidos"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Receita"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Ticket Médio"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"% do Total"})]})}),e.jsx("tbody",{children:L.map((a,s)=>e.jsxs(y.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.05*s},className:"border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xs",children:a.state}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.stateName})]})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsx(c,{variant:"outline",className:"font-mono",children:a.orders})}),e.jsx("td",{className:"px-4 py-4 text-right font-semibold text-green-600 dark:text-green-400",children:Y(a.revenue)}),e.jsx("td",{className:"px-4 py-4 text-right text-gray-900 dark:text-gray-300",children:Y(a.avgTicket)}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500",style:{width:`${(a.revenue/V*100).toFixed(0)}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400 w-12",children:[(a.revenue/V*100).toFixed(1),"%"]})]})})]},a.state))})]})}),0===L.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(f,{className:"h-16 w-16 mx-auto mb-4 text-gray-400 opacity-50"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhum dado de localização disponível"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Os pedidos precisam ter endereço de entrega cadastrado"})]})]})]})})]})};export{q as default};

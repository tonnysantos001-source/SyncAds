import{c as Q,r as l,f as se,u as ae,j as e,B as x,I as f,g,h as v,i as p,a3 as z,l as N,S as te,n as le}from"./index-qfmMwoGc.js";import{T as re,a as ie,b as F,c as h,d as ne,e as m}from"./table-RqHOwK4q.js";import{D as ce,f as oe,a as de,b as xe,c as he,e as me}from"./dialog-DGgbieAn.js";import{L as C}from"./label-DXSc73Fd.js";import{S as O,a as U,b as W,c as V,d as r}from"./select-XT9GLl1x.js";import{c as L}from"./customersApi-CQ8DZIdA.js";import{S as q}from"./skeleton-BppofXmM.js";import{P as B}from"./plus-DCIakEwJ.js";import{S as ue}from"./square-pen-60Rc0P15.js";import{T as je}from"./trash-2-DFet4Xfn.js";import"./index-B5sjPEbJ.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=Q("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=Q("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Se=()=>{const[n,R]=l.useState([]),[w,T]=l.useState([]),[P,G]=l.useState(!0),[o,M]=l.useState(""),[y,X]=l.useState("ALL"),[J,u]=l.useState(!1),[b,S]=l.useState(null),{toast:d}=se(),i=ae(s=>s.user),[a,c]=l.useState({name:"",email:"",phone:"",status:"NEW",source:""});l.useEffect(()=>{E()},[]),l.useEffect(()=>{K()},[o,y,n]);const E=async()=>{try{if(!(i!=null&&i.organizationId))return;const s=await L.leads.list(i.organizationId);R(s),T(s)}catch(s){d({title:"Erro ao carregar leads",description:s.message,variant:"destructive"})}finally{G(!1)}},K=()=>{let s=n;o&&(s=s.filter(t=>{var j,A,I;return((j=t.name)==null?void 0:j.toLowerCase().includes(o.toLowerCase()))||((A=t.email)==null?void 0:A.toLowerCase().includes(o.toLowerCase()))||((I=t.phone)==null?void 0:I.includes(o))})),y!=="ALL"&&(s=s.filter(t=>t.status===y)),T(s)},Y=async s=>{s.preventDefault();try{if(!(i!=null&&i.organizationId))return;b?(await L.leads.update(b.id,a),d({title:"Lead atualizado!"})):(await L.leads.create({...a,organizationId:i.organizationId}),d({title:"Lead criado!",description:"Novo lead adicionado com sucesso."})),u(!1),D(),E()}catch(t){d({title:"Erro",description:t.message,variant:"destructive"})}},Z=async s=>{if(confirm("Tem certeza que deseja deletar este lead?"))try{await L.leads.delete(s),d({title:"Lead deletado"}),E()}catch(t){d({title:"Erro ao deletar",description:t.message,variant:"destructive"})}},_=s=>{S(s),c({name:s.name||"",email:s.email||"",phone:s.phone||"",status:s.status||"NEW",source:s.source||""}),u(!0)},D=()=>{S(null),c({name:"",email:"",phone:"",status:"NEW",source:""})},$=s=>{const t={NEW:{variant:"secondary",label:"Novo"},CONTACTED:{variant:"default",label:"Contatado"},QUALIFIED:{variant:"default",label:"Qualificado"},CONVERTED:{variant:"default",label:"Convertido"}},j=t[s]||t.NEW;return e.jsx(le,{variant:j.variant,children:j.label})},ee=n.filter(s=>s.status==="NEW").length,k=n.filter(s=>s.status==="CONVERTED").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Leads"}),e.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus leads e contatos"})]}),e.jsxs(ce,{open:J,onOpenChange:u,children:[e.jsx(oe,{asChild:!0,children:e.jsxs(x,{onClick:D,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Adicionar Lead"]})}),e.jsxs(de,{children:[e.jsx(xe,{children:e.jsx(he,{children:b?"Editar Lead":"Novo Lead"})}),e.jsxs("form",{onSubmit:Y,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Nome Completo"}),e.jsx(f,{value:a.name,onChange:s=>c({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"E-mail"}),e.jsx(f,{type:"email",value:a.email,onChange:s=>c({...a,email:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Telefone"}),e.jsx(f,{value:a.phone,onChange:s=>c({...a,phone:s.target.value}),placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Status"}),e.jsxs(O,{value:a.status,onValueChange:s=>c({...a,status:s}),children:[e.jsx(U,{children:e.jsx(W,{})}),e.jsxs(V,{children:[e.jsx(r,{value:"NEW",children:"Novo"}),e.jsx(r,{value:"CONTACTED",children:"Contatado"}),e.jsx(r,{value:"QUALIFIED",children:"Qualificado"}),e.jsx(r,{value:"CONVERTED",children:"Convertido"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Origem"}),e.jsx(f,{value:a.source,onChange:s=>c({...a,source:s.target.value}),placeholder:"Ex: Facebook, Google Ads..."})]})]}),e.jsxs(me,{className:"mt-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>u(!1),children:"Cancelar"}),e.jsx(x,{type:"submit",children:b?"Atualizar":"Criar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Total de Leads"}),e.jsx(z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl font-bold",children:n.length})})]}),e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Novos"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl font-bold",children:ee})})]}),e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Convertidos"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl font-bold",children:k})})]}),e.jsxs(g,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Taxa de Conversão"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(N,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[n.length>0?(k/n.length*100).toFixed(1):0,"%"]})})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(te,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(f,{placeholder:"Buscar leads...",value:o,onChange:s=>M(s.target.value),className:"pl-9"})]}),e.jsxs(O,{value:y,onValueChange:X,children:[e.jsx(U,{className:"w-48",children:e.jsx(W,{placeholder:"Filtrar por status"})}),e.jsxs(V,{children:[e.jsx(r,{value:"ALL",children:"Todos os Status"}),e.jsx(r,{value:"NEW",children:"Novos"}),e.jsx(r,{value:"CONTACTED",children:"Contatados"}),e.jsx(r,{value:"QUALIFIED",children:"Qualificados"}),e.jsx(r,{value:"CONVERTED",children:"Convertidos"})]})]})]}),e.jsxs(g,{children:[e.jsx(v,{children:e.jsx(p,{children:"Lista de Leads"})}),e.jsx(N,{children:P?e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{className:"h-12 w-full"}),e.jsx(q,{className:"h-12 w-full"})]}):w.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhum lead encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Comece adicionando o primeiro lead"}),e.jsxs(x,{onClick:()=>u(!0),children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Adicionar Primeiro Lead"]})]}):e.jsxs(re,{children:[e.jsx(ie,{children:e.jsxs(F,{children:[e.jsx(h,{children:"Nome"}),e.jsx(h,{children:"E-mail"}),e.jsx(h,{children:"Telefone"}),e.jsx(h,{children:"Origem"}),e.jsx(h,{children:"Status"}),e.jsx(h,{className:"text-right",children:"Ações"})]})}),e.jsx(ne,{children:w.map(s=>e.jsxs(F,{children:[e.jsx(m,{className:"font-medium",children:s.name}),e.jsx(m,{children:s.email}),e.jsx(m,{className:"text-sm text-muted-foreground",children:s.phone||"-"}),e.jsx(m,{className:"text-sm text-muted-foreground",children:s.source||"-"}),e.jsx(m,{children:$(s.status)}),e.jsx(m,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>_(s),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>Z(s.id),children:e.jsx(je,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})};export{Se as default};

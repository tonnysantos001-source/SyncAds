import{e as B,f as I,r as m,s as j,j as e,B as f,g as i,h as c,i as d,l as o,am as b,k as P,a8 as D,I as U,n as z}from"./index-DKyyon9m.js";import{T as _,a as H,b as p,e as l,c as V,d as r}from"./table-D6uiYHf6.js";import{S as N}from"./SuperAdminLayout-y9gva4ZH.js";import{P as q}from"./plus-C-xQBfxh.js";import{B as F}from"./building-2-Cmx-G2tz.js";import{T as O}from"./trending-up-CZKJws-s.js";import{C as $}from"./calendar-CaL1kY5z.js";import"./Logo-D6EfprG9.js";import"./message-square-Dxun95XH.js";import"./dollar-sign-BuSPoHah.js";function ae(){const v=B(),{toast:C}=I(),[n,y]=m.useState([]),[u,w]=m.useState(""),[T,E]=m.useState(!0);m.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:s,error:a}=await j.from("Organization").select("*").order("createdAt",{ascending:!1});if(a)throw a;const t=await Promise.all((s||[]).map(async h=>{const{count:L}=await j.from("User").select("*",{count:"exact",head:!0}).eq("organizationId",h.id),{count:R}=await j.from("Campaign").select("*",{count:"exact",head:!0}).eq("organizationId",h.id);return{...h,_count:{users:L||0,campaigns:R||0}}}));y(t)}catch(s){C({title:"Erro ao carregar clientes",description:s.message,variant:"destructive"})}finally{E(!1)}},g=n.filter(s=>s.name.toLowerCase().includes(u.toLowerCase())||s.slug.toLowerCase().includes(u.toLowerCase())),k=s=>{const a={ACTIVE:{variant:"default",label:"Ativo"},TRIAL:{variant:"secondary",label:"Trial"},SUSPENDED:{variant:"destructive",label:"Suspenso"},CANCELLED:{variant:"outline",label:"Cancelado"}},t=a[s]||a.TRIAL;return e.jsx(z,{variant:t.variant,children:t.label})},A=s=>{const a={FREE:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100",STARTER:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",PRO:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",ENTERPRISE:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${a[s]||a.FREE}`,children:s})},x={total:n.length,active:n.filter(s=>s.status==="ACTIVE").length,trial:n.filter(s=>s.status==="TRIAL").length,totalUsers:n.reduce((s,a)=>{var t;return s+(((t=a._count)==null?void 0:t.users)||0)},0)};return T?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsx(N,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Clientes"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Gerencie todas as organizações cadastradas"})]}),e.jsxs(f,{className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600",onClick:()=>{},children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Novo Cliente"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total de Clientes"}),e.jsx(F,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Todas organizações"})]})]}),e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Clientes Ativos"}),e.jsx(O,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x.active}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Com plano ativo"})]})]}),e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Em Trial"}),e.jsx($,{className:"h-4 w-4 text-amber-600"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x.trial}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Período de teste"})]})]}),e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Total de Usuários"}),e.jsx(b,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x.totalUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Em todos os clientes"})]})]})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(d,{children:"Todos os Clientes"}),e.jsx(P,{children:"Lista completa de organizações cadastradas"})]})})}),e.jsxs(o,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(U,{placeholder:"Buscar por nome ou slug...",value:u,onChange:s=>w(s.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(_,{children:[e.jsx(H,{children:e.jsxs(p,{children:[e.jsx(l,{children:"Cliente"}),e.jsx(l,{children:"Plano"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Usuários"}),e.jsx(l,{children:"Campanhas"}),e.jsx(l,{children:"Criado em"}),e.jsx(l,{children:"Ações"})]})}),e.jsx(V,{children:g.length===0?e.jsx(p,{children:e.jsx(r,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Nenhum cliente encontrado"})}):g.map(s=>{var a,t;return e.jsxs(p,{children:[e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.slug})]})}),e.jsx(r,{children:A(s.plan)}),e.jsx(r,{children:k(s.status)}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:((a=s._count)==null?void 0:a.users)||0})]})}),e.jsx(r,{children:((t=s._count)==null?void 0:t.campaigns)||0}),e.jsx(r,{className:"text-sm text-gray-600",children:new Date(s.createdAt).toLocaleDateString("pt-BR")}),e.jsx(r,{children:e.jsx(f,{size:"sm",variant:"outline",onClick:()=>v(`/super-admin/clients/${s.id}`),children:"Ver Detalhes"})})]},s.id)})})]})})]})]})]})})}export{ae as default};

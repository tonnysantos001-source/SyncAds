import{a2 as h,e as u,r as n,j as e,t as w,w as b}from"./index-CHFmmF5o.js";import{i as p,I as j}from"./integrationsService-Cb0k05Kr.js";import{C as f}from"./circle-x-BElKievs.js";function S(){const[t]=h(),a=u(),[r,l]=n.useState("loading"),[c,i]=n.useState("Processing your connection...");return n.useEffect(()=>{(async()=>{try{const s=t.get("code"),o=t.get("state"),m=t.get("error");if(m)throw new Error(m);if(!s||!o)throw new Error("Missing code or state parameter");const d=await p.handleOAuthCallback(s,o),g=j[d.slug];l("success"),i(`${g.name} connected successfully!`);const x=JSON.parse(atob(o));localStorage.setItem(`oauth_success_${x.platform}_${x.userId}`,"true"),setTimeout(()=>{window.opener?window.close():a("/chat")},2e3)}catch(s){console.error("OAuth callback error:",s),l("error"),i(s.message||"Failed to connect integration"),setTimeout(()=>{window.opener?window.close():a("/chat")},3e3)}})()},[t,a]),e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md",children:[r==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-16 w-16 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Processing..."}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:c})]}),r==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold mb-2 text-green-600",children:"Success!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:c}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Closing this window..."})]}),r==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-16 w-16 text-red-600 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold mb-2 text-red-600",children:"Error"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:c}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Redirecting..."})]})]})})}export{S as IntegrationCallbackPage};

import{f as z,r as i,s,C as E,j as a,aH as d,v as u,g as O,l as U,B as m}from"./index-DmvaoOhF.js";import{M as P}from"./monitor-Du2rjkpZ.js";import{D as A}from"./dollar-sign-BDnu9lAt.js";import{T as B}from"./truck-DIR0P9yF.js";import{C as D}from"./circle-check-BOnznEN6.js";function H(){var n,o;const{toast:h}=z(),[r,g]=i.useState(null),[G,x]=i.useState(null),[p,f]=i.useState([]),[b,j]=i.useState(!0);i.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:{user:e}}=await s.auth.getUser();if(!e)return;g(e);const{data:t}=await s.from("User").select("organizationId").eq("id",e.id).single();t!=null&&t.organizationId&&(x(t.organizationId),await v(t.organizationId))}catch(e){console.error("Erro ao carregar dados:",e)}finally{j(!1)}},v=async e=>{try{const[t,c,q,l]=await Promise.all([w(e),N(e),k(e),S(e)]);f([{id:"billing",title:"Faturamento",description:"Adicione um cartão de crédito em sua conta",icon:E,status:t?"completed":"pending",route:"/settings?tab=billing"},{id:"domain",title:"Domínio",description:"Verifique seu domínio. Deve ser o mesmo utilizado na Shopify, WooCommerce ou na sua landing page.",icon:P,status:c?"completed":"pending",route:"/checkout/domain"},{id:"gateway",title:"Gateway",description:"Configure os meios de pagamentos que serão exibidos em sua loja.",icon:A,status:q?"completed":"pending",route:"/checkout/gateways"},{id:"shipping",title:"Frete",description:"Crie métodos de entrega para ser exibido no seu checkout.",icon:B,status:l?"completed":"pending",route:"/checkout/shipping"}])}catch(t){console.error("Erro ao carregar status:",t)}},w=async e=>{try{const{data:t}=await s.from("Organization").select("subscriptionId, stripeCustomerId").eq("id",e).single();return!!(t!=null&&t.subscriptionId&&(t!=null&&t.stripeCustomerId))}catch{return!1}},N=async e=>{try{const{data:t}=await s.from("Organization").select("domain, domainVerified").eq("id",e).single();return!!(t!=null&&t.domain&&(t!=null&&t.domainVerified))}catch{return!1}},k=async e=>{try{const{data:t}=await s.from("GatewayConfig").select("id, isActive").eq("organizationId",e).eq("isActive",!0).limit(1);return((t==null?void 0:t.length)||0)>0}catch{return!1}},S=async e=>{try{const{data:t}=await s.from("ShippingMethod").select("id").eq("organizationId",e).limit(1);return((t==null?void 0:t.length)||0)>0}catch{return!1}},C=e=>{switch(e){case"completed":return a.jsx(D,{className:"h-5 w-5 text-green-500"});case"active":return a.jsx(u,{className:"h-5 w-5 text-blue-500 animate-spin"});default:return a.jsx("div",{className:"h-5 w-5 rounded-full bg-gray-300"})}},I=e=>{switch(e){case"completed":return"bg-green-100 border-green-500";case"active":return"bg-blue-100 border-blue-500";default:return"bg-gray-50 border-gray-300"}};return b?a.jsx(d,{children:a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(u,{className:"h-8 w-8 animate-spin text-gray-400"})})}):a.jsxs(d,{children:[a.jsxs("div",{className:"p-6 sm:p-8 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["Olá ",(o=(n=r==null?void 0:r.email)==null?void 0:n.split("@")[0])==null?void 0:o.split(".")[0],","]}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 mt-2",children:"Seja bem vindo"})]}),a.jsx("div",{className:"mb-8",children:a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Para ativar seu checkout você precisa concluir todos passos abaixo:"})}),a.jsx("div",{className:"space-y-4",children:p.map((e,t)=>a.jsx(O,{className:`border-2 transition-all ${I(e.status)}`,children:a.jsxs(U,{className:"p-6",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsx("div",{className:`rounded-lg p-3 ${e.status==="completed"?"bg-green-100":e.status==="active"?"bg-blue-100":"bg-gray-100"}`,children:a.jsx(e.icon,{className:`h-6 w-6 ${e.status==="completed"?"text-green-600":e.status==="active"?"text-blue-600":"text-gray-400"}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:e.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-4",children:C(e.status)})]}),e.route&&a.jsx("div",{className:"mt-4",children:a.jsx(m,{variant:e.status==="completed"?"outline":"default",className:"w-full",onClick:()=>{e.route&&(window.location.href=e.route)},children:e.status==="completed"?"Configurar":"Configurar agora"})})]})},e.id))}),a.jsxs("div",{className:"mt-8 text-center text-sm text-gray-600 dark:text-gray-400",children:["Caso tenha alguma dúvida, visite nossa"," ",a.jsx("a",{href:"/help",className:"underline hover:text-gray-900 dark:hover:text-white",children:"central de ajuda"}),"."]})]}),a.jsx("div",{className:"fixed bottom-6 right-6",children:a.jsx(m,{className:"rounded-full bg-pink-500 hover:bg-pink-600 text-white shadow-lg",onClick:()=>h({title:"Em construção",description:"Chat de ajuda em breve!"}),children:"Precisa de ajuda?"})})]})}export{H as default};

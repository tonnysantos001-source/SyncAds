import{s as t}from"./index-bJzi6YSI.js";const r={async list(r){try{let e=t.from("Product").select("*, Category(*)").order("createdAt",{ascending:!1});r?.status&&(e=e.eq("status",r.status)),r?.categoryId&&(e=e.eq("categoryId",r.categoryId)),r?.search&&(e=e.or(`name.ilike.%${r.search}%,sku.ilike.%${r.search}%`));const{data:a,error:s}=await e;if(s)throw s;return a}catch(e){throw e}},async listFromShopify(r,e){try{let a=t.from("ShopifyProduct").select("*").eq("userId",r).order("updatedAt",{ascending:!1});e?.status&&(a=a.eq("status",e.status)),e?.search&&(a=a.or(`title.ilike.%${e.search}%,handle.ilike.%${e.search}%`));const{data:s,error:o}=await a;if(o)throw o;return(s||[]).map(t=>({id:String(t.id),userId:t.userId,name:t.title,slug:t.handle,description:t.description,shortDescription:t.description?.substring(0,200),price:t.shopifyData?.variants?.[0]?.price||0,comparePrice:t.shopifyData?.variants?.[0]?.compare_at_price||0,sku:t.shopifyData?.variants?.[0]?.sku||"",stock:t.totalInventory||0,lowStockThreshold:10,trackStock:!0,status:"active"===t.status?"ACTIVE":"draft"===t.status?"DRAFT":"ARCHIVED",isFeatured:!1,tags:t.tags||[],metadata:{shopifyId:t.id,shopifyData:t.shopifyData,images:t.images,vendor:t.vendor,productType:t.productType},createdAt:t.createdAt,updatedAt:t.updatedAt}))}catch(a){throw a}},async getById(r){try{const{data:e,error:a}=await t.from("Product").select("*, Category(*), ProductVariant(*), ProductImage(*)").eq("id",r).single();if(a)throw a;return e}catch(e){throw e}},async create(r){try{const{data:e,error:a}=await t.from("Product").insert(r).select().single();if(a)throw a;return e}catch(e){throw e}},async update(r,e){try{const{data:a,error:s}=await t.from("Product").update({...e,updatedAt:(new Date).toISOString()}).eq("id",r).select().single();if(s)throw s;return a}catch(a){throw a}},async delete(r){try{const{error:e}=await t.from("Product").delete().eq("id",r);if(e)throw e}catch(e){throw e}},async updateStock(r,e){try{const{data:a,error:s}=await t.from("Product").update({stock:e,updatedAt:(new Date).toISOString()}).eq("id",r).select().single();if(s)throw s;return a}catch(a){throw a}}};export{r as p};

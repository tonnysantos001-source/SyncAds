import{u as I,r as C,s as P,j as e,B as m,W as T,g as s,l as a,ag as u,h as j,i as p}from"./index-ByzMTT6f.js";import{S as o}from"./skeleton-B8cQu1Cs.js";import{C as k}from"./calendar-DZu7fVU5.js";const E=()=>{const x=I(r=>r.user),[c,N]=C.useState({totalRevenue:0,totalOrders:0,approvedRevenue:0,refundedRevenue:0,netProfit:0,totalShipping:0,avgTicket:0,conversionRate:0,loading:!0});C.useEffect(()=>{x!=null&&x.organizationId&&A()},[x==null?void 0:x.organizationId]);const n=r=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r),A=async()=>{try{N(t=>({...t,loading:!0}));const r=x==null?void 0:x.organizationId,[{data:l},{data:i}]=await Promise.all([P.from("Order").select("total, status, shippingCost").eq("organizationId",r),P.from("Transaction").select("amount, status, paymentMethod").eq("organizationId",r)]);console.log("📊 [Reports] Dados carregados:",{orders:l,transactions:i});const g=(l==null?void 0:l.filter(t=>t.status==="PAID").reduce((t,d)=>t+(d.total||0),0))||0,h=(l==null?void 0:l.length)||0,f=(l==null?void 0:l.filter(t=>t.status==="PAID").length)||0,v=(i==null?void 0:i.filter(t=>t.status==="PAID").reduce((t,d)=>t+(d.amount||0),0))||0,y=(i==null?void 0:i.filter(t=>t.status==="REFUNDED").reduce((t,d)=>t+(d.amount||0),0))||0,z=(l==null?void 0:l.filter(t=>t.status==="PAID").reduce((t,d)=>t+(d.shippingCost||0),0))||0,b=f>0?g/f:0,R=h>0?f/h*100:0,w=v-y;N({totalRevenue:g,totalOrders:h,approvedRevenue:v,refundedRevenue:y,netProfit:w,totalShipping:z,avgTicket:b,conversionRate:R,loading:!1}),console.log("✅ [Reports] Métricas calculadas:",{totalRevenue:n(g),totalOrders:h,netProfit:n(w),avgTicket:n(b),conversionRate:R.toFixed(2)+"%"})}catch(r){console.error("❌ [Reports] Erro ao carregar dados:",r),N(l=>({...l,loading:!1}))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"VISÃO GERAL"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Acompanhe o desempenho geral do seu e-commerce"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Atualizar"]}),e.jsx(m,{className:"bg-pink-600 hover:bg-pink-700 text-white",size:"sm",children:"Filtrar"}),e.jsx(m,{variant:"outline",size:"sm",children:"Colection"}),e.jsx(m,{variant:"outline",size:"sm",children:"Semana"}),e.jsx(m,{variant:"outline",size:"sm",children:"Mês"}),e.jsx(m,{variant:"outline",size:"sm",children:e.jsx(k,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(s,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Receita líquida"}),c.loading?e.jsx(o,{className:"h-9 w-32"}):e.jsxs("p",{className:"text-3xl font-bold",children:[n(c.totalRevenue)," (",c.totalOrders,")"]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:c.loading?e.jsx(o,{className:"h-4 w-12"}):e.jsxs("span",{className:"text-gray-500",children:["Aprovados: ",c.totalOrders," pedidos"]})})]})})}),e.jsx(s,{className:"bg-gray-900 text-white",children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-300",children:"Lucro Líquido"}),c.loading?e.jsx(o,{className:"h-9 w-24"}):e.jsx("p",{className:"text-3xl font-bold",children:n(c.netProfit)}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:c.loading?e.jsx(o,{className:"h-4 w-12"}):e.jsxs("span",{className:"text-gray-400",children:["Aprovado: ",n(c.approvedRevenue)]})})]})})}),e.jsx(s,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ticket Médio"}),e.jsx(u,{className:"w-4 h-4 text-gray-400"})]}),c.loading?e.jsx(o,{className:"h-9 w-24"}):e.jsx("p",{className:"text-3xl font-bold",children:n(c.avgTicket)}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:c.loading?e.jsx(o,{className:"h-4 w-12"}):e.jsxs("span",{className:"text-gray-500",children:["Conversão: ",c.conversionRate.toFixed(1),"%"]})})]})})})]}),e.jsxs(s,{children:[e.jsx(j,{children:e.jsx(p,{className:"text-lg",children:"Resumo Financeiro"})}),e.jsx(a,{children:e.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50 rounded",children:e.jsx("p",{className:"text-gray-400",children:"Gráfico de linha - Receita por período"})})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Receita Aprovada"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00 (0)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"% 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Receita Estornada"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00 (0)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"% 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Compra / Dia"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Pedidos"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00 (0)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"% 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Frete"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Custo p/o"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Margem Líquida"}),e.jsx("p",{className:"text-xl font-bold",children:"0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Lucro Real"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Ticket médio"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Lucratividade"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"})," Mais de meta"]})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Meta de ROAS"}),e.jsx("p",{className:"text-xl font-bold",children:"0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Novo de ROAS"}),e.jsx("p",{className:"text-xl font-bold flex items-center gap-1",children:e.jsx(u,{className:"w-3 h-3"})})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Tax. de Conversão"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Roas"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"}),e.jsx("p",{className:"text-xs text-gray-500",children:"— 0%"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Roi"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"})]})}),e.jsx(s,{children:e.jsxs(a,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"CPA"}),e.jsx("p",{className:"text-xl font-bold",children:"0,00"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(s,{children:[e.jsx(j,{children:e.jsx(p,{className:"text-lg",children:"Funnel de Conversão"})}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"UTM's Utilizadas"}),e.jsx("p",{className:"text-2xl font-bold",children:"0% (0)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"Entrega"}),e.jsx("p",{className:"text-2xl font-bold",children:"0% (0)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"Pagamento"}),e.jsx("p",{className:"text-2xl font-bold",children:"0% (0)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"Comprou"}),e.jsx("p",{className:"text-2xl font-bold",children:"0% (0)"})]})]})})]}),e.jsxs(s,{children:[e.jsx(j,{children:e.jsx(p,{className:"text-lg",children:"Taxas"})}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Pix"}),e.jsx("span",{className:"font-medium",children:"0%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Boleto"}),e.jsx("span",{className:"font-medium",children:"0%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Cartão crédito"}),e.jsx("span",{className:"font-medium",children:"0%"})]})]})})]})]}),e.jsxs(s,{children:[e.jsx(j,{children:e.jsx(p,{className:"text-lg",children:"Parcelamento"})}),e.jsx(a,{children:e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Não existem informações para os critérios selecionados"})})]})]})};export{E as default};

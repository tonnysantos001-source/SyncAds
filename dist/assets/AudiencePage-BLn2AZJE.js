import{c as M,r as y,u as U,s as H,j as e,M as m,B as J,d as k,e as S,f as A,g as P,n as E,h as T}from"./index-koz9QZbf.js";import{S as K,a as V,b as X,c as Y,d as u}from"./select-e_4I_YyD.js";import{S as v}from"./skeleton-Cw6XLVyS.js";import{G as _}from"./globe-CKUdPaIh.js";import{D as Z}from"./download-BooHpXX9.js";import{M as w}from"./map-pin-Dfu62VYo.js";import{S as B}from"./shopping-bag-cKPz38_2.js";import{D}from"./dollar-sign-Ol26gPiy.js";import{T as Q}from"./target-B5qKcEtc.js";import{E as W}from"./eye-BSKIwt9o.js";import{p as ee,B as G,X as F,Y as $,q as ae,R as te,C as se,T as re,o as ie}from"./generateCategoricalChart-CGPj9NIt.js";import{T as oe}from"./trending-up-pITUHt8h.js";import{U as le}from"./users-BrKkHow-.js";import"./index-DbfKBMqd.js";import"./chevron-up-D0jndD3b.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=M("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=M("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var ce=ee({chartName:"BarChart",GraphicalChild:G,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:F},{axisType:"yAxis",AxisComp:$}],formatAxisMap:ae});const j=({title:n,value:r,icon:p,color:c,change:s,delay:f=0})=>e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:f},children:e.jsxs(k,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${c} opacity-10 rounded-full blur-3xl`}),e.jsxs(S,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:n}),e.jsx("div",{className:`p-2 rounded-lg ${c} bg-opacity-10`,children:e.jsx(p,{className:`h-4 w-4 ${c.replace("bg-","text-")}`})})]}),e.jsxs(T,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:r}),s!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(oe,{className:`h-4 w-4 ${s>=0?"text-green-500":"text-red-500"}`}),e.jsxs("span",{className:`text-sm font-semibold ${s>=0?"text-green-500":"text-red-500"}`,children:[Math.abs(s).toFixed(1),"%"]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"vs último período"})]})]})]})}),xe=[{code:"AC",name:"Acre"},{code:"AL",name:"Alagoas"},{code:"AP",name:"Amapá"},{code:"AM",name:"Amazonas"},{code:"BA",name:"Bahia"},{code:"CE",name:"Ceará"},{code:"DF",name:"Distrito Federal"},{code:"ES",name:"Espírito Santo"},{code:"GO",name:"Goiás"},{code:"MA",name:"Maranhão"},{code:"MT",name:"Mato Grosso"},{code:"MS",name:"Mato Grosso do Sul"},{code:"MG",name:"Minas Gerais"},{code:"PA",name:"Pará"},{code:"PB",name:"Paraíba"},{code:"PR",name:"Paraná"},{code:"PE",name:"Pernambuco"},{code:"PI",name:"Piauí"},{code:"RJ",name:"Rio de Janeiro"},{code:"RN",name:"Rio Grande do Norte"},{code:"RS",name:"Rio Grande do Sul"},{code:"RO",name:"Rondônia"},{code:"RR",name:"Roraima"},{code:"SC",name:"Santa Catarina"},{code:"SP",name:"São Paulo"},{code:"SE",name:"Sergipe"},{code:"TO",name:"Tocantins"}],me=({active:n,payload:r})=>n&&r&&r.length?e.jsxs("div",{className:"bg-gray-900/95 dark:bg-gray-800/95 backdrop-blur-xl border border-gray-700 rounded-lg p-4 shadow-xl",children:[e.jsx("p",{className:"text-white font-semibold mb-2",children:r[0].payload.stateName}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(B,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-gray-300",children:"Pedidos:"}),e.jsx("span",{className:"text-white font-semibold",children:r[0].payload.orders})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-gray-300",children:"Receita:"}),e.jsxs("span",{className:"text-white font-semibold",children:["R$"," ",r[0].value.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(le,{className:"h-4 w-4 text-purple-400"}),e.jsx("span",{className:"text-gray-300",children:"Clientes:"}),e.jsx("span",{className:"text-white font-semibold",children:r[0].payload.customers})]})]})]}):null,Ce=()=>{const[n,r]=y.useState(!0),[p,c]=y.useState("7days"),[s,f]=y.useState([]),o=U(a=>a.user);y.useEffect(()=>{o!=null&&o.id&&I()},[o==null?void 0:o.id,p]);const I=async()=>{if(o!=null&&o.id)try{r(!0);const{data:a,error:t}=await H.from("Order").select("*").eq("userId",o.id).eq("paymentStatus","PAID").not("shippingAddress","is",null);if(t)throw t;const x={};a==null||a.forEach(i=>{var R;const l=i.shippingAddress,d=(l==null?void 0:l.state)||(l==null?void 0:l.uf)||"BR",z=typeof i.total=="string"?parseFloat(i.total):i.total;if(!x[d]){const L=((R=xe.find(q=>q.code===d))==null?void 0:R.name)||d;x[d]={state:d,stateName:L,orders:0,revenue:0,customers:0,avgTicket:0,conversionRate:0}}x[d].orders+=1,x[d].revenue+=z||0});const C=Object.values(x).map(i=>({...i,avgTicket:i.orders>0?i.revenue/i.orders:0}));C.sort((i,l)=>l.revenue-i.revenue),f(C)}catch(a){console.error("Erro ao carregar dados de audiência:",a)}finally{r(!1)}},b=s.reduce((a,t)=>a+t.orders,0),h=s.reduce((a,t)=>a+t.revenue,0);s.reduce((a,t)=>a+t.customers,0);const O=b>0?h/b:0,N=s.slice(0,10),g=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a);return n?e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{className:"h-12 w-full"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((a,t)=>e.jsx(v,{className:"h-32"},t))}),e.jsx(v,{className:"h-96"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Público Alvo"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Conheça quem está comprando seu produto"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{value:p,onValueChange:c,children:[e.jsx(V,{className:"w-[180px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700",children:e.jsx(X,{placeholder:"Período"})}),e.jsxs(Y,{children:[e.jsx(u,{value:"today",children:"Hoje"}),e.jsx(u,{value:"7days",children:"Últimos 7 dias"}),e.jsx(u,{value:"30days",children:"Últimos 30 dias"}),e.jsx(u,{value:"90days",children:"Últimos 90 dias"})]})]}),e.jsx(J,{variant:"outline",size:"icon",children:e.jsx(Z,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(j,{title:"Total de Estados",value:s.length,icon:w,color:"bg-blue-500",delay:0}),e.jsx(j,{title:"Total de Pedidos",value:b,icon:B,color:"bg-green-500",delay:.1}),e.jsx(j,{title:"Receita Total",value:g(h),icon:D,color:"bg-purple-500",delay:.2}),e.jsx(j,{title:"Ticket Médio",value:g(O),icon:Q,color:"bg-pink-500",delay:.3})]}),e.jsx(m.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.4},children:e.jsxs(k,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-yellow-500"}),"Top 10 Estados por Receita"]}),e.jsx(P,{children:"Estados com maior faturamento no período"})]}),e.jsxs(E,{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white border-0",children:[e.jsx(W,{className:"h-3 w-3 mr-1"}),"Top Performers"]})]})}),e.jsx(T,{children:N.length>0?e.jsx(te,{width:"100%",height:400,children:e.jsxs(ce,{data:N,children:[e.jsx(se,{strokeDasharray:"3 3",stroke:"#374151",opacity:.2}),e.jsx(F,{dataKey:"state",stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx($,{stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(re,{content:e.jsx(me,{})}),e.jsx(G,{dataKey:"revenue",radius:[8,8,0,0],children:N.map((a,t)=>e.jsx(ie,{fill:`hsl(${t*36%360}, 70%, 50%)`},`cell-${t}`))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-500",children:[e.jsx(w,{className:"h-16 w-16 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-semibold",children:"Nenhum dado disponível"}),e.jsx("p",{className:"text-sm",children:"Aguardando pedidos com localização"})]})})]})}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},children:e.jsxs(k,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsxs(S,{children:[e.jsxs(A,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-blue-500"}),"Detalhamento por Estado"]}),e.jsx(P,{children:"Análise completa de todos os estados"})]}),e.jsxs(T,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Pedidos"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Receita"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Ticket Médio"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"% do Total"})]})}),e.jsx("tbody",{children:s.map((a,t)=>e.jsxs(m.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:t*.05},className:"border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xs",children:a.state}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.stateName})]})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsx(E,{variant:"outline",className:"font-mono",children:a.orders})}),e.jsx("td",{className:"px-4 py-4 text-right font-semibold text-green-600 dark:text-green-400",children:g(a.revenue)}),e.jsx("td",{className:"px-4 py-4 text-right text-gray-900 dark:text-gray-300",children:g(a.avgTicket)}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500",style:{width:`${(a.revenue/h*100).toFixed(0)}%`}})}),e.jsxs("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400 w-12",children:[(a.revenue/h*100).toFixed(1),"%"]})]})})]},a.state))})]})}),s.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"h-16 w-16 mx-auto mb-4 text-gray-400 opacity-50"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhum dado de localização disponível"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Os pedidos precisam ter endereço de entrega cadastrado"})]})]})]})})]})};export{Ce as default};

import{u as S,a as P,r as n,j as e,s,d as c,e as q,f as A,h as l,l as g,B as G}from"./index-CESLwo8P.js";import{P as I}from"./progress-7g1hEdW4.js";import{C as B}from"./credit-card-C4gW_cRl.js";import{G as E}from"./globe-DkbMMU9A.js";import{W as O}from"./wallet-DZr1R5Ql.js";import{T as V}from"./truck-AkGyB2qd.js";import{C as T}from"./circle-check-DX_nkokt.js";import{A as W}from"./arrow-right-4sosib5M.js";import{C as F}from"./circle-help-DfwbtBJ5.js";function Q(){var h;const a=S(t=>t.user),o=P(),[i,u]=n.useState([]),[p,f]=n.useState(!0);n.useEffect(()=>{a!=null&&a.id&&j()},[a==null?void 0:a.id]);const j=async()=>{if(a!=null&&a.id)try{const[t,r,v,C]=await Promise.all([b(),y(),N(),k()]);u([{id:"billing",title:"Faturamento",description:"Configure seu plano e método de pagamento",completed:t,route:"/billing",icon:e.jsx(B,{className:"h-5 w-5"})},{id:"domain",title:"Domínio",description:"Verifique seu domínio (mesmo da Shopify/WooCommerce)",completed:r,route:"/checkout/domain",icon:e.jsx(E,{className:"h-5 w-5"})},{id:"gateway",title:"Gateway de Pagamento",description:"Configure os meios de pagamento",completed:v,route:"/checkout/gateways",icon:e.jsx(O,{className:"h-5 w-5"})},{id:"shipping",title:"Frete",description:"Crie métodos de entrega",completed:C,route:"/checkout/shipping",icon:e.jsx(V,{className:"h-5 w-5"})}])}catch(t){console.error("Erro ao carregar status:",t)}finally{f(!1)}},b=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:t}=await s.from("User").select("currentPlanId").eq("id",a.id).single();if(t!=null&&t.currentPlanId)return!0;const{data:r}=await s.from("Subscription").select("id, status").eq("userId",a.id).eq("status","active").single();return!!r}catch{return!1}},y=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:t}=await s.from("User").select("domain, domainVerified").eq("id",a.id).single();return!!(t!=null&&t.domain&&(t!=null&&t.domainVerified))}catch{return!1}},N=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:t}=await s.from("GatewayConfig").select("id").eq("userId",a.id).eq("isActive",!0).limit(1);return((t==null?void 0:t.length)||0)>0}catch{return!1}},k=async()=>{if(!(a!=null&&a.id))return!1;try{const{data:t}=await s.from("ShippingMethod").select("id").eq("userId",a.id).limit(1);return((t==null?void 0:t.length)||0)>0}catch{return!1}};if(p)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Carregando..."})]})});const w=(a==null?void 0:a.name)||((h=a==null?void 0:a.email)==null?void 0:h.split("@")[0])||"usuário",d=i.filter(t=>t.completed).length,m=i.length,x=d/m*100;return e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-6 md:p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:["Olá, ",w,"!"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Complete as etapas abaixo para ativar seu checkout"})]}),e.jsxs(c,{className:"mb-6",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{className:"text-lg font-semibold",children:"Progresso do Onboarding"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d," de ",m," concluídos"]})]})}),e.jsxs(l,{children:[e.jsx(I,{value:x,className:"h-2"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:x===100?"Parabéns! Você concluiu todas as etapas.":"Continue configurando para ativar seu checkout."})]})]}),e.jsx("div",{className:"space-y-4 mb-6",children:i.map((t,r)=>e.jsx(c,{className:"cursor-pointer hover:border-blue-500 transition-colors",onClick:()=>o(t.route),children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-lg flex items-center justify-center ${t.completed?"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}`,children:t.completed?e.jsx(T,{className:"h-6 w-6"}):t.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t.title}),t.completed?e.jsx(g,{variant:"secondary",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",children:"Concluído"}):e.jsx(g,{variant:"outline",className:"text-gray-600",children:"Pendente"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.description})]}),e.jsx(W,{className:"flex-shrink-0 h-5 w-5 text-gray-400"})]})})},t.id))}),e.jsx(c,{className:"border-dashed",children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(F,{className:"h-5 w-5 text-blue-600 dark:text-blue-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Precisa de ajuda?"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Nossa central de ajuda está disponível para tirar suas dúvidas."}),e.jsx(G,{variant:"outline",size:"sm",onClick:()=>o("/chat"),children:"Acessar Central de Ajuda"})]})]})})})]})})}export{Q as default};

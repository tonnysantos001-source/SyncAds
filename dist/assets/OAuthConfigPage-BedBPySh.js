import{d as _,r as l,s as v,j as e,ap as N,N as n,ao as y,C as m,h as p,aB as O,e as T,f as F,n as w,ar as H,aC as $,g as L,aD as U,I as k,aE as B,aF as q,B as G,aG as K}from"./index-CVm5GJqW.js";import{L as x}from"./label-C8BV62X-.js";import{S as C}from"./SuperAdminLayout-B0xL8IJo.js";function z(){const{toast:o}=_(),[S,h]=l.useState(!1),[g,c]=l.useState(null),[u,A]=l.useState({}),[f,b]=l.useState([{platform:"META",platformName:"Meta / Facebook Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üìò",scopes:["ads_management","ads_read","pages_read_engagement","pages_manage_ads"],docsUrl:"https://developers.facebook.com/docs/facebook-login/guides/advanced/manual-flow"},{platform:"GOOGLE",platformName:"Google Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üîç",scopes:["https://www.googleapis.com/auth/adwords","https://www.googleapis.com/auth/userinfo.email"],docsUrl:"https://developers.google.com/identity/protocols/oauth2"},{platform:"LINKEDIN",platformName:"LinkedIn Ads",clientId:"",clientSecret:"",isActive:!1,icon:"üíº",scopes:["r_ads","r_ads_reporting","rw_ads"],docsUrl:"https://learn.microsoft.com/en-us/linkedin/shared/authentication/authentication"},{platform:"TIKTOK",platformName:"TikTok For Business",clientId:"",clientSecret:"",isActive:!1,icon:"üéµ",scopes:["user.info.basic","video.list","video.upload"],docsUrl:"https://developers.tiktok.com/doc/login-kit-web"}]);l.useEffect(()=>{j()},[]);const j=async()=>{try{h(!0);const{data:a,error:s}=await v.from("OAuthConfig").select("*").order("platform");if(s)throw s;a&&a.length>0&&b(t=>t.map(i=>{const r=a.find(D=>D.platform===i.platform);return r?{...i,clientId:r.clientId||"",clientSecret:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",isActive:r.isActive||!1}:i}))}catch(a){console.error("Erro ao carregar configs:",a),o({title:"Erro ao carregar configura√ß√µes",description:a.message,variant:"destructive"})}finally{h(!1)}},I=async a=>{try{c(a);const s=f.find(r=>r.platform===a);if(!s)return;if(!s.clientId||!s.clientSecret){o({title:"Campos obrigat√≥rios",description:"Client ID e Client Secret s√£o obrigat√≥rios.",variant:"destructive"}),c(null);return}const t={platform:s.platform,clientId:s.clientId,isActive:s.isActive,scopes:s.scopes,updatedAt:new Date().toISOString()};s.clientSecret!=="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"&&(t.clientSecret=s.clientSecret);const{error:i}=await v.from("OAuthConfig").upsert(t,{onConflict:"platform"});if(i)throw i;o({title:"‚úÖ Configura√ß√£o salva",description:`${s.platformName} configurado com sucesso!`}),await j()}catch(s){console.error("Erro ao salvar config:",s),o({title:"Erro ao salvar",description:s.message,variant:"destructive"})}finally{c(null)}},d=(a,s,t)=>{b(i=>i.map(r=>r.platform===a?{...r,[s]:t}:r))},E=a=>{A(s=>({...s,[a]:!s[a]}))};return S?e.jsx(C,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(N,{className:"h-8 w-8 animate-spin text-blue-600"})})}):e.jsx(C,{children:e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 shadow-lg",children:e.jsx(y,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Configura√ß√µes OAuth 2.0"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure as credenciais das plataformas para integra√ß√£o via chat"})]})]})}),e.jsx(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:e.jsx(m,{className:"mb-6 border-0 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 backdrop-blur-sm",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(O,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-lg",children:"Como funciona?"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Cadastre as credenciais OAuth aqui"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:'Marque como "Ativa" quando estiver aprovado pela plataforma'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:'Usu√°rios podem pedir no chat: "Conecte com Facebook"'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"A IA mostra card interativo para autoriza√ß√£o"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Tokens s√£o salvos criptografados"})]})]})]})]})})})}),e.jsx("div",{className:"grid gap-6",children:f.map((a,s)=>e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1+.2},children:e.jsxs(m,{className:"border-0 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(T,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-5xl p-3 rounded-xl bg-white dark:bg-gray-800 shadow-md",children:a.icon}),e.jsxs("div",{children:[e.jsxs(F,{className:"flex items-center gap-2 text-xl",children:[a.platformName,a.isActive?e.jsxs(w,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white border-0",children:[e.jsx(H,{className:"h-3 w-3 mr-1"}),"Ativo"]}):e.jsxs(w,{variant:"secondary",className:"bg-gray-200 dark:bg-gray-700",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),"Inativo"]})]}),e.jsxs(L,{className:"mt-2",children:[e.jsx("span",{className:"font-medium",children:"Scopes:"})," ",a.scopes.slice(0,2).join(", "),a.scopes.length>2&&` +${a.scopes.length-2} mais`]})]})]}),e.jsxs("a",{href:a.docsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-800 flex items-center gap-2 transition-colors px-4 py-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-950/20",children:["Documenta√ß√£o",e.jsx(U,{className:"h-4 w-4"})]})]})}),e.jsxs(p,{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:`${a.platform}-client-id`,className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Client ID *"}),e.jsx(k,{id:`${a.platform}-client-id`,placeholder:"Digite o Client ID da plataforma",value:a.clientId,onChange:t=>d(a.platform,"clientId",t.target.value),className:"mt-2 font-mono text-sm bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:`${a.platform}-client-secret`,className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Client Secret *"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(k,{id:`${a.platform}-client-secret`,type:u[a.platform]?"text":"password",placeholder:"Digite o Client Secret",value:a.clientSecret,onChange:t=>d(a.platform,"clientSecret",t.target.value),className:"pr-12 font-mono text-sm bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"}),e.jsx("button",{type:"button",onClick:()=>E(a.platform),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:u[a.platform]?e.jsx(B,{className:"h-5 w-5"}):e.jsx(q,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsx("input",{type:"checkbox",id:`${a.platform}-active`,checked:a.isActive,onChange:t=>d(a.platform,"isActive",t.target.checked),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"}),e.jsx(x,{htmlFor:`${a.platform}-active`,className:"cursor-pointer font-medium",children:"Ativar integra√ß√£o (usu√°rios poder√£o conectar)"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(G,{onClick:()=>I(a.platform),disabled:g===a.platform,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 h-12 text-base font-semibold",children:g===a.platform?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mr-2 h-5 w-5 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-2 h-5 w-5"}),"Salvar Configura√ß√£o"]})})})]})]})},a.platform))}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsx(m,{className:"mt-8 border-0 bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 backdrop-blur-sm",children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:e.jsx(y,{className:"h-6 w-6 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-lg",children:"üìå Importante"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"As credenciais s√£o criptografadas antes de salvar no banco"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Nunca s√£o expostas no frontend dos usu√°rios"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:'Quando "Ativa", a integra√ß√£o fica dispon√≠vel para todos usu√°rios'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Desative temporariamente se houver problemas de aprova√ß√£o"})]})]})]})]})})})})]})})}export{z as default};

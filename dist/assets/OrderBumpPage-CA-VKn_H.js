import{r as i,b as W,u as Y,j as e,B as x,I as g,d as f,e as v,f as N,h as C,S as Z,l as k}from"./index-CESLwo8P.js";import{T as ee,a as se,b as I,c as d,d as te,e as c}from"./table-BM7Rid31.js";import{D as re,a as ae,b as ie,c as le,d as oe,f as ne}from"./dialog-Bb2DcV9D.js";import{L as o}from"./label-9ZVc4loq.js";import{S as E,a as S,b as A,c as B,d as m}from"./select-lXy0-cjN.js";import{T as de}from"./textarea-DRqdzQr9.js";import{m as T}from"./marketingApi-DixWhR0P.js";import{p as ce}from"./productsApi-D7LF_lJx.js";import{S as V}from"./skeleton-C6glroB8.js";import{P as z}from"./plus-Di81QkIL.js";import{T as R}from"./trending-up-IqyPwDlr.js";import{S as ue}from"./shopping-cart-B1f0xF4q.js";import{D as xe}from"./dollar-sign-Cmc4VuGx.js";import{S as he}from"./square-pen-Dz9Y4rxG.js";import{T as me}from"./trash-2-WCv0WUAe.js";import"./x-zWtS-pGh.js";import"./index-r7Ga8AMd.js";import"./chevron-up-ChcweCx-.js";const ke=()=>{const[h,F]=i.useState([]),[D,H]=i.useState([]),[O,b]=i.useState([]),[L,U]=i.useState(!0),[n,q]=i.useState(""),[G,p]=i.useState(!1),[j,P]=i.useState(null),{toast:u}=W(),l=Y(s=>s.user),[t,a]=i.useState({name:"",productId:"",title:"",description:"",discountType:"PERCENTAGE",discountValue:0,position:"CHECKOUT",isActive:!0});i.useEffect(()=>{w()},[]),i.useEffect(()=>{K()},[n,h]);const w=async()=>{try{if(!(l!=null&&l.organizationId))return;const[s,r]=await Promise.all([T.orderBumps.getAll(l.organizationId),ce.list()]);F(s),H(r),b(s)}catch(s){u({title:"Erro ao carregar",description:s.message,variant:"destructive"})}finally{U(!1)}},K=()=>{if(!n){b(h);return}const s=h.filter(r=>r.name.toLowerCase().includes(n.toLowerCase())||r.title.toLowerCase().includes(n.toLowerCase()));b(s)},$=async s=>{s.preventDefault();try{if(!(l!=null&&l.organizationId))return;j?(await T.orderBumps.update(j.id,t),u({title:"Order Bump atualizado!"})):(await T.orderBumps.create({...t,organizationId:l.organizationId}),u({title:"Order Bump criado!",description:"A oferta está pronta para uso."})),p(!1),y(),w()}catch(r){u({title:"Erro",description:r.message,variant:"destructive"})}},M=async s=>{if(confirm("Tem certeza que deseja deletar este order bump?"))try{await T.orderBumps.delete(s),u({title:"Order Bump deletado"}),w()}catch(r){u({title:"Erro ao deletar",description:r.message,variant:"destructive"})}},X=s=>{P(s),a({name:s.name,productId:s.productId,title:s.title,description:s.description||"",discountType:s.discountType||"PERCENTAGE",discountValue:s.discountValue||0,position:s.position,isActive:s.isActive}),p(!0)},y=()=>{P(null),a({name:"",productId:"",title:"",description:"",discountType:"PERCENTAGE",discountValue:0,position:"CHECKOUT",isActive:!0})},_=h.filter(s=>s.isActive).length,J=s=>{const r=D.find(Q=>Q.id===s);return(r==null?void 0:r.name)||"Produto não encontrado"};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/30 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Order Bump"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Ofertas especiais exibidas durante o checkout"})]}),e.jsxs(re,{open:G,onOpenChange:p,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(x,{onClick:y,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Criar Order Bump"]})}),e.jsxs(ie,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(oe,{children:j?"Editar Order Bump":"Novo Order Bump"})}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Nome Interno *"}),e.jsx(g,{value:t.name,onChange:s=>a({...t,name:s.target.value}),placeholder:"Ex: Acessório Premium",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Produto *"}),e.jsxs(E,{value:t.productId,onValueChange:s=>a({...t,productId:s}),required:!0,children:[e.jsx(S,{children:e.jsx(A,{placeholder:"Selecione o produto"})}),e.jsx(B,{children:D.map(s=>e.jsxs(m,{value:s.id,children:[s.name," - R$ ",s.price.toFixed(2)]},s.id))})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Título da Oferta *"}),e.jsx(g,{value:t.title,onChange:s=>a({...t,title:s.target.value}),placeholder:"Ex: Adicione Proteção Estendida",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Descrição"}),e.jsx(de,{value:t.description,onChange:s=>a({...t,description:s.target.value}),placeholder:"Descreva a oferta...",rows:3})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Tipo de Desconto"}),e.jsxs(E,{value:t.discountType,onValueChange:s=>a({...t,discountType:s}),children:[e.jsx(S,{children:e.jsx(A,{})}),e.jsxs(B,{children:[e.jsx(m,{value:"PERCENTAGE",children:"Porcentagem"}),e.jsx(m,{value:"FIXED_AMOUNT",children:"Valor Fixo"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Valor do Desconto"}),e.jsx(g,{type:"number",step:"0.01",value:t.discountValue,onChange:s=>a({...t,discountValue:parseFloat(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Posição *"}),e.jsxs(E,{value:t.position,onValueChange:s=>a({...t,position:s}),children:[e.jsx(S,{children:e.jsx(A,{})}),e.jsxs(B,{children:[e.jsx(m,{value:"CHECKOUT",children:"Checkout"}),e.jsx(m,{value:"CART",children:"Carrinho"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.isActive,onChange:s=>a({...t,isActive:s.target.checked}),className:"rounded"}),e.jsx(o,{children:"Ativo"})]})]}),e.jsxs(ne,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancelar"}),e.jsx(x,{type:"submit",children:j?"Atualizar":"Criar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(f,{className:"border-0 bg-white/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Total de Order Bumps"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.length})})]}),e.jsxs(f,{className:"border-0 bg-white/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Ativos"}),e.jsx(ue,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:_})})]}),e.jsxs(f,{className:"border-0 bg-white/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Taxa Conversão"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:"-"})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(g,{placeholder:"Buscar order bumps...",value:n,onChange:s=>q(s.target.value),className:"pl-9"})]}),e.jsxs(f,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsx(v,{children:e.jsx(N,{children:"Lista de Order Bumps"})}),e.jsx(C,{children:L?e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"h-12 w-full"}),e.jsx(V,{className:"h-12 w-full"})]}):O.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(R,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhum order bump encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n?"Tente ajustar sua busca":"Comece criando seu primeiro order bump"}),!n&&e.jsxs(x,{onClick:y,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Criar Primeiro Order Bump"]})]}):e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(I,{children:[e.jsx(d,{children:"Nome"}),e.jsx(d,{children:"Produto"}),e.jsx(d,{children:"Título"}),e.jsx(d,{children:"Desconto"}),e.jsx(d,{children:"Posição"}),e.jsx(d,{children:"Status"}),e.jsx(d,{className:"text-right",children:"Ações"})]})}),e.jsx(te,{children:O.map(s=>e.jsxs(I,{children:[e.jsx(c,{className:"font-medium",children:s.name}),e.jsx(c,{children:J(s.productId)}),e.jsx(c,{children:s.title}),e.jsx(c,{children:s.discountValue?s.discountType==="PERCENTAGE"?`${s.discountValue}%`:`R$ ${s.discountValue.toFixed(2)}`:"-"}),e.jsx(c,{children:e.jsx(k,{variant:"outline",children:s.position==="CHECKOUT"?"Checkout":"Carrinho"})}),e.jsx(c,{children:e.jsx(k,{variant:s.isActive?"default":"secondary",children:s.isActive?"Ativo":"Inativo"})}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>X(s),children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>M(s.id),children:e.jsx(me,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})};export{ke as default};

import{d as M,r as g,s as h,j as e,O as c,a9 as v,as as D,ap as V,ad as _,e as w,f as S,g as T,h as z,i as A,at as $,I as q,o as j}from"./index-DB1lyyic.js";import{T as P,a as W,b as N,c as o,d as G,e as r}from"./table-D7NWkaoR.js";import{S as C}from"./SuperAdminLayout-BTy8AnuX.js";const u=({title:p,value:i,description:b,icon:n,gradient:d,delay:y=0})=>e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y},whileHover:{scale:1.02},children:e.jsxs(w,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl hover:border-gray-600 transition-all group cursor-pointer relative overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${d} opacity-10 group-hover:opacity-20 transition-opacity`}),e.jsxs(S,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[e.jsx(T,{className:"text-sm font-medium text-gray-300",children:p}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${d} shadow-lg`,children:e.jsx(n,{className:"h-4 w-4 text-white"})})]}),e.jsxs(A,{className:"relative z-10",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:i}),e.jsx("p",{className:"text-xs text-gray-400",children:b})]})]})});function Q(){const{toast:p}=M(),[i,b]=g.useState([]),[n,d]=g.useState(""),[y,E]=g.useState(!0);g.useEffect(()=>{U()},[]);const U=async()=>{try{const{data:a,error:t}=await h.from("User").select("*").order("createdAt",{ascending:!1});if(t)throw t;const{data:s}=await h.from("SuperAdmin").select("id"),x=new Set((s||[]).map(l=>l.id)),I=(a||[]).filter(l=>!x.has(l.id)),L=await Promise.all(I.map(async l=>{const{count:R}=await h.from("Campaign").select("*",{count:"exact",head:!0}).eq("userId",l.id),{count:k}=await h.from("ChatConversation").select("*",{count:"exact",head:!0}).eq("userId",l.id);return{...l,_count:{campaigns:R||0,messages:k||0}}}));b(L)}catch(a){p({title:"Erro ao carregar usuários",description:a.message,variant:"destructive"})}finally{E(!1)}},f=i.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.email.toLowerCase().includes(n.toLowerCase())),H=a=>{const t={ADMIN:{className:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border-purple-500/30",label:"Admin"},MEMBER:{className:"bg-gradient-to-r from-blue-500/20 to-cyan-500/20 text-blue-300 border-blue-500/30",label:"Membro"},VIEWER:{className:"bg-gradient-to-r from-gray-500/20 to-gray-600/20 text-gray-300 border-gray-500/30",label:"Visualizador"}},s=t[a]||t.MEMBER;return e.jsx(j,{className:`${s.className} border`,children:s.label})},B=a=>a?e.jsx(j,{className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-300 border-green-500/30 border",children:"Ativo"}):e.jsx(j,{className:"bg-gradient-to-r from-red-500/20 to-orange-500/20 text-red-300 border-red-500/30 border",children:"Suspenso"}),m={total:i.length,active:i.filter(a=>a.isActive).length,verified:i.filter(a=>a.emailVerified).length,totalCampaigns:i.reduce((a,t)=>{var s;return a+(((s=t._count)==null?void 0:s.campaigns)||0)},0)};return y?e.jsx(C,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-purple-500/30 border-t-purple-500 rounded-full"})})}):e.jsx(C,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:"Usuários"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Todos os usuários cadastrados na plataforma"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(u,{title:"Total de Usuários",value:m.total,description:"Todos cadastrados",icon:v,gradient:"from-blue-500 to-cyan-500",delay:.1}),e.jsx(u,{title:"Usuários Ativos",value:m.active,description:"Contas ativas",icon:D,gradient:"from-green-500 to-emerald-500",delay:.2}),e.jsx(u,{title:"Emails Verificados",value:m.verified,description:"Contas verificadas",icon:V,gradient:"from-purple-500 to-pink-500",delay:.3}),e.jsx(u,{title:"Total Campanhas",value:m.totalCampaigns,description:"Criadas por todos",icon:_,gradient:"from-orange-500 to-red-500",delay:.4})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsxs(w,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl",children:[e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(T,{className:"text-white",children:"Todos os Usuários"}),e.jsx(z,{className:"text-gray-400",children:"Lista completa de usuários cadastrados"})]})})}),e.jsxs(A,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(q,{placeholder:"Buscar por nome ou email...",value:n,onChange:a=>d(a.target.value),className:"pl-10 bg-gray-800/50 border-gray-700 text-white placeholder:text-gray-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"border border-gray-700/50 rounded-lg overflow-hidden",children:e.jsxs(P,{children:[e.jsx(W,{children:e.jsxs(N,{className:"border-gray-700/50 hover:bg-gray-800/50",children:[e.jsx(o,{className:"text-gray-300 font-semibold",children:"Usuário"}),e.jsx(o,{className:"text-gray-300 font-semibold",children:"Email"}),e.jsx(o,{className:"text-gray-300 font-semibold",children:"Role"}),e.jsx(o,{className:"text-gray-300 font-semibold",children:"Status"}),e.jsx(o,{className:"text-gray-300 font-semibold",children:"Campanhas"}),e.jsx(o,{className:"text-gray-300 font-semibold",children:"Conversas"}),e.jsx(o,{className:"text-gray-300 font-semibold",children:"Criado em"})]})}),e.jsx(G,{children:f.length===0?e.jsx(N,{children:e.jsx(r,{colSpan:7,className:"text-center py-12 text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(v,{className:"w-12 h-12 text-gray-600"}),e.jsx("p",{children:"Nenhum usuário encontrado"})]})})}):f.map((a,t)=>{var s,x;return e.jsxs(c.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.05},className:"border-gray-700/50 hover:bg-gray-800/50 transition-colors",children:[e.jsx(r,{children:e.jsx("div",{className:"font-medium text-white",children:a.name})}),e.jsx(r,{children:e.jsx("div",{className:"text-sm text-gray-400",children:a.email})}),e.jsx(r,{children:H(a.role)}),e.jsx(r,{children:B(a.isActive)}),e.jsx(r,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-white font-medium",children:((s=a._count)==null?void 0:s.campaigns)||0})})}),e.jsx(r,{className:"text-white font-medium",children:((x=a._count)==null?void 0:x.messages)||0}),e.jsx(r,{className:"text-sm text-gray-400",children:new Date(a.createdAt).toLocaleDateString("pt-BR")})]},a.id)})})]})})]})]})})]})})}export{Q as default};

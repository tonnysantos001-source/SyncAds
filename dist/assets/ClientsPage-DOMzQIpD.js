import{j as e}from"./vendor-ui-Ba0j3nT4.js";import{r as a}from"./vendor-react-X41Bjl18.js";import{g as s,s as r,H as t,S as i,P as o,y as l,C as n,a as d,b as c,d as m,c as x,T as h,I as g,e as u}from"./index-DChZUWKl.js";import{T as p,a as j,b as y,c as b,d as f,e as v}from"./table-C3aARsr4.js";import{S as N}from"./SuperAdminLayout-CUHLoklY.js";import{m as w}from"./vendor-animation-mzn7-F4O.js";import"./vendor-supabase-D-IBGfoY.js";import"./vendor-utils-Dl0_yMKq.js";import"./vendor-query-NmUWZ0iG.js";import"./vendor-icons-BvRy6l6m.js";const C=({title:a,value:s,description:r,icon:t,gradient:i,delay:o=0})=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o},whileHover:{scale:1.02},children:e.jsxs(n,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl hover:border-gray-600 transition-all group cursor-pointer relative overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${i} opacity-10 group-hover:opacity-20 transition-opacity`}),e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[e.jsx(c,{className:"text-sm font-medium text-gray-300",children:a}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${i} shadow-lg`,children:e.jsx(t,{className:"h-4 w-4 text-white"})})]}),e.jsxs(x,{className:"relative z-10",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s}),e.jsx("p",{className:"text-xs text-gray-400",children:r})]})]})});function S(){const{toast:S}=s(),[A,E]=a.useState([]),[L,M]=a.useState(""),[T,U]=a.useState(!0);a.useEffect(()=>{I()},[]);const I=async()=>{try{const{data:e,error:a}=await r.from("User").select("*").order("createdAt",{ascending:!1});if(a)throw a;const{data:s}=await r.from("SuperAdmin").select("id"),t=new Set((s||[]).map(e=>e.id)),i=(e||[]).filter(e=>!t.has(e.id)),o=await Promise.all(i.map(async e=>{const{count:a}=await r.from("Campaign").select("*",{count:"exact",head:!0}).eq("userId",e.id),{count:s}=await r.from("ChatMessage").select("*",{count:"exact",head:!0}).eq("userId",e.id);return{...e,_count:{campaigns:a||0,messages:s||0}}}));E(o)}catch(e){S({title:"Erro ao carregar usuários",description:e.message,variant:"destructive"})}finally{U(!1)}},R=A.filter(e=>e.name.toLowerCase().includes(L.toLowerCase())||e.email.toLowerCase().includes(L.toLowerCase())),k=a=>{const s={ADMIN:{className:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border-purple-500/30",label:"Admin"},MEMBER:{className:"bg-gradient-to-r from-blue-500/20 to-cyan-500/20 text-blue-300 border-blue-500/30",label:"Membro"},VIEWER:{className:"bg-gradient-to-r from-gray-500/20 to-gray-600/20 text-gray-300 border-gray-500/30",label:"Visualizador"}},r=s[a]||s.MEMBER;return e.jsx(u,{className:`${r.className} border`,children:r.label})},B={total:A.length,active:A.filter(e=>e.isActive).length,verified:A.filter(e=>e.emailVerified).length,totalCampaigns:A.reduce((e,a)=>e+(a._count?.campaigns||0),0)};return T?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(w.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-purple-500/30 border-t-purple-500 rounded-full"})})}):e.jsx(N,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(w.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:"Usuários"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Todos os usuários cadastrados na plataforma"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(C,{title:"Total de Usuários",value:B.total,description:"Todos cadastrados",icon:t,gradient:"from-blue-500 to-cyan-500",delay:.1}),e.jsx(C,{title:"Usuários Ativos",value:B.active,description:"Contas ativas",icon:i,gradient:"from-green-500 to-emerald-500",delay:.2}),e.jsx(C,{title:"Emails Verificados",value:B.verified,description:"Contas verificadas",icon:o,gradient:"from-purple-500 to-pink-500",delay:.3}),e.jsx(C,{title:"Total Campanhas",value:B.totalCampaigns,description:"Criadas por todos",icon:l,gradient:"from-orange-500 to-red-500",delay:.4})]}),e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsxs(n,{className:"border-gray-700/50 bg-gray-900/50 backdrop-blur-xl",children:[e.jsx(d,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(c,{className:"text-white",children:"Todos os Usuários"}),e.jsx(m,{className:"text-gray-400",children:"Lista completa de usuários cadastrados"})]})})}),e.jsxs(x,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(g,{placeholder:"Buscar por nome ou email...",value:L,onChange:e=>M(e.target.value),className:"pl-10 bg-gray-800/50 border-gray-700 text-white placeholder:text-gray-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"border border-gray-700/50 rounded-lg overflow-hidden",children:e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs(y,{className:"border-gray-700/50 hover:bg-gray-800/50",children:[e.jsx(b,{className:"text-gray-300 font-semibold",children:"Usuário"}),e.jsx(b,{className:"text-gray-300 font-semibold",children:"Email"}),e.jsx(b,{className:"text-gray-300 font-semibold",children:"Role"}),e.jsx(b,{className:"text-gray-300 font-semibold",children:"Status"}),e.jsx(b,{className:"text-gray-300 font-semibold",children:"Campanhas"}),e.jsx(b,{className:"text-gray-300 font-semibold",children:"Conversas"}),e.jsx(b,{className:"text-gray-300 font-semibold",children:"Criado em"})]})}),e.jsx(f,{children:0===R.length?e.jsx(y,{children:e.jsx(v,{colSpan:7,className:"text-center py-12 text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(t,{className:"w-12 h-12 text-gray-600"}),e.jsx("p",{children:"Nenhum usuário encontrado"})]})})}):R.map((a,s)=>{return e.jsxs(w.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*s},className:"border-gray-700/50 hover:bg-gray-800/50 transition-colors",children:[e.jsx(v,{children:e.jsx("div",{className:"font-medium text-white",children:a.name})}),e.jsx(v,{children:e.jsx("div",{className:"text-sm text-gray-400",children:a.email})}),e.jsx(v,{children:k(a.role)}),e.jsx(v,{children:(r=a.isActive,r?e.jsx(u,{className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-300 border-green-500/30 border",children:"Ativo"}):e.jsx(u,{className:"bg-gradient-to-r from-red-500/20 to-orange-500/20 text-red-300 border-red-500/30 border",children:"Suspenso"}))}),e.jsx(v,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-white font-medium",children:a._count?.campaigns||0})})}),e.jsx(v,{className:"text-white font-medium",children:a._count?.messages||0}),e.jsx(v,{className:"text-sm text-gray-400",children:new Date(a.createdAt).toLocaleDateString("pt-BR")})]},a.id);var r})})]})})]})]})})]})})}export{S as default};

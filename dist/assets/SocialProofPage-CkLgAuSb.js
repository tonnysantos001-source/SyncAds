import{r as t,d as J,a as G,s as j,j as e,N as v,B as m,I as U,C as N,e as w,f as k,h as C,S as K,n as Q}from"./index-Meov8yJ0.js";import{T as X,a as Y,b as ee,c as g,d as ae,e as h}from"./table-D5pKAVkz.js";import{D as se,a as re,b as te,c as ie,d as le,f as oe}from"./dialog-BAwanvSH.js";import{L as y}from"./label-vucZ_iaF.js";import{T as ne}from"./textarea-Djp-1gZ7.js";import{S as O}from"./skeleton-8nyDvCDk.js";import{P as q}from"./plus-CXtPZH5r.js";import{M as u}from"./message-square-Xh1zh-or.js";import{T as H}from"./target-DD__9soe.js";import{S as A}from"./sparkles-Bf5t48St.js";import{E as de}from"./eye-CBCKGo2H.js";import{Z as V}from"./zap-BZEFRRHL.js";import{T as _}from"./trending-up-CSni0jnj.js";import{S as ce}from"./square-pen-CpCMwELt.js";import{T as me}from"./trash-2-DeQvYyXl.js";import{U as xe}from"./users-0j73GFyf.js";const D=({title:i,value:S,icon:p,color:o,delay:E=0,subtitle:b})=>e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:E},children:e.jsxs(N,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${o} opacity-10 rounded-full blur-3xl`}),e.jsxs(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:i}),e.jsx("div",{className:`p-2 rounded-lg ${o} bg-opacity-10`,children:e.jsx(p,{className:`h-5 w-5 ${o.replace("bg-","text-")}`})})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:S}),b&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:b})]})]})}),Pe=()=>{const[i,S]=t.useState([]),[p,o]=t.useState([]),[E,b]=t.useState(!0),[n,z]=t.useState(""),[L,x]=t.useState(!1),[f,R]=t.useState(null),{toast:d}=J(),l=G(a=>a.user),[r,c]=t.useState({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0});t.useEffect(()=>{T()},[]),t.useEffect(()=>{M()},[n,i]);const T=async()=>{try{if(!(l!=null&&l.id))return;const{data:a,error:s}=await j.from("SocialProof").select("*").eq("userId",l.id).order("createdAt",{ascending:!1});if(s)throw s;S(a||[]),o(a||[])}catch(a){d({title:"Erro ao carregar",description:a.message,variant:"destructive"})}finally{b(!1)}},M=()=>{if(!n){o(i);return}const a=i.filter(s=>s.message.toLowerCase().includes(n.toLowerCase()));o(a)},B=async a=>{a.preventDefault();try{if(!(l!=null&&l.id))return;if(f){const{error:s}=await j.from("SocialProof").update({...r,updatedAt:new Date().toISOString()}).eq("id",f.id);if(s)throw s;d({title:"Prova social atualizada!"})}else{const{error:s}=await j.from("SocialProof").insert({...r,userId:l.id});if(s)throw s;d({title:"Prova social criada!",description:"A notificação está pronta para exibição."})}x(!1),P(),T()}catch(s){d({title:"Erro",description:s.message,variant:"destructive"})}},F=async a=>{if(confirm("Tem certeza que deseja deletar esta prova social?"))try{const{error:s}=await j.from("SocialProof").delete().eq("id",a);if(s)throw s;d({title:"Prova social deletada"}),T()}catch(s){d({title:"Erro ao deletar",description:s.message,variant:"destructive"})}},W=a=>{R(a),c({type:a.type,message:a.message,displayDuration:a.displayDuration,isActive:a.isActive}),x(!0)},P=()=>{R(null),c({type:"RECENT_PURCHASE",message:"",displayDuration:5,isActive:!0})},I=i.filter(a=>a.isActive).length,$=a=>({RECENT_PURCHASE:"Compra Recente",VISITOR_COUNT:"Contador de Visitantes",REVIEW:"Avaliação"})[a]||a,Z=a=>{switch(a){case"RECENT_PURCHASE":return e.jsx(_,{className:"h-4 w-4"});case"VISITOR_COUNT":return e.jsx(xe,{className:"h-4 w-4"});case"REVIEW":return e.jsx(u,{className:"h-4 w-4"});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-orange-600 via-red-600 to-pink-600 bg-clip-text text-transparent",children:"Prova Social"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium mt-2",children:"Notificações em tempo real para aumentar confiança e conversões"})]}),e.jsxs(se,{open:L,onOpenChange:x,children:[e.jsx(re,{asChild:!0,children:e.jsxs(m,{onClick:P,size:"lg",className:"shadow-lg hover:shadow-xl transition-all",children:[e.jsx(q,{className:"mr-2 h-5 w-5"}),"Criar Prova Social"]})}),e.jsxs(te,{className:"max-w-lg bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border-none shadow-2xl",children:[e.jsx(ie,{children:e.jsxs(le,{className:"flex items-center gap-2 text-xl",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 shadow-md",children:e.jsx(u,{className:"h-5 w-5 text-white"})}),f?"Editar Prova Social":"Nova Prova Social"]})}),e.jsxs("form",{onSubmit:B,className:"space-y-5 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-gradient-to-br from-purple-500 to-pink-600",children:e.jsx(H,{className:"h-3 w-3 text-white"})}),"Tipo *"]}),e.jsxs("select",{className:"w-full p-2.5 border border-gray-300 dark:border-gray-700 rounded-lg bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm focus:ring-2 focus:ring-purple-500/50 transition-all",value:r.type,onChange:a=>c({...r,type:a.target.value}),required:!0,children:[e.jsx("option",{value:"RECENT_PURCHASE",children:"Compra Recente"}),e.jsx("option",{value:"VISITOR_COUNT",children:"Contador de Visitantes"}),e.jsx("option",{value:"REVIEW",children:"Avaliação"})]}),e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 border border-blue-200/50 dark:border-blue-800/50",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),r.type==="RECENT_PURCHASE"&&'Ex: "João acabou de comprar há 5 minutos"',r.type==="VISITOR_COUNT"&&'Ex: "23 pessoas estão visualizando este produto"',r.type==="REVIEW"&&'Ex: "★★★★★ Produto excelente! - Maria S."']})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-gradient-to-br from-blue-500 to-cyan-600",children:e.jsx(u,{className:"h-3 w-3 text-white"})}),"Mensagem *"]}),e.jsx(ne,{value:r.message,onChange:a=>c({...r,message:a.target.value}),placeholder:"Digite a mensagem que será exibida...",rows:3,className:"bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-blue-500/50 transition-all resize-none",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-gradient-to-br from-green-500 to-emerald-600",children:e.jsx(de,{className:"h-3 w-3 text-white"})}),"Duração de Exibição (segundos)"]}),e.jsx(U,{type:"number",min:"1",max:"30",value:r.displayDuration,onChange:a=>c({...r,displayDuration:parseInt(a.target.value)}),className:"bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-green-500/50 transition-all",required:!0})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-800/50 border border-gray-200/50 dark:border-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:r.isActive,onChange:a=>c({...r,isActive:a.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500 focus:ring-2"}),e.jsxs(y,{className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-purple-600"}),"Ativo"]})]}),e.jsxs(oe,{className:"gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>x(!1),className:"hover:bg-gray-100 dark:hover:bg-gray-800",children:"Cancelar"}),e.jsxs(m,{type:"submit",className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white border-none shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),f?"Atualizar":"Criar"]})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsx(D,{title:"Total de Provas",value:i.length,icon:A,color:"bg-orange-500",delay:.1,subtitle:"Notificações criadas"}),e.jsx(D,{title:"Provas Ativas",value:I,icon:V,color:"bg-green-500",delay:.2,subtitle:"Exibindo no checkout"}),e.jsx(D,{title:"Impacto",value:"Alto",icon:H,color:"bg-red-500",delay:.3,subtitle:"Aumenta confiança"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",style:{display:"none"},children:[e.jsxs(N,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Total"}),e.jsx(u,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:i.length})})]}),e.jsxs(N,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(w,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Ativas"}),e.jsx(_,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:I})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-600 dark:text-gray-400"}),e.jsx(U,{placeholder:"Buscar provas sociais...",value:n,onChange:a=>z(a.target.value),className:"pl-9 border-gray-200 dark:border-gray-600 bg-white/80 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500 backdrop-blur-sm"})]}),e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:e.jsxs(N,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(w,{children:e.jsx(k,{className:"text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Lista de Provas Sociais"})}),e.jsx(C,{children:E?e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{className:"h-12 w-full"}),e.jsx(O,{className:"h-12 w-full"})]}):p.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"p-4 rounded-full bg-gradient-to-br from-orange-500 to-pink-500 mb-4",children:e.jsx(u,{className:"h-12 w-12 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhuma prova social encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-md",children:n?"Tente ajustar sua busca":"Comece criando provas sociais para aumentar a confiança dos seus clientes"}),!n&&e.jsxs(m,{onClick:()=>{P(),x(!0)},size:"lg",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Criar Primeira Prova Social"]})]}):e.jsx("div",{className:"rounded-md border border-gray-200 dark:border-gray-800",children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(ee,{className:"hover:bg-transparent",children:[e.jsx(g,{children:"Tipo"}),e.jsx(g,{children:"Mensagem"}),e.jsx(g,{children:"Duração"}),e.jsx(g,{children:"Status"}),e.jsx(g,{className:"text-right",children:"Ações"})]})}),e.jsx(ae,{children:p.map((a,s)=>e.jsxs(v.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:s*.05},className:"hover:bg-gray-50/50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[Z(a.type),e.jsx("span",{className:"text-sm",children:$(a.type)})]})}),e.jsx(h,{className:"max-w-md truncate",children:a.message}),e.jsxs(h,{children:[a.displayDuration,"s"]}),e.jsx(h,{children:e.jsx(Q,{variant:a.isActive?"default":"secondary",className:a.isActive?"bg-green-500 hover:bg-green-600":"",children:a.isActive?"Ativa":"Inativa"})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>W(a),className:"hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-950",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>F(a.id),className:"hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-950",children:e.jsx(me,{className:"h-4 w-4"})})]})})]},a.id))})]})})})]})})]})};export{Pe as default};

import{c as D,r as d,f as Q,s as m,j as e,B as n,I as v,g as E,h as X,a as w,i as Y,n as _,k as J,l as T,X as Z}from"./index-DmvaoOhF.js";import{D as O,f as ee,a as P,b as G,c as R,d as k,e as S}from"./dialog-BGrZJSsv.js";import{L as p}from"./label-1fspZKb9.js";import{T as ae}from"./textarea-DKWxvi6z.js";import{S as se,a as re,b as ie,c as te,d as c}from"./select-B4aijD4m.js";import{S as U}from"./SuperAdminLayout-CStOOSMY.js";import{P as b}from"./plus-BWa6fEI2.js";import{T as oe}from"./trash-2-PPYgEXqT.js";import"./index-wKJi7wUj.js";import"./Logo-CGFkbF7z.js";import"./message-square-7kjXDp6D.js";import"./dollar-sign-BDnu9lAt.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=D("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=D("TestTubeDiagonal",[["path",{d:"M21 7 6.82 21.18a2.83 2.83 0 0 1-3.99-.01a2.83 2.83 0 0 1 0-4L17 3",key:"1ub6xw"}],["path",{d:"m16 2 6 6",key:"1gw87d"}],["path",{d:"M12 16H4",key:"1cjfip"}]]);function be(){var C,I;const[N,A]=d.useState([]),[L,M]=d.useState(!0),[K,j]=d.useState(!1),[F,f]=d.useState(!1),[i,h]=d.useState(null),{toast:o}=Q(),[r,x]=d.useState({name:"",provider:"OPENAI",apiKey:"",baseUrl:"",model:"",maxTokens:4096,temperature:.7});d.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:a,error:s}=await m.from("GlobalAiConnection").select("*").order("createdAt",{ascending:!1});if(s)throw s;A(a||[])}catch(a){o({title:"Erro ao carregar dados",description:a.message,variant:"destructive"})}finally{M(!1)}},z=async()=>{try{const{data:{user:a},error:s}=await m.auth.getUser();if(s||!a)throw new Error("Você precisa estar autenticado. Faça login novamente.");console.log("✅ Usuário autenticado:",a.id,a.email);const{error:t}=await m.from("GlobalAiConnection").insert({name:r.name,provider:r.provider,apiKey:r.apiKey,baseUrl:r.baseUrl||null,model:r.model||null,maxTokens:r.maxTokens,temperature:r.temperature,isActive:!0});if(t)throw console.error("❌ Erro RLS:",t),t;o({title:"✅ IA adicionada!",description:`${r.name} foi criada com sucesso.`}),j(!1),g(),x({name:"",provider:"OPENAI",apiKey:"",baseUrl:"",model:"",maxTokens:4096,temperature:.7})}catch(a){o({title:"Erro ao criar IA",description:a.message,variant:"destructive"})}},H=async(a,s)=>{try{const{error:t}=await m.from("GlobalAiConnection").update({isActive:!s}).eq("id",a);if(t)throw t;o({title:"Status atualizado",description:`IA ${s?"desativada":"ativada"}.`}),g()}catch(t){o({title:"Erro ao atualizar status",description:t.message,variant:"destructive"})}},q=async a=>{try{if(!a.apiKey||a.apiKey.length<10)throw new Error("API Key inválida ou muito curta");o({title:"🧪 Validando configuração...",description:`Verificando ${a.provider}`});const{error:s}=await m.from("GlobalAiConnection").update({isActive:!0}).eq("id",a.id);if(s)throw s;A(t=>t.map(l=>l.id===a.id?{...l,isActive:!0}:l)),o({title:"✅ Configuração válida!",description:`${a.provider} configurada e ativada. Teste no chat para confirmar funcionamento.`})}catch(s){console.error("Validação falhou:",s),o({title:"❌ Erro na validação",description:s.message,variant:"destructive"})}},B=async(a,s)=>{if(confirm(`Tem certeza que deseja remover "${s}"?

Esta ação não pode ser desfeita.`))try{const{error:t}=await m.from("GlobalAiConnection").delete().eq("id",a);if(t)throw t;o({title:"🗑️ IA removida!",description:`${s} foi removida com sucesso.`}),g()}catch(t){o({title:"Erro ao remover IA",description:t.message,variant:"destructive"})}},$=a=>{h(a),f(!0)},V=async()=>{if(i)try{const{error:a}=await m.from("GlobalAiConnection").update({systemPrompt:i.systemPrompt,initialGreetings:i.initialGreetings}).eq("id",i.id);if(a)throw a;o({title:"✅ Configuração salva!",description:"Prompt e mensagens iniciais atualizados."}),f(!1),g()}catch(a){o({title:"Erro ao salvar configuração",description:a.message,variant:"destructive"})}},W=a=>{const s={OPENAI:"bg-green-100 text-green-800",ANTHROPIC:"bg-orange-100 text-orange-800",GOOGLE:"bg-blue-100 text-blue-800",OPENROUTER:"bg-indigo-100 text-indigo-800",GROQ:"bg-red-100 text-red-800",COHERE:"bg-purple-100 text-purple-800",MISTRAL:"bg-amber-100 text-amber-800",PERPLEXITY:"bg-cyan-100 text-cyan-800",TOGETHER:"bg-pink-100 text-pink-800",FIREWORKS:"bg-yellow-100 text-yellow-800"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s[a]||"bg-gray-100 text-gray-800"}`,children:a})},u={OPENAI:{model:"gpt-4o-mini",baseUrl:"https://api.openai.com/v1",description:"GPT-4, GPT-3.5, DALL-E, Whisper"},ANTHROPIC:{model:"claude-3-5-sonnet-20241022",baseUrl:"https://api.anthropic.com/v1",description:"Claude 3.5 Sonnet, Claude 3 Opus"},GOOGLE:{model:"gemini-2.0-flash-exp",baseUrl:"https://generativelanguage.googleapis.com/v1",description:"Gemini Pro, Gemini Flash"},OPENROUTER:{model:"openai/gpt-4-turbo",baseUrl:"https://openrouter.ai/api/v1",description:"Acesso a 200+ modelos (OpenAI, Anthropic, Google, Meta, etc)"},GROQ:{model:"llama-3.3-70b-versatile",baseUrl:"https://api.groq.com/openai/v1",description:"Llama 3.3, Mixtral - Ultra rápido"},COHERE:{model:"command-r-plus",baseUrl:"https://api.cohere.ai/v1",description:"Command R+, Command R"},MISTRAL:{model:"mistral-large-latest",baseUrl:"https://api.mistral.ai/v1",description:"Mistral Large, Mistral Medium"},PERPLEXITY:{model:"llama-3.1-sonar-large-128k-online",baseUrl:"https://api.perplexity.ai",description:"Sonar Online - IA com busca web"},TOGETHER:{model:"meta-llama/Meta-Llama-3.1-405B-Instruct-Turbo",baseUrl:"https://api.together.xyz/v1",description:"Llama, Qwen, DeepSeek"},FIREWORKS:{model:"accounts/fireworks/models/llama-v3p1-405b-instruct",baseUrl:"https://api.fireworks.ai/inference/v1",description:"Modelos open source otimizados"}};return L?e.jsx(U,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-76px)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})}):e.jsx(U,{children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Conexões de IA Globais"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Adicionar e gerenciar IAs que serão atribuídas às organizações"})]}),e.jsxs(O,{open:K,onOpenChange:j,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(n,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Nova IA"]})}),e.jsxs(P,{className:"sm:max-w-[500px]",children:[e.jsxs(G,{children:[e.jsx(R,{children:"Nova Conexão de IA"}),e.jsx(k,{children:"Adicionar uma nova IA global ao sistema"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"name",children:"Nome"}),e.jsx(v,{id:"name",placeholder:"OpenAI GPT-4",value:r.name,onChange:a=>x({...r,name:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"provider",children:"Provider"}),e.jsxs(se,{value:r.provider,onValueChange:a=>{const s=u[a];x({...r,provider:a,model:(s==null?void 0:s.model)||"",baseUrl:(s==null?void 0:s.baseUrl)||""})},children:[e.jsx(re,{children:e.jsx(ie,{})}),e.jsxs(te,{children:[e.jsx(c,{value:"OPENAI",children:"🤖 OpenAI"}),e.jsx(c,{value:"ANTHROPIC",children:"🧠 Anthropic (Claude)"}),e.jsx(c,{value:"GOOGLE",children:"🔵 Google (Gemini)"}),e.jsx(c,{value:"OPENROUTER",children:"🌐 OpenRouter (200+ modelos)"}),e.jsx(c,{value:"GROQ",children:"⚡ Groq (Ultra rápido)"}),e.jsx(c,{value:"MISTRAL",children:"🇫🇷 Mistral AI"}),e.jsx(c,{value:"COHERE",children:"💜 Cohere"}),e.jsx(c,{value:"PERPLEXITY",children:"🔍 Perplexity (Web)"}),e.jsx(c,{value:"TOGETHER",children:"🤝 Together AI"}),e.jsx(c,{value:"FIREWORKS",children:"🎆 Fireworks AI"})]})]}),u[r.provider]&&e.jsx("p",{className:"text-xs text-gray-500",children:u[r.provider].description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"apiKey",children:"API Key"}),e.jsx(v,{id:"apiKey",type:"password",placeholder:"sk-...",value:r.apiKey,onChange:a=>x({...r,apiKey:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"model",children:"Modelo"}),e.jsx(v,{id:"model",placeholder:((C=u[r.provider])==null?void 0:C.model)||"gpt-4-turbo",value:r.model,onChange:a=>x({...r,model:a.target.value})}),e.jsx("p",{className:"text-xs text-gray-500",children:r.provider==="OPENROUTER"?"Formato: provider/model (ex: openai/gpt-4-turbo, anthropic/claude-3-5-sonnet)":"Nome do modelo a ser usado"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"baseUrl",children:"Base URL"}),e.jsx(v,{id:"baseUrl",placeholder:((I=u[r.provider])==null?void 0:I.baseUrl)||"https://api.openai.com/v1",value:r.baseUrl,onChange:a=>x({...r,baseUrl:a.target.value})}),e.jsx("p",{className:"text-xs text-gray-500",children:"URL da API do provider"})]})]}),e.jsxs(S,{children:[e.jsx(n,{variant:"outline",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(n,{onClick:z,children:"Criar IA"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mt-6",children:[N.map(a=>e.jsxs(E,{className:"bg-white border-gray-200",children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:e.jsx(w,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{children:a.name}),a.isActive&&e.jsx(_,{className:"bg-green-500",children:"✓ Testada"})]}),e.jsxs(J,{className:"mt-1 flex items-center gap-2",children:[W(a.provider),a.model&&e.jsxs("span",{className:"text-sm",children:["• ",a.model]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>$(a),title:"Configurar prompt e mensagens",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Configurar"]}),e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>q(a),title:"Testar conexão com a IA",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Testar"]}),e.jsx(n,{size:"sm",variant:a.isActive?"outline":"default",onClick:()=>H(a.id,a.isActive),children:a.isActive?"Desativar":"Ativar"}),e.jsx(n,{size:"sm",variant:"destructive",onClick:()=>B(a.id,a.name),title:"Remover IA",children:e.jsx(oe,{className:"h-4 w-4"})})]})]})}),e.jsx(T,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"API Key"}),e.jsxs("div",{className:"font-mono text-xs mt-1",children:[a.apiKey.substring(0,10),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Max Tokens"}),e.jsx("div",{className:"font-medium mt-1",children:a.maxTokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Temperature"}),e.jsx("div",{className:"font-medium mt-1",children:a.temperature})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Criada em"}),e.jsx("div",{className:"font-medium mt-1",children:new Date(a.createdAt).toLocaleDateString("pt-BR")})]})]})})]},a.id)),N.length===0&&e.jsx(E,{children:e.jsxs(T,{className:"py-12 text-center",children:[e.jsx(w,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhuma IA configurada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Adicione sua primeira conexão de IA para começar"}),e.jsxs(n,{onClick:()=>j(!0),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Adicionar IA"]})]})})]}),e.jsx(O,{open:F,onOpenChange:f,children:e.jsxs(P,{className:"sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsxs(R,{children:["Configurar IA: ",i==null?void 0:i.name]}),e.jsx(k,{children:"Configure o prompt de sistema e mensagens iniciais da IA"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"systemPrompt",children:"Prompt de Sistema"}),e.jsx(ae,{id:"systemPrompt",value:(i==null?void 0:i.systemPrompt)||"",onChange:a=>h(s=>s?{...s,systemPrompt:a.target.value}:null),rows:12,className:"font-mono text-sm",placeholder:"Digite o prompt de sistema que define o comportamento da IA..."}),e.jsx("p",{className:"text-xs text-gray-500",children:"Este prompt define a personalidade, capacidades e comportamento da IA. Seja específico sobre o que a IA pode fazer."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(p,{children:"Mensagens Iniciais"}),e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>{const a=[...(i==null?void 0:i.initialGreetings)||[],"Nova mensagem inicial"];h(s=>s?{...s,initialGreetings:a}:null)},children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Adicionar"]})]}),e.jsx("div",{className:"space-y-2",children:((i==null?void 0:i.initialGreetings)||[]).map((a,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{value:a,onChange:t=>{const l=[...(i==null?void 0:i.initialGreetings)||[]];l[s]=t.target.value,h(y=>y?{...y,initialGreetings:l}:null)},placeholder:`Mensagem inicial ${s+1}`}),e.jsx(n,{size:"icon",variant:"ghost",onClick:()=>{const t=((i==null?void 0:i.initialGreetings)||[]).filter((l,y)=>y!==s);h(l=>l?{...l,initialGreetings:t}:null)},children:e.jsx(Z,{className:"h-4 w-4"})})]},s))}),e.jsx("p",{className:"text-xs text-gray-500",children:"A IA escolherá aleatoriamente uma dessas mensagens para saudar novos usuários."})]})]}),e.jsxs(S,{children:[e.jsx(n,{variant:"outline",onClick:()=>f(!1),children:"Cancelar"}),e.jsx(n,{onClick:V,children:"Salvar Configuração"})]})]})})]})})}export{be as default};

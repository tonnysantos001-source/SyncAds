import{f as S,u as C,r as n,s as v,j as e,g as y,l as k,I as d,B as j}from"./index-C0WBWr70.js";import{L as m}from"./label-6Y6LwFMu.js";import{A as E,a as A}from"./alert-Cx0Dx0ye.js";import{C as D}from"./circle-alert-CWZ3HcNl.js";const I=()=>{const{toast:o}=S(),s=C(a=>a.user),[p,x]=n.useState(!0),[l,u]=n.useState(!1),[t,i]=n.useState({creditCard:"",pix:"",bankSlip:""});n.useEffect(()=>{s!=null&&s.id&&h()},[s==null?void 0:s.id]);const h=async()=>{var a,f,g;try{x(!0);const{data:r,error:c}=await v.from("PaymentDiscount").select("*").eq("userId",s==null?void 0:s.id).single();if(c&&c.code!=="PGRST116")throw c;r&&i({creditCard:((a=r.creditCard)==null?void 0:a.toString())||"",pix:((f=r.pix)==null?void 0:f.toString())||"",bankSlip:((g=r.bankSlip)==null?void 0:g.toString())||""})}catch(r){console.error("Erro ao carregar descontos:",r),o({title:"Erro ao carregar descontos",description:"Não foi possível carregar as configurações",variant:"destructive"})}finally{x(!1)}},b=async()=>{if(s!=null&&s.id){u(!0);try{const{error:a}=await v.from("PaymentDiscount").upsert({userId:s.id,creditCard:t.creditCard?parseFloat(t.creditCard):null,pix:t.pix?parseFloat(t.pix):null,bankSlip:t.bankSlip?parseFloat(t.bankSlip):null,updatedAt:new Date().toISOString()});if(a)throw a;o({title:"Descontos salvos!",description:"Suas configurações foram salvas com sucesso"})}catch(a){console.error("Erro ao salvar descontos:",a),o({title:"Erro ao salvar",description:"Não foi possível salvar os descontos",variant:"destructive"})}finally{u(!1)}}},N=()=>{h()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"DESCONTO POR FORMA DE PAGAMENTO"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Ofereça descontos por forma de pagamento."})]}),e.jsx(y,{children:e.jsxs(k,{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"creditCard",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cartão de crédito"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{id:"creditCard",type:"number",placeholder:"0",value:t.creditCard,onChange:a=>i({...t,creditCard:a.target.value}),className:"flex-1",min:"0",max:"100"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"pix",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Pix"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{id:"pix",type:"number",placeholder:"0",value:t.pix,onChange:a=>i({...t,pix:a.target.value}),className:"flex-1",min:"0",max:"100"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"bankSlip",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Boleto bancário"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{id:"bankSlip",type:"number",placeholder:"0",value:t.bankSlip,onChange:a=>i({...t,bankSlip:a.target.value}),className:"flex-1",min:"0",max:"100"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"%"})]})]}),e.jsxs(E,{className:"border-pink-200 bg-pink-50",children:[e.jsx(D,{className:"h-4 w-4 text-pink-600"}),e.jsxs(A,{className:"text-pink-900",children:["Está com dúvidas?"," ",e.jsx("a",{href:"#",className:"font-medium underline hover:no-underline",children:"Aprenda como criar um desconto por forma de pagamento"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(j,{onClick:N,variant:"outline",className:"px-6",disabled:l||p,children:"Cancelar"}),e.jsx(j,{onClick:b,className:"bg-pink-600 hover:bg-pink-700 text-white px-6",disabled:l||p,children:l?"Salvando...":"Salvar"})]})]})})]})};export{I as default};

import{c as _,m as H,e as V,f as $,u as z,r as c,s as m,j as e,N as S,g as h,h as I,i as q,l as g,I as A,M as y,n as v,B as G}from"./index-BXl307GV.js";import{L as f}from"./label-BnOLfE9V.js";import{S as p}from"./switch-ThkInedI.js";import{a as O}from"./gatewaysList-D-aqippA.js";import{S as F,a as E,b as M,c as L,d as N}from"./select-Dh4jpmnr.js";import{A as R}from"./arrow-left-BrNA5t3J.js";import{E as U}from"./external-link-BSW4MDGI.js";import"./index-BlOvcg1d.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=_("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),se=()=>{const{slug:u}=H(),o=V(),{toast:d}=$(),n=z(a=>a.user),[s,D]=c.useState(null),[B,w]=c.useState(!0),[j,b]=c.useState(!1),[i,k]=c.useState(!1),[l,C]=c.useState({});c.useEffect(()=>{u&&P()},[u]);const P=async()=>{try{w(!0);const a=O(u);if(!a){d({title:"Gateway não encontrado",description:"O gateway solicitado não existe.",variant:"destructive"}),o("/checkout/gateways");return}if(D(a),n!=null&&n.id){const{data:t,error:r}=await m.from("GatewayConfig").select("*").eq("userId",n.id).eq("gateway",a.slug).single();!r&&t&&(k(t.isActive||!1),C(t.credentials||{}))}}catch(a){console.error("Error loading gateway:",a)}finally{w(!1)}},T=async()=>{if(!(!s||!(n!=null&&n.id)))try{b(!0);const a=s.configFields.filter(r=>r.required&&!l[r.name]).map(r=>r.label);if(a.length>0){d({title:"Campos obrigatórios",description:`Preencha os campos: ${a.join(", ")}`,variant:"destructive"});return}const{data:t}=await m.from("GatewayConfig").select("id").eq("userId",n.id).eq("gateway",s.slug).single();if(t){const{error:r}=await m.from("GatewayConfig").update({credentials:l,isActive:i,updatedAt:new Date().toISOString()}).eq("id",t.id);if(r)throw r}else{const{error:r}=await m.from("GatewayConfig").insert({userId:n.id,gateway:s.slug,name:s.name,credentials:l,isActive:i});if(r)throw r}d({title:"Configuração salva!",description:`Gateway ${s.name} foi configurado com sucesso.`}),o("/checkout/gateways")}catch(a){console.error("Error saving gateway config:",a),d({title:"Erro ao salvar",description:"Não foi possível salvar a configuração.",variant:"destructive"})}finally{b(!1)}},x=(a,t)=>{C(r=>({...r,[a]:t}))};return B?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(S,{className:"h-8 w-8 animate-spin text-gray-400"})}):s?e.jsxs("div",{className:"p-6 sm:p-8 max-w-5xl mx-auto space-y-6",children:[e.jsxs("button",{onClick:()=>o("/checkout/gateways"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"ver todos gateways"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex items-center justify-center overflow-hidden p-2",children:e.jsx("img",{src:s.logo,alt:`${s.name} logo`,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["Integre sua loja ao gateway ",s.name,"."]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(h,{children:[e.jsx(I,{children:e.jsx(q,{children:"Informações básicas"})}),e.jsx(g,{className:"space-y-4",children:s.configFields.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{htmlFor:a.name,children:[a.label," ",a.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),a.type==="text"&&e.jsx(A,{id:a.name,type:"text",placeholder:a.placeholder,value:l[a.name]||"",onChange:t=>x(a.name,t.target.value),required:a.required}),a.type==="password"&&e.jsx(A,{id:a.name,type:"password",placeholder:a.placeholder,value:l[a.name]||"",onChange:t=>x(a.name,t.target.value),required:a.required}),a.type==="select"&&a.options&&e.jsxs(F,{value:l[a.name]||"",onValueChange:t=>x(a.name,t),children:[e.jsx(E,{children:e.jsx(M,{placeholder:a.placeholder||"Selecione"})}),e.jsx(L,{children:a.options.map(t=>e.jsx(N,{value:t.value,children:t.label},t.value))})]}),a.type==="checkbox"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{id:a.name,checked:l[a.name]||!1,onCheckedChange:t=>x(a.name,t)}),e.jsx(f,{htmlFor:a.name,className:"cursor-pointer",children:a.label})]})]},a.name))})]}),s.paymentMethods.length>0&&e.jsxs(h,{children:[e.jsx(I,{children:e.jsx(q,{children:"Regras"})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[s.paymentMethods.includes("credit_card")&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:"Ativar cartão de crédito"}),e.jsx(p,{defaultChecked:!1})]}),s.paymentMethods.includes("pix")&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:"Ativar pix"}),e.jsx(p,{defaultChecked:!1})]}),s.paymentMethods.includes("boleto")&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsx("span",{className:"text-sm",children:"Utilizar taxa de juros customizada"}),e.jsx(p,{defaultChecked:!1})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(h,{className:y("border-2",i?"border-green-200 bg-green-50 dark:bg-green-950/20":"border-red-200 bg-red-50 dark:bg-red-950/20"),children:e.jsxs(g,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(f,{htmlFor:"status",className:"text-base font-semibold",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:y("h-3 w-3 rounded-full",i?"bg-green-500":"bg-red-500")}),e.jsx("span",{className:y("text-sm font-medium",i?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"),children:i?"Ativo":"Inativo"})]})]}),e.jsxs(F,{value:i?"active":"inactive",onValueChange:a=>k(a==="active"),children:[e.jsx(E,{id:"status",children:e.jsx(M,{})}),e.jsxs(L,{children:[e.jsx(N,{value:"active",children:"Ativo"}),e.jsx(N,{value:"inactive",children:"Inativo"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("a",{href:s.apiDocs,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-pink-600 hover:text-pink-700 dark:text-pink-400 dark:hover:text-pink-300",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Está com dúvidas?"}),e.jsxs("span",{className:"underline",children:["Como integrar o gateway ",s.name,"?"]}),e.jsx(U,{className:"h-3 w-3"})]})})]})}),e.jsx(h,{children:e.jsxs(g,{className:"p-6 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tipo"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[(s.type==="nacional"||s.type==="both")&&e.jsx(v,{variant:"secondary",children:"Nacional"}),(s.type==="global"||s.type==="both")&&e.jsx(v,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:"Global"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Métodos de Pagamento"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:s.paymentMethods.map(a=>e.jsxs(v,{variant:"outline",className:"text-xs",children:[a==="credit_card"&&"Cartão de Crédito",a==="debit_card"&&"Cartão de Débito",a==="pix"&&"Pix",a==="boleto"&&"Boleto",a==="wallet"&&"Carteira Digital"]},a))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Features"}),e.jsx("ul",{className:"mt-1 space-y-1",children:s.features.map((a,t)=>e.jsxs("li",{className:"text-xs text-gray-700 dark:text-gray-300",children:["• ",a]},t))})]})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[e.jsx(G,{variant:"outline",onClick:()=>o("/checkout/gateways"),disabled:j,children:"Cancelar"}),e.jsx(G,{onClick:T,disabled:j,className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white",children:j?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar"})]})]}):null};export{se as default};

import{J as j,z as se,g as T,F as ie,D as le,j as e,k as O,B as R,C as B,l as M,o as G,t as $,an as de,q as z,x as H,ap as X,I as S}from"./index-DzM7EAHs.js";import{L as I}from"./label-CWlwf_hj.js";import{T as W,a as J,b as U,c as w,d as K,e as k}from"./table-fwopZ18_.js";import{D as ue,b as he,c as me,d as xe,e as ge,f as pe}from"./dialog-DWpI86GA.js";import{S as _,a as Q,b as Y,c as Z,d as P}from"./select-CGbgLOHv.js";import{S as ee}from"./switch-DELNvXdc.js";import{T as be,a as je,b as ae,c as te}from"./tabs-Bfjqu9RX.js";import{A as ve,a as ye}from"./alert-dc_syAJg.js";import{S as V}from"./skeleton-C83E9Nu1.js";import{P as re}from"./plus-CsvyqSPI.js";import{W as Ce}from"./wallet-vl0awF_P.js";import{D as fe}from"./dollar-sign-BjM_qRVX.js";import{U as Ee}from"./users-Drd7EuTx.js";import{S as we}from"./square-pen-CVRUNY5H.js";import{T as ke}from"./trash-2-CEU-q8cY.js";import{C as L}from"./circle-alert-DCmyIeIj.js";import{f as Ne,p as Ae}from"./pt-BR-BQ5kKd2v.js";import"./index-BJfZE_d7.js";import"./constructFrom-rJN6zrQ_.js";const m={async createRule(o){try{const{data:a,error:t}=await j.from("Cashback").insert(o).select().single();if(t)throw t;return a}catch(a){throw console.error("Error creating cashback rule:",a),a}},async updateRule(o,a){try{const{data:t,error:s}=await j.from("Cashback").update({...a,updatedAt:new Date().toISOString()}).eq("id",o).select().single();if(s)throw s;return t}catch(t){throw console.error("Error updating cashback rule:",t),t}},async deleteRule(o){try{const{error:a}=await j.from("Cashback").delete().eq("id",o);if(a)throw a}catch(a){throw console.error("Error deleting cashback rule:",a),a}},async listRules(o,a){try{let t=j.from("Cashback").select("*").eq("userId",o).order("createdAt",{ascending:!1});a!=null&&a.status&&(t=t.eq("status",a.status)),(a==null?void 0:a.active)!==void 0&&(a.active?t=t.eq("status","ACTIVE"):t=t.neq("status","ACTIVE"));const{data:s,error:l}=await t;if(l)throw l;return s}catch(t){throw console.error("Error listing cashback rules:",t),t}},async getRuleById(o){try{const{data:a,error:t}=await j.from("Cashback").select("*").eq("id",o).single();if(t)throw t;return a}catch(a){throw console.error("Error getting cashback rule:",a),a}},async toggleRule(o,a){try{const t=a?"ACTIVE":"INACTIVE";return await m.updateRule(o,{status:t})}catch(t){throw console.error("Error toggling cashback rule:",t),t}},async createTransaction(o){try{const{data:a,error:t}=await j.from("CashbackTransaction").insert(o).select().single();if(t)throw t;return a}catch(a){throw console.error("Error creating cashback transaction:",a),a}},async updateTransaction(o,a){try{const{data:t,error:s}=await j.from("CashbackTransaction").update({...a,updatedAt:new Date().toISOString()}).eq("id",o).select().single();if(s)throw s;return t}catch(t){throw console.error("Error updating cashback transaction:",t),t}},async getTransactions(o,a){try{let t=j.from("CashbackTransaction").select("*").eq("userId",o).order("createdAt",{ascending:!1});a!=null&&a.customerId&&(t=t.eq("customerId",a.customerId)),a!=null&&a.status&&(t=t.eq("status",a.status)),a!=null&&a.orderId&&(t=t.eq("orderId",a.orderId)),a!=null&&a.dateFrom&&(t=t.gte("createdAt",a.dateFrom)),a!=null&&a.dateTo&&(t=t.lte("createdAt",a.dateTo)),a!=null&&a.limit&&(t=t.limit(a.limit));const{data:s,error:l}=await t;if(l)throw l;return s}catch(t){throw console.error("Error getting cashback transactions:",t),t}},async getTransactionById(o){try{const{data:a,error:t}=await j.from("CashbackTransaction").select("*").eq("id",o).single();if(t)throw t;return a}catch(a){throw console.error("Error getting cashback transaction:",a),a}},async getAvailableCashback(o){try{const{data:a,error:t}=await j.from("CashbackTransaction").select("amount").eq("customerId",o).eq("status","AVAILABLE");if(t)throw t;return a.reduce((l,h)=>l+h.amount,0)}catch(a){throw console.error("Error getting available cashback:",a),a}},async getCustomerCashback(o){try{const{data:a,error:t}=await j.from("CashbackTransaction").select("*").eq("customerId",o).order("createdAt",{ascending:!1});if(t)throw t;const s=a,l=s.filter(i=>i.status!=="CANCELLED").reduce((i,n)=>i+n.amount,0),h=s.filter(i=>i.status==="USED").reduce((i,n)=>i+n.amount,0),c=s.filter(i=>i.status==="AVAILABLE").reduce((i,n)=>i+n.amount,0),x=s.filter(i=>i.status==="EXPIRED").reduce((i,n)=>i+n.amount,0);return{customerId:o,totalEarned:l,totalUsed:h,available:c,expired:x,transactions:s}}catch(a){throw console.error("Error getting customer cashback:",a),a}},async useCashback(o,a,t){try{const s=await m.getTransactionById(o);if(s.status!=="AVAILABLE")throw new Error("Cashback não está disponível para uso");const l=t||s.amount;if(l>s.amount)throw new Error("Valor a usar maior que o disponível");if(l===s.amount)return await m.updateTransaction(o,{status:"USED",usedAt:new Date().toISOString(),usedInOrderId:a});const h=s.amount-l;return await m.updateTransaction(o,{amount:h}),await m.createTransaction({userId:s.userId,customerId:s.customerId,cashbackId:s.cashbackId,orderId:s.orderId,amount:l,status:"USED",earnedAt:s.earnedAt,usedAt:new Date().toISOString(),usedInOrderId:a})}catch(s){throw console.error("Error using cashback:",s),s}},async expireCashback(o){try{return await m.updateTransaction(o,{status:"EXPIRED"})}catch(a){throw console.error("Error expiring cashback:",a),a}},async cancelCashback(o,a){try{return await m.updateTransaction(o,{status:"CANCELLED",cancelledAt:new Date().toISOString(),cancellationReason:a})}catch(t){throw console.error("Error cancelling cashback:",t),t}},async processExpiredCashbacks(o){try{const a=new Date().toISOString(),{data:t,error:s}=await j.from("CashbackTransaction").select("id").eq("userId",o).eq("status","AVAILABLE").lt("expiresAt",a);if(s)throw s;const l=t,h=l.map(c=>m.expireCashback(c.id));return await Promise.all(h),l.length}catch(a){throw console.error("Error processing expired cashbacks:",a),a}},async getStats(o,a){try{const t=await m.listRules(o),s=t.length,l=t.filter(u=>u.status==="ACTIVE").length;let h=j.from("CashbackTransaction").select("*").eq("userId",o);a&&(h=h.gte("createdAt",a.from).lte("createdAt",a.to));const{data:c,error:x}=await h;if(x)throw x;const i=c,n=i.filter(u=>u.status!=="CANCELLED").reduce((u,y)=>u+y.amount,0),p=i.filter(u=>u.status==="USED").reduce((u,y)=>u+y.amount,0),D=i.filter(u=>u.status==="AVAILABLE").reduce((u,y)=>u+y.amount,0),d=i.filter(u=>u.status==="EXPIRED").reduce((u,y)=>u+y.amount,0),v=[...new Set(i.map(u=>u.customerId))].length,g=v>0?n/v:0,N={};for(const u of t){const y=i.filter(C=>C.cashbackId===u.id),F=[...new Set(y.map(C=>C.customerId))];N[u.id]={ruleId:u.id,ruleName:u.name,totalEarned:y.filter(C=>C.status!=="CANCELLED").reduce((C,b)=>C+b.amount,0),totalUsed:y.filter(C=>C.status==="USED").reduce((C,b)=>C+b.amount,0),totalCustomers:F.length}}return{totalRules:s,activeRules:l,totalEarned:n,totalUsed:p,totalAvailable:D,totalExpired:d,customersWithCashback:v,averageCashbackPerCustomer:g,byRule:N}}catch(t){throw console.error("Error getting cashback stats:",t),t}},async getTopCustomers(o,a=10,t="available"){try{const{data:s,error:l}=await j.from("CashbackTransaction").select("customerId, amount, status").eq("userId",o);if(l)throw l;const h=s,c=new Map;h.forEach(n=>{c.has(n.customerId)||c.set(n.customerId,{customerId:n.customerId,totalEarned:0,available:0,used:0});const p=c.get(n.customerId);n.status!=="CANCELLED"&&(p.totalEarned+=n.amount),n.status==="AVAILABLE"&&(p.available+=n.amount),n.status==="USED"&&(p.used+=n.amount)});const x=Array.from(c.values()),i=t==="earned"?"totalEarned":"available";return x.sort((n,p)=>p[i]-n[i]).slice(0,a)}catch(s){throw console.error("Error getting top customers:",s),s}},async calculateCashback(o,a,t,s){try{const h=(await m.listRules(o,{active:!0})).sort((c,x)=>{const i=c.type==="PERCENTAGE"?a*c.value/100:c.value;return(x.type==="PERCENTAGE"?a*x.value/100:x.value)-i});for(const c of h){if(c.minOrderValue&&a<c.minOrderValue||c.validFrom&&new Date(c.validFrom)>new Date||c.validUntil&&new Date(c.validUntil)<new Date||c.applicableToProducts&&c.applicableToProducts.length>0&&s&&!s.some(n=>c.applicableToProducts.includes(n))||c.excludedProducts&&c.excludedProducts.length>0&&s&&s.some(n=>c.excludedProducts.includes(n))||c.maxUsesPerCustomer&&(await m.getTransactions(o,{customerId:t})).filter(p=>p.cashbackId===c.id&&p.status!=="CANCELLED").length>=c.maxUsesPerCustomer||c.firstPurchaseOnly&&(await m.getTransactions(o,{customerId:t})).length>0)continue;let x=c.type==="PERCENTAGE"?a*c.value/100:c.value;return c.maxCashbackAmount&&x>c.maxCashbackAmount&&(x=c.maxCashbackAmount),{applicable:!0,amount:x,rule:c}}return{applicable:!1,amount:0,reason:"Nenhuma regra de cashback aplicável"}}catch(l){throw console.error("Error calculating cashback:",l),l}}};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=se("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=se("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),q=({title:o,value:a,icon:t,color:s,delay:l=0,subtitle:h})=>e.jsx(O.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:l},children:e.jsxs(B,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${s} opacity-10 rounded-full blur-3xl`}),e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(G,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:o}),e.jsx("div",{className:`p-2 rounded-lg ${s} bg-opacity-10`,children:e.jsx(t,{className:`h-5 w-5 ${s.replace("bg-","text-")}`})})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:a}),h&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:h})]})]})}),Ke=()=>{const[o,a]=T.useState([]),[t,s]=T.useState(null),[l,h]=T.useState([]),[c,x]=T.useState(!0),[i,n]=T.useState(!1),[p,D]=T.useState(null),[d,f]=T.useState({name:"",description:"",type:"PERCENTAGE",value:0,status:"ACTIVE",firstPurchaseOnly:!1}),{toast:v}=ie(),g=le(r=>r.user);T.useEffect(()=>{g!=null&&g.id&&N()},[g==null?void 0:g.id]);const N=async()=>{try{x(!0);const[r,E,A]=await Promise.all([m.listRules(g.id),m.getStats(g.id),m.getTopCustomers(g.id,10,"available")]);a(r),s(E),h(A)}catch(r){console.error("Erro ao carregar dados:",r),v({title:"Erro ao carregar dados",description:r.message,variant:"destructive"})}finally{x(!1)}},u=async()=>{try{if(!(g!=null&&g.id))return;if(!d.name||!d.value){v({title:"Campos obrigatórios",description:"Preencha nome e valor do cashback",variant:"destructive"});return}const r={...d,userId:g.id};p?(await m.updateRule(p.id,d),v({title:"Regra atualizada com sucesso!"})):(await m.createRule(r),v({title:"Regra criada com sucesso!"})),n(!1),D(null),f({name:"",description:"",type:"PERCENTAGE",value:0,status:"ACTIVE",firstPurchaseOnly:!1}),N()}catch(r){console.error("Erro ao salvar:",r),v({title:"Erro ao salvar",description:r.message,variant:"destructive"})}},y=r=>{D(r),f(r),n(!0)},F=async r=>{if(confirm("Deseja realmente excluir esta regra?"))try{await m.deleteRule(r),v({title:"Regra excluída com sucesso!"}),N()}catch(E){console.error("Erro ao excluir:",E),v({title:"Erro ao excluir",description:E.message,variant:"destructive"})}},C=async(r,E)=>{try{await m.toggleRule(r,E),v({title:E?"Regra ativada!":"Regra desativada!"}),N()}catch(A){console.error("Erro ao alternar status:",A),v({title:"Erro ao alternar status",description:A.message,variant:"destructive"})}},b=r=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r),oe=r=>{const E={ACTIVE:{label:"Ativo",variant:"default",icon:X},INACTIVE:{label:"Inativo",variant:"secondary",icon:L},EXPIRED:{label:"Expirado",variant:"destructive",icon:L},SCHEDULED:{label:"Agendado",variant:"secondary",icon:L}};return E[r]||E.INACTIVE};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(O.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-green-600 via-emerald-600 to-teal-600 bg-clip-text text-transparent",children:"Cashback"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium mt-2",children:"Recompense seus clientes com cashback automático"})]}),e.jsxs(R,{onClick:()=>n(!0),size:"lg",className:"shadow-lg hover:shadow-xl transition-all",children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),"Nova Regra"]})]}),t&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-4",children:[e.jsx(q,{title:"Regras Ativas",value:t.activeRules,icon:Te,color:"bg-green-500",delay:.1,subtitle:`de ${t.totalRules} regras`}),e.jsx(q,{title:"Total Distribuído",value:b(t.totalEarned),icon:Ce,color:"bg-emerald-500",delay:.2,subtitle:"Cashback total gerado"}),e.jsx(q,{title:"Disponível",value:b(t.totalAvailable),icon:fe,color:"bg-teal-500",delay:.3,subtitle:"Aguardando uso"}),e.jsx(q,{title:"Clientes Ativos",value:t.customersWithCashback,icon:Ee,color:"bg-blue-500",delay:.4,subtitle:`Média: ${b(t.averageCashbackPerCustomer)}`})]}),e.jsxs(be,{defaultValue:"rules",className:"space-y-4",children:[e.jsxs(je,{children:[e.jsx(ae,{value:"rules",children:"Regras"}),e.jsx(ae,{value:"customers",children:"Top Clientes"})]}),e.jsx(te,{value:"rules",className:"space-y-4",children:e.jsx(O.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},children:e.jsxs(B,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{className:"text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Regras de Cashback"}),e.jsxs($,{children:[o.length," regra(s) cadastrada(s)"]})]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:N,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Atualizar"]})]}),e.jsx(z,{children:c?e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"h-12 w-full"}),e.jsx(V,{className:"h-12 w-full"}),e.jsx(V,{className:"h-12 w-full"})]}):o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"p-4 rounded-full bg-gradient-to-br from-green-500 to-teal-500 mb-4",children:e.jsx(Ie,{className:"h-12 w-12 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhuma regra cadastrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-md",children:"Crie sua primeira regra de cashback e fidelize seus clientes"}),e.jsxs(R,{onClick:()=>n(!0),size:"lg",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Criar Primeira Regra"]})]}):e.jsx("div",{className:"rounded-md border border-gray-200 dark:border-gray-800",children:e.jsxs(W,{children:[e.jsx(J,{children:e.jsxs(U,{className:"hover:bg-transparent",children:[e.jsx(w,{children:"Nome"}),e.jsx(w,{children:"Tipo"}),e.jsx(w,{children:"Valor"}),e.jsx(w,{children:"Status"}),e.jsx(w,{children:"Primeira Compra"}),e.jsx(w,{children:"Criado em"}),e.jsx(w,{className:"text-right",children:"Ações"})]})}),e.jsx(K,{children:o.map((r,E)=>{const A=oe(r.status),ce=A.icon;return e.jsxs(O.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:E*.05},className:"hover:bg-gray-50/50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx(k,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.name}),r.description&&e.jsx("div",{className:"text-sm text-muted-foreground",children:r.description})]})}),e.jsx(k,{children:e.jsx(H,{variant:"outline",className:"font-medium",children:r.type==="PERCENTAGE"?"Percentual":"Valor Fixo"})}),e.jsxs(k,{children:[e.jsx("div",{className:"font-medium",children:r.type==="PERCENTAGE"?`${r.value}%`:b(r.value)}),r.minOrderValue&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Min: ",b(r.minOrderValue)]})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{variant:A.variant,className:"gap-1",children:[e.jsx(ce,{className:"h-3 w-3"}),A.label]}),e.jsx(ee,{checked:r.status==="ACTIVE",onCheckedChange:ne=>C(r.id,ne)})]})}),e.jsx(k,{children:r.firstPurchaseOnly?e.jsx(X,{className:"h-4 w-4 text-green-600"}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(k,{children:Ne(new Date(r.createdAt),"dd/MM/yyyy",{locale:Ae})}),e.jsx(k,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>y(r),className:"hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-950",children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>F(r.id),className:"hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-950",children:e.jsx(ke,{className:"h-4 w-4"})})]})})]},r.id)})})]})})})]})})}),e.jsx(te,{value:"customers",className:"space-y-4",children:e.jsxs(B,{children:[e.jsxs(M,{children:[e.jsx(G,{children:"Clientes com Mais Cashback"}),e.jsx($,{children:"Top 10 clientes com cashback disponível"})]}),e.jsx(z,{children:c?e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"h-12 w-full"}),e.jsx(V,{className:"h-12 w-full"})]}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum cliente com cashback ainda"}):e.jsxs(W,{children:[e.jsx(J,{children:e.jsxs(U,{children:[e.jsx(w,{children:"Cliente"}),e.jsx(w,{children:"Total Ganho"}),e.jsx(w,{children:"Disponível"}),e.jsx(w,{children:"Usado"})]})}),e.jsx(K,{children:l.map(r=>e.jsxs(U,{children:[e.jsx(k,{children:e.jsxs("div",{className:"font-mono text-sm",children:[r.customerId.substring(0,8),"..."]})}),e.jsx(k,{children:e.jsx("div",{className:"font-medium",children:b(r.totalEarned)})}),e.jsx(k,{children:e.jsx("div",{className:"font-medium text-green-600",children:b(r.available)})}),e.jsx(k,{children:e.jsx("div",{className:"text-muted-foreground",children:b(r.used)})})]},r.customerId))})]})})]})})]}),e.jsx(ue,{open:i,onOpenChange:n,children:e.jsxs(he,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(me,{children:[e.jsx(xe,{children:p?"Editar Regra":"Nova Regra de Cashback"}),e.jsx(ge,{children:"Configure os parâmetros da regra de cashback"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"name",children:"Nome da Regra *"}),e.jsx(S,{id:"name",value:d.name,onChange:r=>f({...d,name:r.target.value}),placeholder:"Ex: Cashback 5% em todas as compras"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"description",children:"Descrição"}),e.jsx(S,{id:"description",value:d.description||"",onChange:r=>f({...d,description:r.target.value}),placeholder:"Descrição opcional"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"type",children:"Tipo *"}),e.jsxs(_,{value:d.type,onValueChange:r=>f({...d,type:r}),children:[e.jsx(Q,{children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(P,{value:"PERCENTAGE",children:"Percentual"}),e.jsx(P,{value:"FIXED_AMOUNT",children:"Valor Fixo"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(I,{htmlFor:"value",children:["Valor * ",d.type==="PERCENTAGE"&&"(%)"]}),e.jsx(S,{id:"value",type:"number",step:"0.01",value:d.value,onChange:r=>f({...d,value:parseFloat(r.target.value)}),placeholder:d.type==="PERCENTAGE"?"5":"10.00"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"minOrderValue",children:"Valor Mínimo do Pedido"}),e.jsx(S,{id:"minOrderValue",type:"number",step:"0.01",value:d.minOrderValue||"",onChange:r=>f({...d,minOrderValue:parseFloat(r.target.value)}),placeholder:"0.00"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"maxCashbackAmount",children:"Cashback Máximo"}),e.jsx(S,{id:"maxCashbackAmount",type:"number",step:"0.01",value:d.maxCashbackAmount||"",onChange:r=>f({...d,maxCashbackAmount:parseFloat(r.target.value)}),placeholder:"0.00"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{htmlFor:"status",children:"Status"}),e.jsxs(_,{value:d.status,onValueChange:r=>f({...d,status:r}),children:[e.jsx(Q,{children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(P,{value:"ACTIVE",children:"Ativo"}),e.jsx(P,{value:"INACTIVE",children:"Inativo"}),e.jsx(P,{value:"SCHEDULED",children:"Agendado"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{id:"firstPurchaseOnly",checked:d.firstPurchaseOnly,onCheckedChange:r=>f({...d,firstPurchaseOnly:r})}),e.jsx(I,{htmlFor:"firstPurchaseOnly",className:"cursor-pointer",children:"Apenas primeira compra do cliente"})]}),d.type==="PERCENTAGE"&&d.value>0&&e.jsxs(ve,{children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs(ye,{children:["Exemplo: Em uma compra de R$ 100,00, o cliente receberá"," ",b(100*(d.value/100))," de cashback",d.maxCashbackAmount&&` (limitado a ${b(d.maxCashbackAmount)})`]})]})]}),e.jsxs(pe,{children:[e.jsx(R,{variant:"outline",onClick:()=>{n(!1),D(null),f({name:"",description:"",type:"PERCENTAGE",value:0,status:"ACTIVE",firstPurchaseOnly:!1})},children:"Cancelar"}),e.jsx(R,{onClick:u,children:"Salvar"})]})]})})]})};export{Ke as default};

import{r as o,d as O,a as P,j as e,O as n,B as S,a7 as T,T as U,I as M,C as z,e as B,f as L,h as I,o as V}from"./index-CQ2-MXC2.js";import{T as D,a as H,b as q,c as x,d as G,e as m}from"./table-6mNi2wwQ.js";import{c as J,U as K}from"./user-check-DRTuSjoo.js";import{a as Q}from"./shopifySync-ClngA6CG.js";import{S as W}from"./skeleton-CTl8BRHF.js";import{U as A}from"./users-CkIcIneo.js";import{S as E}from"./shopping-bag-BW0WI4Eg.js";import{D as X}from"./dollar-sign-CYjdeJpZ.js";import{M as Y}from"./mail-C0QZmKrr.js";import{P as Z}from"./phone-BGdcRZxy.js";import{T as _}from"./trending-up-DxMEonvA.js";import{f as ee,p as ae}from"./pt-BR-BQ5kKd2v.js";import"./constructFrom-rJN6zrQ_.js";const p=({title:r,value:y,icon:h,color:l,delay:u=0,subtitle:d})=>e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:u},children:e.jsxs(z,{className:"relative overflow-hidden border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${l} opacity-10 rounded-full blur-3xl`}),e.jsxs(B,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:r}),e.jsx("div",{className:`p-2 rounded-lg ${l} bg-opacity-10`,children:e.jsx(h,{className:`h-5 w-5 ${l.replace("bg-","text-")}`})})]}),e.jsxs(I,{children:[e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-br from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:y}),d&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:d})]})]})}),pe=()=>{const[r,y]=o.useState([]),[h,l]=o.useState([]),[u,d]=o.useState(!0),[g,b]=o.useState(!1),[i,$]=o.useState(""),{toast:c}=O(),t=P(a=>a.user);o.useEffect(()=>{t!=null&&t.id&&j()},[t==null?void 0:t.id]),o.useEffect(()=>{F()},[i,r]);const j=async()=>{if(!(t!=null&&t.id)){d(!1);return}try{d(!0);const a=await J.listFromShopify(t.id);y(a),l(a)}catch(a){console.error("Erro ao carregar clientes:",a),c({title:"Erro ao carregar clientes",description:a.message,variant:"destructive"})}finally{d(!1)}},v=async()=>{if(!(t!=null&&t.id)){c({title:"Erro",description:"Faça login para sincronizar",variant:"destructive"});return}try{b(!0),c({title:"Sincronizando...",description:"Buscando clientes da Shopify"});const a=await Q.syncCustomers(t.id);a.success?(c({title:"Sincronização concluída!",description:a.message}),await j()):c({title:"Erro na sincronização",description:a.message,variant:"destructive"})}catch{c({title:"Erro ao sincronizar",description:"Configure a integração Shopify em Integrações",variant:"destructive"})}finally{b(!1)}},F=()=>{if(!i){l(r);return}const a=r.filter(s=>{var C;return s.name.toLowerCase().includes(i.toLowerCase())||s.email.toLowerCase().includes(i.toLowerCase())||((C=s.cpf)==null?void 0:C.toLowerCase().includes(i.toLowerCase()))});l(a)},f=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),N=r.reduce((a,s)=>a+s.totalSpent,0),k=r.reduce((a,s)=>a+s.totalOrders,0),w=r.filter(a=>a.status==="ACTIVE").length,R=r.length>0?N/r.length:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-5xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent mb-2",children:"Clientes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-medium text-lg",children:"Visualize e gerencie todos os clientes da sua loja"})]}),e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:e.jsxs(S,{onClick:v,disabled:g,size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(T,{className:`mr-2 h-5 w-5 ${g?"animate-spin":""}`}),g?"Sincronizando...":"Sincronizar Shopify"]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(p,{title:"Total de Clientes",value:r.length,icon:A,color:"bg-blue-500",delay:.1}),e.jsx(p,{title:"Clientes Ativos",value:w,icon:K,color:"bg-green-500",delay:.2,subtitle:`${(w/r.length*100||0).toFixed(0)}% do total`}),e.jsx(p,{title:"Total de Pedidos",value:k,icon:E,color:"bg-purple-500",delay:.3,subtitle:`${(k/r.length||0).toFixed(1)} por cliente`}),e.jsx(p,{title:"Receita Total",value:f(N),icon:X,color:"bg-pink-500",delay:.4,subtitle:`Ticket médio: ${f(R)}`})]}),e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},className:"relative",children:[e.jsx(U,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),e.jsx(M,{placeholder:"Buscar por nome, email ou CPF...",value:i,onChange:a=>$(a.target.value),className:"pl-12 h-12 border-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl shadow-lg text-base"})]}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:e.jsxs(z,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(B,{children:e.jsx(L,{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Lista de Clientes"})}),e.jsx(I,{children:u?e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(a=>e.jsx(W,{className:"h-16 w-full"},a))}):h.length===0?e.jsxs(n.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 opacity-20 blur-3xl rounded-full"}),e.jsx(A,{className:"relative h-20 w-20 text-gray-400 dark:text-gray-600"})]}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Nenhum cliente encontrado"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md",children:i?"Tente ajustar os filtros de busca":"Sincronize com a Shopify para importar seus clientes"}),!i&&e.jsxs(S,{onClick:v,disabled:g,size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[e.jsx(T,{className:`mr-2 h-5 w-5 ${g?"animate-spin":""}`}),"Sincronizar Clientes"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(D,{children:[e.jsx(H,{children:e.jsxs(q,{className:"hover:bg-transparent border-gray-200 dark:border-gray-700",children:[e.jsx(x,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Cliente"}),e.jsx(x,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Contato"}),e.jsx(x,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Pedidos"}),e.jsx(x,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Total Gasto"}),e.jsx(x,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Última Compra"}),e.jsx(x,{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Status"})]})}),e.jsx(G,{children:h.map((a,s)=>e.jsxs(n.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:s*.05},className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors border-gray-200 dark:border-gray-700",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-semibold",children:a.name.charAt(0).toUpperCase()}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:a.name})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(Y,{className:"h-3 w-3 text-gray-400"}),a.email]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(Z,{className:"h-3 w-3 text-gray-400"}),a.phone]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:a.totalOrders})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:f(a.totalSpent)})]})}),e.jsx(m,{children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.lastOrderAt?ee(new Date(a.lastOrderAt),"dd/MM/yyyy",{locale:ae}):"-"})}),e.jsx(m,{children:e.jsx(V,{variant:a.status==="ACTIVE"?"default":"secondary",className:a.status==="ACTIVE"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",children:a.status==="ACTIVE"?"Ativo":"Bloqueado"})})]},a.id))})]})})})]})})]})};export{pe as default};

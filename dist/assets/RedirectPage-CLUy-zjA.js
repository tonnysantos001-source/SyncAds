import{s as v,r as b,b as ee,u as re,j as e,B as S,d as P,e as k,f as L,h as q,g as te,a6 as ae,l as B,I as D,a5 as se}from"./index-Dp8T7_yL.js";import{L as R}from"./label-u6bLtzmi.js";import{T as ie,a as ne,b as G,c as E,d as oe,e as C}from"./table-CSq-PhDo.js";import{D as ce,b as le,c as de,d as ge,e as ue,f as he}from"./dialog-urgc1yCn.js";import{S as z,a as $,b as X,c as Y,d as N}from"./select-CoY7G1n6.js";import{S as H}from"./switch-DXP-MR8x.js";import{T as J}from"./textarea-D1iWbjZL.js";import{A as me,a as xe}from"./alert-Dh38RLY5.js";import{S as M}from"./skeleton-BvOxRLJm.js";import{P as K}from"./plus-Cx-HgXAG.js";import{T as pe}from"./target-B5pc8WW8.js";import{M as ve}from"./mouse-pointer-BvzX-Z8o.js";import{T as je}from"./trending-up-B2BG66ni.js";import{C as fe}from"./chart-column-BgIKAIlQ.js";import{E as Q}from"./external-link-Dg5az6AV.js";import{S as we}from"./square-pen-wM8AsNNA.js";import{T as Re}from"./trash-2-CwzJIqvX.js";import{C as F}from"./circle-alert-0dJjGY3O.js";import"./x-DFGXYiBU.js";import"./index-CmL9QpFf.js";import"./chevron-up-BV1zSlM2.js";const u={async createRule(s){try{const{data:r,error:t}=await v.from("RedirectRule").insert({...s,currentRedirects:0,conversions:0}).select().single();if(t)throw t;return r}catch(r){throw console.error("Error creating redirect rule:",r),r}},async updateRule(s,r){try{const{data:t,error:n}=await v.from("RedirectRule").update({...r,updatedAt:new Date().toISOString()}).eq("id",s).select().single();if(n)throw n;return t}catch(t){throw console.error("Error updating redirect rule:",t),t}},async deleteRule(s){try{const{error:r}=await v.from("RedirectRule").delete().eq("id",s);if(r)throw r}catch(r){throw console.error("Error deleting redirect rule:",r),r}},async listRules(s,r){try{let t=v.from("RedirectRule").select("*").eq("userId",s).order("priority",{ascending:!1}).order("createdAt",{ascending:!1});r!=null&&r.status&&(t=t.eq("status",r.status)),r!=null&&r.trigger&&(t=t.eq("trigger",r.trigger)),(r==null?void 0:r.active)!==void 0&&(r.active?t=t.eq("status","ACTIVE"):t=t.neq("status","ACTIVE"));const{data:n,error:c}=await t;if(c)throw c;return n}catch(t){throw console.error("Error listing redirect rules:",t),t}},async getRuleById(s){try{const{data:r,error:t}=await v.from("RedirectRule").select("*").eq("id",s).single();if(t)throw t;return r}catch(r){throw console.error("Error getting redirect rule:",r),r}},async toggleRule(s,r){try{const t=r?"ACTIVE":"INACTIVE";return await u.updateRule(s,{status:t})}catch(t){throw console.error("Error toggling redirect rule:",t),t}},async updatePriority(s,r){try{return await u.updateRule(s,{priority:r})}catch(t){throw console.error("Error updating redirect priority:",t),t}},async getApplicableRules(s,r){try{const t=new Date().toISOString();let n=v.from("RedirectRule").select("*").eq("userId",s).eq("status","ACTIVE").or(`validFrom.is.null,validFrom.lte.${t}`).or(`validUntil.is.null,validUntil.gte.${t}`).order("priority",{ascending:!1});r.trigger&&(n=n.eq("trigger",r.trigger));const{data:c,error:d}=await n;if(d)throw d;let l=c;return r.page&&(l=l.filter(o=>o.applicablePages&&o.applicablePages.length>0?o.applicablePages.includes(r.page):o.excludedPages&&o.excludedPages.length>0?!o.excludedPages.includes(r.page):!0)),l=l.filter(o=>o.conditions?!(r.cartValue!==void 0&&(o.conditions.minCartValue&&r.cartValue<o.conditions.minCartValue||o.conditions.maxCartValue&&r.cartValue>o.conditions.maxCartValue)||o.conditions.productIds&&o.conditions.productIds.length>0&&r.productIds&&!r.productIds.some(y=>o.conditions.productIds.includes(y))||o.conditions.utmSource&&r.utmSource!==o.conditions.utmSource||o.conditions.deviceType&&r.deviceType!==o.conditions.deviceType||o.conditions.newVisitors!==void 0&&r.isNewVisitor!==void 0&&o.conditions.newVisitors&&!r.isNewVisitor||o.conditions.returningVisitors!==void 0&&r.isNewVisitor!==void 0&&o.conditions.returningVisitors&&r.isNewVisitor):!0),l=l.filter(o=>o.maxRedirects?o.currentRedirects<o.maxRedirects:!0),l}catch(t){throw console.error("Error getting applicable rules:",t),t}},async duplicateRule(s){try{const r=await u.getRuleById(s),{id:t,createdAt:n,updatedAt:c,...d}=r;return await u.createRule({...d,name:`${r.name} (Cópia)`,status:"INACTIVE",currentRedirects:0,conversions:0})}catch(r){throw console.error("Error duplicating redirect rule:",r),r}},async logRedirect(s){try{const{data:r,error:t}=await v.from("RedirectLog").insert(s).select().single();if(t)throw t;const n=await u.getRuleById(s.ruleId);return await u.updateRule(s.ruleId,{currentRedirects:n.currentRedirects+1}),r}catch(r){throw console.error("Error logging redirect:",r),r}},async markAsConverted(s,r,t){try{const n=await u.getLogById(s),{data:c,error:d}=await v.from("RedirectLog").update({converted:!0,convertedAt:new Date().toISOString(),orderId:r,conversionValue:t}).eq("id",s).select().single();if(d)throw d;const l=await u.getRuleById(n.ruleId);return await u.updateRule(n.ruleId,{conversions:l.conversions+1}),c}catch(n){throw console.error("Error marking redirect as converted:",n),n}},async getLogById(s){try{const{data:r,error:t}=await v.from("RedirectLog").select("*").eq("id",s).single();if(t)throw t;return r}catch(r){throw console.error("Error getting redirect log:",r),r}},async getLogsBySession(s){try{const{data:r,error:t}=await v.from("RedirectLog").select("*").eq("sessionId",s).order("createdAt",{ascending:!1});if(t)throw t;return r}catch(r){throw console.error("Error getting redirect logs by session:",r),r}},async getLogs(s,r){try{let t=v.from("RedirectLog").select("*").eq("userId",s).order("createdAt",{ascending:!1});r!=null&&r.ruleId&&(t=t.eq("ruleId",r.ruleId)),(r==null?void 0:r.converted)!==void 0&&(t=t.eq("converted",r.converted)),r!=null&&r.trigger&&(t=t.eq("trigger",r.trigger)),r!=null&&r.dateFrom&&(t=t.gte("createdAt",r.dateFrom)),r!=null&&r.dateTo&&(t=t.lte("createdAt",r.dateTo)),r!=null&&r.limit&&(t=t.limit(r.limit));const{data:n,error:c}=await t;if(c)throw c;return n}catch(t){throw console.error("Error getting redirect logs:",t),t}},async getAnalytics(s,r){try{const t=await u.listRules(s);let n=v.from("RedirectLog").select("*").eq("userId",s);r&&(n=n.gte("createdAt",r.from).lte("createdAt",r.to));const{data:c,error:d}=await n;if(d)throw d;const l=c,o=t.length,f=t.filter(g=>g.status==="ACTIVE").length,y=l.length,i=l.filter(g=>g.converted).length,x=y>0?i/y*100:0,w=l.filter(g=>g.converted&&g.conversionValue).reduce((g,m)=>g+(m.conversionValue||0),0),j=i>0?w/i:0,T=["POST_PURCHASE","ABANDONED_CART","EXIT_INTENT","TIME_DELAY","SCROLL_PERCENTAGE","IDLE","FIRST_VISIT","RETURNING_VISITOR"],U={};T.forEach(g=>{const m=l.filter(I=>I.trigger===g);if(m.length>0){const I=m.filter(h=>h.converted).length,A=m.filter(h=>h.converted&&h.conversionValue).reduce((h,V)=>h+(V.conversionValue||0),0);U[g]={redirects:m.length,conversions:I,conversionRate:I/m.length*100,revenue:A}}});const O=t.map(g=>{const m=l.filter(h=>h.ruleId===g.id),I=m.filter(h=>h.converted).length,A=m.filter(h=>h.converted&&h.conversionValue).reduce((h,V)=>h+(V.conversionValue||0),0);return{ruleId:g.id,ruleName:g.name,redirects:m.length,conversions:I,conversionRate:m.length>0?I/m.length*100:0,revenue:A}}).filter(g=>g.redirects>0).sort((g,m)=>m.revenue-g.revenue).slice(0,10);return{totalRules:o,activeRules:f,totalRedirects:y,totalConversions:i,conversionRate:x,totalRevenue:w,averageOrderValue:j,byTrigger:U,topRules:O}}catch(t){throw console.error("Error getting redirect analytics:",t),t}},async getConversionRate(s){try{const{data:r,error:t}=await v.from("RedirectLog").select("converted").eq("ruleId",s);if(t)throw t;const n=r,c=n.length,d=n.filter(l=>l.converted).length;return c>0?d/c*100:0}catch(r){throw console.error("Error getting conversion rate:",r),r}},async getRulePerformance(s){try{const r=await u.getRuleById(s),t=await u.getLogs(r.userId,{ruleId:s}),n=t.length,c=t.filter(f=>f.converted).length,d=n>0?c/n*100:0,l=t.filter(f=>f.converted&&f.conversionValue).reduce((f,y)=>f+(y.conversionValue||0),0),o=c>0?l/c:0;return{rule:r,redirects:n,conversions:c,conversionRate:d,revenue:l,averageOrderValue:o}}catch(r){throw console.error("Error getting rule performance:",r),r}},async resetRuleStats(s){try{return await u.updateRule(s,{currentRedirects:0,conversions:0})}catch(r){throw console.error("Error resetting rule stats:",r),r}},async processExpiredRules(s){try{const r=new Date().toISOString(),{data:t,error:n}=await v.from("RedirectRule").select("id").eq("userId",s).eq("status","ACTIVE").not("validUntil","is",null).lt("validUntil",r);if(n)throw n;const c=t,d=c.map(l=>u.updateRule(l.id,{status:"EXPIRED"}));return await Promise.all(d),c.length}catch(r){throw console.error("Error processing expired rules:",r),r}},async processScheduledRules(s){try{const r=new Date().toISOString(),{data:t,error:n}=await v.from("RedirectRule").select("id").eq("userId",s).eq("status","SCHEDULED").not("validFrom","is",null).lte("validFrom",r);if(n)throw n;const c=t,d=c.map(l=>u.updateRule(l.id,{status:"ACTIVE"}));return await Promise.all(d),c.length}catch(r){throw console.error("Error processing scheduled rules:",r),r}}},Me=()=>{const[s,r]=b.useState([]),[t,n]=b.useState(null),[c,d]=b.useState(!0),[l,o]=b.useState(!1),[f,y]=b.useState(null),[i,x]=b.useState({name:"",description:"",trigger:"POST_PURCHASE",destinationUrl:"",status:"ACTIVE",priority:1,openInNewTab:!0,showConfirmation:!1}),{toast:w}=ee(),j=re(a=>a.user);b.useEffect(()=>{j!=null&&j.id&&T()},[j==null?void 0:j.id]);const T=async()=>{try{d(!0);const[a,p]=await Promise.all([u.listRules(j.id),u.getAnalytics(j.id)]);r(a),n(p)}catch(a){console.error("Erro ao carregar dados:",a),w({title:"Erro ao carregar dados",description:a.message,variant:"destructive"})}finally{d(!1)}},U=async()=>{try{if(!(j!=null&&j.id))return;if(!i.name||!i.destinationUrl){w({title:"Campos obrigatórios",description:"Preencha nome e URL de destino",variant:"destructive"});return}const a={...i,userId:j.id};f?(await u.updateRule(f.id,i),w({title:"Regra atualizada com sucesso!"})):(await u.createRule(a),w({title:"Regra criada com sucesso!"})),o(!1),y(null),I(),T()}catch(a){console.error("Erro ao salvar:",a),w({title:"Erro ao salvar",description:a.message,variant:"destructive"})}},O=a=>{y(a),x(a),o(!0)},g=async a=>{if(confirm("Deseja realmente excluir esta regra?"))try{await u.deleteRule(a),w({title:"Regra excluída com sucesso!"}),T()}catch(p){console.error("Erro ao excluir:",p),w({title:"Erro ao excluir",description:p.message,variant:"destructive"})}},m=async(a,p)=>{try{await u.toggleRule(a,p),w({title:p?"Regra ativada!":"Regra desativada!"}),T()}catch(_){console.error("Erro ao alternar status:",_),w({title:"Erro ao alternar status",description:_.message,variant:"destructive"})}},I=()=>{x({name:"",description:"",trigger:"POST_PURCHASE",destinationUrl:"",status:"ACTIVE",priority:1,openInNewTab:!0,showConfirmation:!1})},A=a=>`${a.toFixed(1)}%`,h=a=>({POST_PURCHASE:"Pós-Compra",ABANDONED_CART:"Carrinho Abandonado",EXIT_INTENT:"Intenção de Saída",TIME_DELAY:"Tempo na Página",SCROLL_PERCENTAGE:"Rolagem de Página",IDLE:"Inatividade",FIRST_VISIT:"Primeira Visita",RETURNING_VISITOR:"Visitante Retornante"})[a],V=a=>{const p={ACTIVE:{label:"Ativo",variant:"default",icon:se},INACTIVE:{label:"Inativo",variant:"secondary",icon:F},EXPIRED:{label:"Expirado",variant:"destructive",icon:F},SCHEDULED:{label:"Agendado",variant:"secondary",icon:F}};return p[a]||p.INACTIVE};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/30 dark:from-gray-950 dark:via-blue-950/20 dark:to-purple-950/20 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent",children:"Redirecionamentos"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-medium",children:"Configure redirecionamentos inteligentes para maximizar conversões"})]}),e.jsxs(S,{onClick:()=>o(!0),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Nova Regra"]})]}),t&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-4",children:[e.jsxs(P,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Regras Ativas"}),e.jsx(pe,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.total}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["de ",t.totalRules," regras"]})]})]}),e.jsxs(P,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Total Redirecionamentos"}),e.jsx(ve,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.active}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Regras ativas"})]})]}),e.jsxs(P,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Conversões"}),e.jsx(je,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(q,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.totalConversions}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Taxa: ",A(t.conversionRate)]})]})]}),e.jsxs(P,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Receita Gerada"}),e.jsx(fe,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",t.totalRevenue.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Ticket: R$ ",t.averageOrderValue.toFixed(2)]})]})]})]}),e.jsxs(P,{className:"border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsxs(k,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(L,{children:"Regras de Redirecionamento"}),e.jsxs(te,{children:[s.length," regra(s) cadastrada(s)"]})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Atualizar"]})]}),e.jsx(q,{children:c?e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{className:"h-12 w-full"}),e.jsx(M,{className:"h-12 w-full"}),e.jsx(M,{className:"h-12 w-full"})]}):s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Q,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhuma regra cadastrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Crie sua primeira regra de redirecionamento"}),e.jsxs(S,{onClick:()=>o(!0),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Criar Regra"]})]}):e.jsxs(ie,{children:[e.jsx(ne,{children:e.jsxs(G,{children:[e.jsx(E,{children:"Nome"}),e.jsx(E,{children:"Trigger"}),e.jsx(E,{children:"URL Destino"}),e.jsx(E,{children:"Status"}),e.jsx(E,{className:"text-right",children:"Redirecionamentos"}),e.jsx(E,{className:"text-right",children:"Conversões"}),e.jsx(E,{className:"text-right",children:"Taxa"}),e.jsx(E,{className:"text-right",children:"Ações"})]})}),e.jsx(oe,{children:s.map(a=>{const p=V(a.status),_=p.icon,W=a.currentRedirects>0?a.conversions/a.currentRedirects*100:0;return e.jsxs(G,{children:[e.jsx(C,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.name}),a.description&&e.jsx("div",{className:"text-sm text-muted-foreground",children:a.description})]})}),e.jsx(C,{children:e.jsx(B,{variant:"outline",children:h(a.trigger)})}),e.jsx(C,{children:e.jsxs("a",{href:a.destinationUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[a.destinationUrl.substring(0,40),"...",e.jsx(Q,{className:"h-3 w-3"})]})}),e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:p.variant,className:"gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),p.label]}),e.jsx(H,{checked:a.status==="ACTIVE",onCheckedChange:Z=>m(a.id,Z)})]})}),e.jsx(C,{className:"text-right",children:a.currentRedirects}),e.jsx(C,{className:"text-right",children:e.jsx("span",{className:"font-medium text-green-600",children:a.conversions})}),e.jsx(C,{className:"text-right",children:e.jsx(B,{variant:"outline",children:A(W)})}),e.jsx(C,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>O(a),children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>g(a.id),children:e.jsx(Re,{className:"h-4 w-4 text-red-600"})})]})})]},a.id)})})]})})]}),e.jsx(ce,{open:l,onOpenChange:o,children:e.jsxs(le,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(de,{children:[e.jsx(ge,{children:f?"Editar Regra":"Nova Regra de Redirecionamento"}),e.jsx(ue,{children:"Configure quando e para onde redirecionar seus usuários"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"name",children:"Nome da Regra *"}),e.jsx(D,{id:"name",value:i.name,onChange:a=>x({...i,name:a.target.value}),placeholder:"Ex: Upsell pós-compra"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"description",children:"Descrição"}),e.jsx(J,{id:"description",value:i.description||"",onChange:a=>x({...i,description:a.target.value}),placeholder:"Descrição opcional",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"trigger",children:"Trigger *"}),e.jsxs(z,{value:i.trigger,onValueChange:a=>x({...i,trigger:a}),children:[e.jsx($,{children:e.jsx(X,{})}),e.jsxs(Y,{children:[e.jsx(N,{value:"POST_PURCHASE",children:"Pós-Compra"}),e.jsx(N,{value:"ABANDONED_CART",children:"Carrinho Abandonado"}),e.jsx(N,{value:"EXIT_INTENT",children:"Intenção de Saída"}),e.jsx(N,{value:"TIME_DELAY",children:"Tempo na Página"}),e.jsx(N,{value:"SCROLL_PERCENTAGE",children:"Rolagem de Página"}),e.jsx(N,{value:"IDLE",children:"Inatividade"}),e.jsx(N,{value:"FIRST_VISIT",children:"Primeira Visita"}),e.jsx(N,{value:"RETURNING_VISITOR",children:"Visitante Retornante"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"priority",children:"Prioridade"}),e.jsx(D,{id:"priority",type:"number",value:i.priority,onChange:a=>x({...i,priority:parseInt(a.target.value)}),placeholder:"1"})]})]}),i.trigger==="TIME_DELAY"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"triggerDelay",children:"Delay (segundos)"}),e.jsx(D,{id:"triggerDelay",type:"number",value:i.triggerDelay||"",onChange:a=>x({...i,triggerDelay:parseInt(a.target.value)}),placeholder:"30"})]}),i.trigger==="SCROLL_PERCENTAGE"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"triggerScrollPercentage",children:"Porcentagem de Rolagem (%)"}),e.jsx(D,{id:"triggerScrollPercentage",type:"number",min:"0",max:"100",value:i.triggerScrollPercentage||"",onChange:a=>x({...i,triggerScrollPercentage:parseInt(a.target.value)}),placeholder:"75"})]}),i.trigger==="IDLE"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"triggerIdleTime",children:"Tempo de Inatividade (segundos)"}),e.jsx(D,{id:"triggerIdleTime",type:"number",value:i.triggerIdleTime||"",onChange:a=>x({...i,triggerIdleTime:parseInt(a.target.value)}),placeholder:"60"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"destinationUrl",children:"URL de Destino *"}),e.jsx(D,{id:"destinationUrl",type:"url",value:i.destinationUrl,onChange:a=>x({...i,destinationUrl:a.target.value}),placeholder:"https://example.com/oferta"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"status",children:"Status"}),e.jsxs(z,{value:i.status,onValueChange:a=>x({...i,status:a}),children:[e.jsx($,{children:e.jsx(X,{})}),e.jsxs(Y,{children:[e.jsx(N,{value:"ACTIVE",children:"Ativo"}),e.jsx(N,{value:"INACTIVE",children:"Inativo"}),e.jsx(N,{value:"SCHEDULED",children:"Agendado"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:"openInNewTab",checked:i.openInNewTab,onCheckedChange:a=>x({...i,openInNewTab:a})}),e.jsx(R,{htmlFor:"openInNewTab",className:"cursor-pointer",children:"Abrir em nova aba"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:"showConfirmation",checked:i.showConfirmation,onCheckedChange:a=>x({...i,showConfirmation:a})}),e.jsx(R,{htmlFor:"showConfirmation",className:"cursor-pointer",children:"Mostrar confirmação antes de redirecionar"})]})]}),i.showConfirmation&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"confirmationMessage",children:"Mensagem de Confirmação"}),e.jsx(J,{id:"confirmationMessage",value:i.confirmationMessage||"",onChange:a=>x({...i,confirmationMessage:a.target.value}),placeholder:"Deseja ser redirecionado para nossa oferta especial?",rows:2})]}),e.jsxs(me,{children:[e.jsx(F,{className:"h-4 w-4"}),e.jsxs(xe,{children:["Esta regra será acionada quando o trigger"," ",e.jsx("strong",{children:h(i.trigger||"POST_PURCHASE")})," ","for detectado.",i.openInNewTab?" O redirecionamento abrirá em nova aba.":" O redirecionamento será na mesma janela."]})]})]}),e.jsxs(he,{children:[e.jsx(S,{variant:"outline",onClick:()=>{o(!1),y(null),I()},children:"Cancelar"}),e.jsx(S,{onClick:U,children:"Salvar"})]})]})})]})};export{Me as default};
